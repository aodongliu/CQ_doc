\hypertarget{dft_8hpp_source}{}\doxysection{dft.\+hpp}
\label{dft_8hpp_source}\index{include/dft.hpp@{include/dft.hpp}}
\mbox{\hyperlink{dft_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* }}
\DoxyCodeLine{2 \textcolor{comment}{ *  This file is part of the Chronus Quantum (ChronusQ) software package}}
\DoxyCodeLine{3 \textcolor{comment}{ *  }}
\DoxyCodeLine{4 \textcolor{comment}{ *  Copyright (C) 2014-\/2022 Li Research Group (University of Washington)}}
\DoxyCodeLine{5 \textcolor{comment}{ *  }}
\DoxyCodeLine{6 \textcolor{comment}{ *  This program is free software; you can redistribute it and/or modify}}
\DoxyCodeLine{7 \textcolor{comment}{ *  it under the terms of the GNU General Public License as published by}}
\DoxyCodeLine{8 \textcolor{comment}{ *  the Free Software Foundation; either version 2 of the License, or}}
\DoxyCodeLine{9 \textcolor{comment}{ *  (at your option) any later version.}}
\DoxyCodeLine{10 \textcolor{comment}{ *  }}
\DoxyCodeLine{11 \textcolor{comment}{ *  This program is distributed in the hope that it will be useful,}}
\DoxyCodeLine{12 \textcolor{comment}{ *  but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{13 \textcolor{comment}{ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{14 \textcolor{comment}{ *  GNU General Public License for more details.}}
\DoxyCodeLine{15 \textcolor{comment}{ *  }}
\DoxyCodeLine{16 \textcolor{comment}{ *  You should have received a copy of the GNU General Public License along}}
\DoxyCodeLine{17 \textcolor{comment}{ *  with this program; if not, write to the Free Software Foundation, Inc.,}}
\DoxyCodeLine{18 \textcolor{comment}{ *  51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301 USA.}}
\DoxyCodeLine{19 \textcolor{comment}{ *  }}
\DoxyCodeLine{20 \textcolor{comment}{ *  Contact the Developers:}}
\DoxyCodeLine{21 \textcolor{comment}{ *    E-\/Mail: xsli@uw.edu}}
\DoxyCodeLine{22 \textcolor{comment}{ *  }}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{chronusq__sys_8hpp}{chronusq\_sys.hpp}}>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <xc.h>}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceChronusQ}{ChronusQ}} \{}
\DoxyCodeLine{30 }
\DoxyCodeLine{34   \textcolor{keyword}{class }\mbox{\hyperlink{classChronusQ_1_1DFTFunctional}{DFTFunctional}} \{}
\DoxyCodeLine{35     \textcolor{comment}{// (polarized) rho[2*np], vrho[2*np], sigma[3*np], vsigma[3*np], v2rho2[3*np], v2rhosigma[6*np], v2sigma2[6*np]}}
\DoxyCodeLine{36     \textcolor{comment}{//  in rho [0]    = UP   rho }}
\DoxyCodeLine{37     \textcolor{comment}{//  in rho [1]    = DOWN rho}}
\DoxyCodeLine{38     \textcolor{comment}{//  in sigma[0]   = UP   -\/ UP   Del N dot Del N }}
\DoxyCodeLine{39     \textcolor{comment}{//  in sigma[1]   = UP   -\/ DOWN Del N dot Del N }}
\DoxyCodeLine{40     \textcolor{comment}{//  in sigma[2]   = DOWN -\/ DOWN Del N dot Del N }}
\DoxyCodeLine{41     \textcolor{comment}{//  out eps       = the energy per unit particle}}
\DoxyCodeLine{42     \textcolor{comment}{//  out vxc/vrho[0]   = UP   first part der of the energy per unit volume in terms of the dens }}
\DoxyCodeLine{43     \textcolor{comment}{//  out vxc/vrho[1]   = DOWN first part der of the energy per unit volume in terms of the dens N}}
\DoxyCodeLine{44     \textcolor{comment}{//  out vsigma[0]  = UP   UP    first part der of the energy per unit volume in terms of sigma }}
\DoxyCodeLine{45     \textcolor{comment}{//  out vsigma[1]  = UP   DOWN  first part der of the energy per unit volume in terms of sigma }}
\DoxyCodeLine{46     \textcolor{comment}{//  out vsigma[2]  = DOWN DOWN  first part der of the energy per unit volume in terms of sigma }}
\DoxyCodeLine{47     \textcolor{comment}{//  out fxc/v2rho2[0]  = UP UP      second part der of the energy per unit volume in terms of the dens }}
\DoxyCodeLine{48     \textcolor{comment}{//  out fxc/v2rho2[1]  = UP UP      second part der of the energy per unit volume in terms of the dens }}
\DoxyCodeLine{49     \textcolor{comment}{//  out fxc/v2rho2[2]  = UP UP      second part der of the energy per unit volume in terms of the dens }}
\DoxyCodeLine{50     \textcolor{comment}{//  out v2rhosigma[0]  = UP   -\/ UP UP     second part der of the energy per unit volume in terms of the dens and sigma }}
\DoxyCodeLine{51     \textcolor{comment}{//  out v2rhosigma[1]  = UP   -\/ UP DOWN   second part der of the energy per unit volume in terms of the dens and sigma }}
\DoxyCodeLine{52     \textcolor{comment}{//  out v2rhosigma[2]  = UP   -\/ DOWN DOWN second part der of the energy per unit volume in terms of the dens and sigma }}
\DoxyCodeLine{53     \textcolor{comment}{//  out v2rhosigma[3]  = DOWN -\/ UP UP     second part der of the energy per unit volume in terms of the dens and sigma }}
\DoxyCodeLine{54     \textcolor{comment}{//  out v2rhosigma[4]  = DOWN -\/ UP DOWN   second part der of the energy per unit volume in terms of the dens and sigma }}
\DoxyCodeLine{55     \textcolor{comment}{//  out v2rhosigma[5]  = DOWN -\/ DOWN DOWN second part der of the energy per unit volume in terms of the dens and sigma }}
\DoxyCodeLine{56     \textcolor{comment}{//  out v2sigma2[0]    = UP UP     -\/ UP UP     second part der of the energy per unit volume in terms of sigma sigma}}
\DoxyCodeLine{57     \textcolor{comment}{//  out v2sigma2[1]    = UP UP     -\/ UP DOWN   second part der of the energy per unit volume in terms of sigma sigma}}
\DoxyCodeLine{58     \textcolor{comment}{//  out v2sigma2[2]    = UP UP     -\/ DOWN DOWN second part der of the energy per unit volume in terms of sigma sigma}}
\DoxyCodeLine{59     \textcolor{comment}{//  out v2sigma2[3]    = UP DONW   -\/ UP DONW   second part der of the energy per unit volume in terms of sigma sigma}}
\DoxyCodeLine{60     \textcolor{comment}{//  out v2sigma2[4]    = UP DONW   -\/ DOWN DOWN second part der of the energy per unit volume in terms of sigma sigma}}
\DoxyCodeLine{61     \textcolor{comment}{//  out v2sigma2[5]    = DOWN DOWN -\/ DOWN DOWN second part der of the energy per unit volume in terms of sigma sigma}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63   \textcolor{keyword}{protected}:}
\DoxyCodeLine{64     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a71093cbd266475d7664a2ebc1961a36a}{isGGA\_}};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a0375591d2353c1ae73360e1156db11b0}{isEPC\_}} = \textcolor{keyword}{false};}
\DoxyCodeLine{67     }
\DoxyCodeLine{68 }
\DoxyCodeLine{69     xc\_func\_type \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_ac716332b42796ad9c910d537718028da}{functional\_}}; }
\DoxyCodeLine{70 }
\DoxyCodeLine{71   \textcolor{keyword}{public}:}
\DoxyCodeLine{72 }
\DoxyCodeLine{73     \textcolor{keywordtype}{double} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a8c88e39af5a6638842bcdd7938256369}{xHFX}}; }
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a32d9d44de44f5dd3b9b00629d8381169}{DFTFunctional}}(\textcolor{keywordtype}{int} FUNC\_IDENT) \{ }
\DoxyCodeLine{76       xc\_func\_init(\&\mbox{\hyperlink{classChronusQ_1_1DFTFunctional_ac716332b42796ad9c910d537718028da}{functional\_}},FUNC\_IDENT,XC\_POLARIZED);}
\DoxyCodeLine{77       \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a8c88e39af5a6638842bcdd7938256369}{xHFX}} = xc\_hyb\_exx\_coef(\&\mbox{\hyperlink{classChronusQ_1_1DFTFunctional_ac716332b42796ad9c910d537718028da}{functional\_}});}
\DoxyCodeLine{78       \textcolor{comment}{//std::cerr << "{}HYB "{} << xHFX << std::endl;}}
\DoxyCodeLine{79     \};}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \textcolor{comment}{// Constructor specifically for EPC functional}}
\DoxyCodeLine{82     \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_adfc60e417e22237b5cf0dfe91068a6dc}{DFTFunctional}}(std::string epcName) \{ \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a8c88e39af5a6638842bcdd7938256369}{xHFX}} = 1.; \};}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{comment}{// TODO: Implement COPY / MOVE...}}
\DoxyCodeLine{85       }
\DoxyCodeLine{86     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_ae59bd6e69292df153d17718f61b9e359}{evalEXC\_VXC}}(\textcolor{keywordtype}{size\_t} N, \textcolor{keywordtype}{double} *rho, \textcolor{keywordtype}{double} *eps, \textcolor{keywordtype}{double} *vxc) \{}
\DoxyCodeLine{87       assert(not \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a71093cbd266475d7664a2ebc1961a36a}{isGGA\_}});}
\DoxyCodeLine{88       xc\_lda\_exc\_vxc(\&this-\/>functional\_,N,rho,eps,vxc);}
\DoxyCodeLine{89     \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a5c9da9382c5f62afca0763f5c56fd954}{evalEXC\_VXC}}(\textcolor{keywordtype}{size\_t} N, \textcolor{keywordtype}{double} *rho, \textcolor{keywordtype}{double} *sigma, \textcolor{keywordtype}{double} *eps, \textcolor{keywordtype}{double} *vrho, }
\DoxyCodeLine{92       \textcolor{keywordtype}{double} * vsigma) \{}
\DoxyCodeLine{93 }
\DoxyCodeLine{94       assert(\mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a71093cbd266475d7664a2ebc1961a36a}{isGGA\_}});}
\DoxyCodeLine{95       xc\_gga\_exc\_vxc(\&this-\/>functional\_,N,rho,sigma,eps,vrho,vsigma);}
\DoxyCodeLine{96 }
\DoxyCodeLine{97     \};}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a8a5f9ec9e81ddfb09cd4c3cbd1601bc8}{evalEXC\_VXC}}(\textcolor{keywordtype}{size\_t} N, \textcolor{keywordtype}{double} *rho, \textcolor{keywordtype}{double} *aux\_rho, \textcolor{keywordtype}{double} *eps, }
\DoxyCodeLine{100                              \textcolor{keywordtype}{double} *vxc, \textcolor{keywordtype}{bool} electron) \{\}; }
\DoxyCodeLine{101 }
\DoxyCodeLine{102     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_aa36a1a6b20a1a080c1a4b328a1fe1276}{evalEXC\_VXC}}(\textcolor{keywordtype}{size\_t} N, \textcolor{keywordtype}{double} *rho, \textcolor{keywordtype}{double} *aux\_rho, \textcolor{keywordtype}{double} *sigma,}
\DoxyCodeLine{103                              \textcolor{keywordtype}{double} *aux\_sigma, \textcolor{keywordtype}{double} *cross\_sigma, \textcolor{keywordtype}{double} *eps,}
\DoxyCodeLine{104                              \textcolor{keywordtype}{double} *vrho, \textcolor{keywordtype}{double} *vsigma, \textcolor{keywordtype}{double} *vcsigma, }
\DoxyCodeLine{105                              \textcolor{keywordtype}{bool} electron) \{\};}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_aae25e78ca7d89567ded7b1f8ee3e7d16}{evalEXC\_VXC\_FXC}}(\textcolor{keywordtype}{size\_t} N, \textcolor{keywordtype}{double} *rho, \textcolor{keywordtype}{double} *eps, \textcolor{keywordtype}{double} *vxc, \textcolor{keywordtype}{double} *fxc) \{}
\DoxyCodeLine{109 }
\DoxyCodeLine{110       \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_ae59bd6e69292df153d17718f61b9e359}{evalEXC\_VXC}}(N,rho,eps,vxc);}
\DoxyCodeLine{111       xc\_lda\_fxc(\&this-\/>functional\_,N,rho,fxc);}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a846d0b256cee399a876a7e941258c8cb}{evalEXC\_VXC\_FXC}}(\textcolor{keywordtype}{size\_t} N, \textcolor{keywordtype}{double} *rho, \textcolor{keywordtype}{double} *sigma, \textcolor{keywordtype}{double} *eps, \textcolor{keywordtype}{double} *vrho, }
\DoxyCodeLine{116       \textcolor{keywordtype}{double} * vsigma, \textcolor{keywordtype}{double} *v2rho2, \textcolor{keywordtype}{double} *v2rhosigma, \textcolor{keywordtype}{double} *v2sigma2) \{}
\DoxyCodeLine{117 }
\DoxyCodeLine{118       \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_ae59bd6e69292df153d17718f61b9e359}{evalEXC\_VXC}}(N,rho,sigma,eps,vrho,vsigma);}
\DoxyCodeLine{119       xc\_gga\_fxc(\&this-\/>functional\_,N,rho,sigma,v2rho2,v2rhosigma,v2sigma2);}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \};}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 }
\DoxyCodeLine{124 \textcolor{comment}{/*}}
\DoxyCodeLine{125 \textcolor{comment}{    virtual void evalFXC(size\_t N, double *rho, double *fxc) = 0;}}
\DoxyCodeLine{126 \textcolor{comment}{    virtual void evalFXC(size\_t N, double *rho, double *sigma, double *v2rho2, double *v2rhosigma, double *v2sigma2) = 0;}}
\DoxyCodeLine{127 \textcolor{comment}{*/}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_ab9b29ff6722537a3f25dcd569c054b99}{isGGA}}() \{ \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a71093cbd266475d7664a2ebc1961a36a}{isGGA\_}}; \}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a61806c407990b6b69db07fec1e4e0157}{isEPC}}() \{ \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a0375591d2353c1ae73360e1156db11b0}{isEPC\_}}; \}}
\DoxyCodeLine{132 }
\DoxyCodeLine{133   \}; \textcolor{comment}{// class DFTFunctional}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135 }
\DoxyCodeLine{136 }
\DoxyCodeLine{140   \textcolor{keyword}{class }\mbox{\hyperlink{classChronusQ_1_1LDA}{LDA}} : \textcolor{keyword}{public} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional}{DFTFunctional}} \{}
\DoxyCodeLine{141 }
\DoxyCodeLine{142   \textcolor{keyword}{public}:}
\DoxyCodeLine{143     \mbox{\hyperlink{classChronusQ_1_1LDA_a35d4686def615a536b961525529968f9}{LDA}}(\textcolor{keywordtype}{int} FUNC\_IDENT) : \mbox{\hyperlink{classChronusQ_1_1DFTFunctional}{DFTFunctional}}(FUNC\_IDENT) \{ this-\/>\mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a71093cbd266475d7664a2ebc1961a36a}{isGGA\_}} = \textcolor{keyword}{false};\};}
\DoxyCodeLine{144 }
\DoxyCodeLine{145   \}; \textcolor{comment}{// class LDA}}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 }
\DoxyCodeLine{148 }
\DoxyCodeLine{152   \textcolor{keyword}{class }\mbox{\hyperlink{classChronusQ_1_1GGA}{GGA}} : \textcolor{keyword}{public} \mbox{\hyperlink{classChronusQ_1_1DFTFunctional}{DFTFunctional}} \{}
\DoxyCodeLine{153 }
\DoxyCodeLine{154   \textcolor{keyword}{public}:}
\DoxyCodeLine{155     \mbox{\hyperlink{classChronusQ_1_1GGA_a820788ba7877a9cb96d62b03ec1380fc}{GGA}}(\textcolor{keywordtype}{int} FUNC\_IDENT) : \mbox{\hyperlink{classChronusQ_1_1DFTFunctional}{DFTFunctional}}(FUNC\_IDENT) \{ this-\/>\mbox{\hyperlink{classChronusQ_1_1DFTFunctional_a71093cbd266475d7664a2ebc1961a36a}{isGGA\_}} = \textcolor{keyword}{true};\};}
\DoxyCodeLine{156     }
\DoxyCodeLine{157   \}; \textcolor{comment}{// class GGA}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 \};}
\DoxyCodeLine{160 }
\DoxyCodeLine{161 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{libxc__wrappers_8hpp}{dft/libxc\_wrappers.hpp}}>}}
\DoxyCodeLine{162 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{epc_8hpp}{dft/epc.hpp}}>}}

\end{DoxyCode}
