\hypertarget{skipSCF_8hpp_source}{}\doxysection{skip\+SCF.\+hpp}
\label{skipSCF_8hpp_source}\index{include/modifyorbitals/skipSCF.hpp@{include/modifyorbitals/skipSCF.hpp}}
\mbox{\hyperlink{skipSCF_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ *  This file is part of the Chronus Quantum (ChronusQ) software package}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ *  Copyright (C) 2014-\/2022 Li Research Group (University of Washington)}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ *  This program is free software; you can redistribute it and/or modify}}
\DoxyCodeLine{7 \textcolor{comment}{ *  it under the terms of the GNU General Public License as published by}}
\DoxyCodeLine{8 \textcolor{comment}{ *  the Free Software Foundation; either version 2 of the License, or}}
\DoxyCodeLine{9 \textcolor{comment}{ *  (at your option) any later version.}}
\DoxyCodeLine{10 \textcolor{comment}{ *}}
\DoxyCodeLine{11 \textcolor{comment}{ *  This program is distributed in the hope that it will be useful,}}
\DoxyCodeLine{12 \textcolor{comment}{ *  but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{13 \textcolor{comment}{ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{14 \textcolor{comment}{ *  GNU General Public License for more details.}}
\DoxyCodeLine{15 \textcolor{comment}{ *}}
\DoxyCodeLine{16 \textcolor{comment}{ *  You should have received a copy of the GNU General Public License along}}
\DoxyCodeLine{17 \textcolor{comment}{ *  with this program; if not, write to the Free Software Foundation, Inc.,}}
\DoxyCodeLine{18 \textcolor{comment}{ *  51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301 USA.}}
\DoxyCodeLine{19 \textcolor{comment}{ *}}
\DoxyCodeLine{20 \textcolor{comment}{ *  Contact the Developers:}}
\DoxyCodeLine{21 \textcolor{comment}{ *    E-\/Mail: xsli@uw.edu}}
\DoxyCodeLine{22 \textcolor{comment}{ *}}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{conventionalSCF_8hpp}{modifyorbitals/conventionalSCF.hpp}}>}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceChronusQ}{ChronusQ}} \{}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{template} <\textcolor{keyword}{typename} MatsT>}
\DoxyCodeLine{31 \textcolor{keyword}{class }\mbox{\hyperlink{classChronusQ_1_1SkipSCF}{SkipSCF}} : \textcolor{keyword}{public} \mbox{\hyperlink{classChronusQ_1_1ConventionalSCF}{ConventionalSCF}}<MatsT> \{}
\DoxyCodeLine{32 \textcolor{keyword}{public}:}
\DoxyCodeLine{33   \textcolor{comment}{// Constructor}}
\DoxyCodeLine{34   \mbox{\hyperlink{classChronusQ_1_1SkipSCF_a9491f824c0d339c2b20a1cb6ab610df3}{SkipSCF}}() = \textcolor{keyword}{delete};}
\DoxyCodeLine{35   \mbox{\hyperlink{classChronusQ_1_1SkipSCF_ac7db72dc1401b2f440beafe6615f77b5}{SkipSCF}}(\mbox{\hyperlink{structChronusQ_1_1SCFControls}{SCFControls}} \mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a1c2583249553f15ab9bfefa73efac407}{scfControls}}, \mbox{\hyperlink{structChronusQ_1_1MPI__Comm}{MPI\_Comm}} \mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_a4359453137e2d44a53b5af2d5d7e764a}{comm}}, \mbox{\hyperlink{structChronusQ_1_1ModifyOrbitalsOptions}{ModifyOrbitalsOptions<MatsT>}} mod, \mbox{\hyperlink{classChronusQ_1_1CQMemManager}{CQMemManager}}\& mem):}
\DoxyCodeLine{36       \mbox{\hyperlink{classChronusQ_1_1ConventionalSCF}{ConventionalSCF}}<MatsT>(\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a1c2583249553f15ab9bfefa73efac407}{scfControls}}, \mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_a4359453137e2d44a53b5af2d5d7e764a}{comm}}, mod, mem) \{\}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38   \textcolor{comment}{// Functions}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40   \textcolor{comment}{// RunModifyOrbitals is a stripped down version from OptimizeOrbitals}}
\DoxyCodeLine{41   \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1SkipSCF_a13781a3de827057cf7a5eea1959bbf63}{runModifyOrbitals}}(\mbox{\hyperlink{structChronusQ_1_1EMPerturbation}{EMPerturbation}}\& pert, \mbox{\hyperlink{namespaceChronusQ_a32dd4e864b3fd07b3a799dc7faf8aa9b}{VecMORef<MatsT>}}\& mo, \mbox{\hyperlink{namespaceChronusQ_aaa9660c9e257a334c13d30b0814c424c}{VecEPtr}}\& eps) \{}
\DoxyCodeLine{42     \mbox{\hyperlink{classChronusQ_1_1ProgramTimer_a9a328014ee423173ec33b1afc29bda4a}{ProgramTimer::tick}}(\textcolor{stringliteral}{"{}SCF Total"{}});}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{comment}{// Form the Fock matrix D(k) -\/> F(k)}}
\DoxyCodeLine{45     \mbox{\hyperlink{classChronusQ_1_1ProgramTimer_a9698b57cd81ca4095a7668b46683eb71}{ProgramTimer::timeOp}}(\textcolor{stringliteral}{"{}Form Fock"{}}, [\&]() \{ this-\/>\mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_adeb8c627dd6131558cc892e292c3de65}{modOrbOpt}}.formFock(pert); \});}
\DoxyCodeLine{46     this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a68d405fd27d1f96fb4d995e10d084c2a}{computeEigenvalues}}(mo,eps);}
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{comment}{// Compute initial properties}}
\DoxyCodeLine{49     this-\/>\mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_adeb8c627dd6131558cc892e292c3de65}{modOrbOpt}}.computeProperties(pert);}
\DoxyCodeLine{50 }
\DoxyCodeLine{51     \textcolor{keywordflow}{if}( this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a1c2583249553f15ab9bfefa73efac407}{scfControls}}.\mbox{\hyperlink{structChronusQ_1_1SCFControls_accc6822cea5c15bc2c1b846a10224ee9}{printLevel}} > 0 and \mbox{\hyperlink{namespaceChronusQ_ac9433164d43ee9f6f0c49e49698f680f}{MPIRank}}(this-\/>\mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_a4359453137e2d44a53b5af2d5d7e764a}{comm}}) == 0 ) \{}
\DoxyCodeLine{52       this-\/>\mbox{\hyperlink{classChronusQ_1_1ConventionalSCF_ad2b6dac9d331592e27336f2c3b2782f2}{printRunHeader}}(std::cout, pert);}
\DoxyCodeLine{53       this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_aac8295c1fe0cd43df697fa80fec961d3}{printIteration}}(std::cout, \textcolor{keyword}{false});}
\DoxyCodeLine{54     \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     \textcolor{comment}{// Save current state of the wave function (method specific)}}
\DoxyCodeLine{57     this-\/>\mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_adeb8c627dd6131558cc892e292c3de65}{modOrbOpt}}.saveCurrentState();}
\DoxyCodeLine{58 }
\DoxyCodeLine{59     \textcolor{comment}{// printSCFFooter(isConverged);}}
\DoxyCodeLine{60     \textcolor{keywordflow}{if}( this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a1c2583249553f15ab9bfefa73efac407}{scfControls}}.\mbox{\hyperlink{structChronusQ_1_1SCFControls_accc6822cea5c15bc2c1b846a10224ee9}{printLevel}} > 0 ) \{}
\DoxyCodeLine{61       std::cout << std::endl}
\DoxyCodeLine{62                 << \textcolor{stringliteral}{"{}SCF Completed: E("{}} << this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a1c2583249553f15ab9bfefa73efac407}{scfControls}}.\mbox{\hyperlink{structChronusQ_1_1SCFControls_ab78575ee1d21e6341a58937fcb5dfada}{refShortName\_}} << \textcolor{stringliteral}{"{}) = "{}} << std::fixed << std::setprecision(10)}
\DoxyCodeLine{63                 << this-\/>\mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_adeb8c627dd6131558cc892e292c3de65}{modOrbOpt}}.getTotalEnergy() << \textcolor{stringliteral}{"{} Eh after "{}} << this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a4469ba54598945a7ef9d8bd4f70531d6}{scfConv}}.\mbox{\hyperlink{structChronusQ_1_1SCFConvergence_ad5f8669ce5dfe5f9ec0e6d8e000cc045}{nSCFIter}} << \textcolor{stringliteral}{"{} SCF Iterations"{}} << std::endl;}
\DoxyCodeLine{64     \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{keywordflow}{if}( this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a1c2583249553f15ab9bfefa73efac407}{scfControls}}.\mbox{\hyperlink{structChronusQ_1_1SCFControls_accc6822cea5c15bc2c1b846a10224ee9}{printLevel}} > 0 ) std::cout << \mbox{\hyperlink{namespaceChronusQ_a0c336a0275cfd2e395b01766efa494b2}{BannerEnd}} << std::endl;}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{keywordflow}{if}( this-\/>\mbox{\hyperlink{classChronusQ_1_1OptimizeOrbitals_a1c2583249553f15ab9bfefa73efac407}{scfControls}}.\mbox{\hyperlink{structChronusQ_1_1SCFControls_accc6822cea5c15bc2c1b846a10224ee9}{printLevel}} > 1 ) \{ this-\/>\mbox{\hyperlink{classChronusQ_1_1ModifyOrbitals_adeb8c627dd6131558cc892e292c3de65}{modOrbOpt}}.printProperties(); \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70     \mbox{\hyperlink{classChronusQ_1_1ProgramTimer_a596d67507317c2c8b2dfb92d99e48425}{ProgramTimer::tock}}(\textcolor{stringliteral}{"{}SCF Total"{}});}
\DoxyCodeLine{71 }
\DoxyCodeLine{72   \};   \textcolor{comment}{// SkipSCF<MatsT>::RunModifyOrbitals()}}
\DoxyCodeLine{73 \};}
\DoxyCodeLine{74 \};   \textcolor{comment}{// namespace ChronusQ}}

\end{DoxyCode}
