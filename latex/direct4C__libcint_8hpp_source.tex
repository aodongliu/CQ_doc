\hypertarget{direct4C__libcint_8hpp_source}{}\doxysection{direct4\+C\+\_\+libcint.\+hpp}
\label{direct4C__libcint_8hpp_source}\index{include/particleintegrals/contract/direct4C\_libcint.hpp@{include/particleintegrals/contract/direct4C\_libcint.hpp}}
\mbox{\hyperlink{direct4C__libcint_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* }}
\DoxyCodeLine{2 \textcolor{comment}{ *  This file is part of the Chronus Quantum (ChronusQ) software package}}
\DoxyCodeLine{3 \textcolor{comment}{ *  }}
\DoxyCodeLine{4 \textcolor{comment}{ *  Copyright (C) 2014-\/2022 Li Research Group (University of Washington)}}
\DoxyCodeLine{5 \textcolor{comment}{ *  }}
\DoxyCodeLine{6 \textcolor{comment}{ *  This program is free software; you can redistribute it and/or modify}}
\DoxyCodeLine{7 \textcolor{comment}{ *  it under the terms of the GNU General Public License as published by}}
\DoxyCodeLine{8 \textcolor{comment}{ *  the Free Software Foundation; either version 2 of the License, or}}
\DoxyCodeLine{9 \textcolor{comment}{ *  (at your option) any later version.}}
\DoxyCodeLine{10 \textcolor{comment}{ *  }}
\DoxyCodeLine{11 \textcolor{comment}{ *  This program is distributed in the hope that it will be useful,}}
\DoxyCodeLine{12 \textcolor{comment}{ *  but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{13 \textcolor{comment}{ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{14 \textcolor{comment}{ *  GNU General Public License for more details.}}
\DoxyCodeLine{15 \textcolor{comment}{ *  }}
\DoxyCodeLine{16 \textcolor{comment}{ *  You should have received a copy of the GNU General Public License along}}
\DoxyCodeLine{17 \textcolor{comment}{ *  with this program; if not, write to the Free Software Foundation, Inc.,}}
\DoxyCodeLine{18 \textcolor{comment}{ *  51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301 USA.}}
\DoxyCodeLine{19 \textcolor{comment}{ *  }}
\DoxyCodeLine{20 \textcolor{comment}{ *  Contact the Developers:}}
\DoxyCodeLine{21 \textcolor{comment}{ *    E-\/Mail: xsli@uw.edu}}
\DoxyCodeLine{22 \textcolor{comment}{ *  }}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{integrals_8hpp}{integrals.hpp}}>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{inhouseaointegral_8hpp}{particleintegrals/inhouseaointegral.hpp}}>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{matout_8hpp}{util/matout.hpp}}>}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{blas1_8hpp}{cqlinalg/blas1.hpp}}>}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{blasext_8hpp}{cqlinalg/blasext.hpp}}>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{blasutil_8hpp}{cqlinalg/blasutil.hpp}}>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{physcon_8hpp}{physcon.hpp}}>}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{threads_8hpp}{util/threads.hpp}}>}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{mpi_8hpp}{util/mpi.hpp}}>}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{timer_8hpp}{util/timer.hpp}}>}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{math_8hpp}{util/math.hpp}}>}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{gtodirectreleri_8hpp}{particleintegrals/twopints/gtodirectreleri.hpp}}>}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{contract_2direct_8hpp}{particleintegrals/contract/direct.hpp}}>}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 }
\DoxyCodeLine{46 \textcolor{preprocessor}{\#define \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{preprocessor}{\#define \_CONTRACTION\_}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{libcint_8hpp}{libcint.hpp}}>}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceChronusQ}{ChronusQ}} \{}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 }
\DoxyCodeLine{56 \textcolor{comment}{  /**************************/}}
\DoxyCodeLine{57   \textcolor{comment}{/* Libcint 4C-\/direct Implementation */}}
\DoxyCodeLine{58 \textcolor{comment}{  /**************************/}}
\DoxyCodeLine{59   \textcolor{comment}{// For DCB Hamiltonian,}}
\DoxyCodeLine{60   \textcolor{comment}{// 12 density matrices upon input stored as}}
\DoxyCodeLine{61   \textcolor{comment}{// LL(MS,MX,MY,MZ), SS(MS,MX,MY,MZ), LS(MS,MX,MY,MZ)}}
\DoxyCodeLine{62   \textcolor{comment}{//}}
\DoxyCodeLine{63   \textcolor{comment}{// 12 contrated matrices upon output stored as}}
\DoxyCodeLine{64   \textcolor{comment}{// LL(MS,MX,MY,MZ), SS(MS,MX,MY,MZ), LS(MS,MX,MY,MZ)}}
\DoxyCodeLine{65   \textcolor{comment}{//}}
\DoxyCodeLine{66   \textcolor{comment}{//}}
\DoxyCodeLine{67   \textcolor{comment}{// Density Matrices are assumed as Hermitian here}}
\DoxyCodeLine{68   \textcolor{comment}{//}}
\DoxyCodeLine{69  }
\DoxyCodeLine{70   \textcolor{keyword}{template} <\textcolor{keyword}{typename} MatsT, \textcolor{keyword}{typename} IntsT>}
\DoxyCodeLine{71   \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1GTODirectRelERIContraction_a958c5d3fc117a71037c81481da7dc719}{GTODirectRelERIContraction<MatsT,IntsT>::directScaffoldLibcint}}(}
\DoxyCodeLine{72     \mbox{\hyperlink{structChronusQ_1_1MPI__Comm}{MPI\_Comm}} comm, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} screen,}
\DoxyCodeLine{73     std::vector<\mbox{\hyperlink{structChronusQ_1_1TwoBodyContraction}{TwoBodyContraction<MatsT>}}> \&matList)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \textcolor{keywordflow}{if} (not matList[0].HER) }
\DoxyCodeLine{76       \mbox{\hyperlink{namespaceChronusQ_afbba655765a7a40e19e2bea928a687c7}{CErr}}(\textcolor{stringliteral}{"{}Non-\/Hermitian Density in 4C Contraction (Couloumb + Exchange) is NYI"{}});}
\DoxyCodeLine{77     }
\DoxyCodeLine{78     \mbox{\hyperlink{classChronusQ_1_1DirectTPI}{DirectTPI<IntsT>}} \&originalERI =}
\DoxyCodeLine{79         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classChronusQ_1_1DirectTPI}{DirectTPI<IntsT>}}\&\textcolor{keyword}{>}(this-\/>ints\_);}
\DoxyCodeLine{80     \mbox{\hyperlink{classChronusQ_1_1CQMemManager}{CQMemManager}}\& memManager\_ = originalERI.\mbox{\hyperlink{classChronusQ_1_1ParticleIntegrals_a4980f581ea843bd4ca6be7ac88064274}{memManager}}();}
\DoxyCodeLine{81     \mbox{\hyperlink{structChronusQ_1_1BasisSet}{BasisSet}}\& originalBasisSet\_ = originalERI.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_a4a476a2dc5e606ee34f0a973b9ddce5c}{basisSet}}();}
\DoxyCodeLine{82     \mbox{\hyperlink{structChronusQ_1_1Molecule}{Molecule}}\& molecule\_ = originalERI.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_aaa9df135704f690d4274a30622cbc86c}{molecule}}();}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keywordflow}{if} (originalBasisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a87bdf52af466b6675078a34788641774}{forceCart}})}
\DoxyCodeLine{85       \mbox{\hyperlink{namespaceChronusQ_afbba655765a7a40e19e2bea928a687c7}{CErr}}(\textcolor{stringliteral}{"{}Libcint + cartesian GTO NYI."{}});}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     \mbox{\hyperlink{structChronusQ_1_1BasisSet}{BasisSet}} basisSet\_ = originalBasisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a04cfa73f279aae9d94a4ee99fd720fa1}{groupGeneralContractionBasis}}();}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     \textcolor{keywordtype}{size\_t} buffSize = std::max\_element(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}.begin(),}
\DoxyCodeLine{90                                        basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}.end(),}
\DoxyCodeLine{91                                        [](libint2::Shell \&a, libint2::Shell \&b) \{}
\DoxyCodeLine{92                                          return a.size() < b.size();}
\DoxyCodeLine{93                                        \})-\/>size();}
\DoxyCodeLine{94 }
\DoxyCodeLine{95     \mbox{\hyperlink{classChronusQ_1_1DirectTPI}{DirectTPI<IntsT>}} \&eri = originalERI;}
\DoxyCodeLine{96     \textcolor{comment}{//DirectTPI<IntsT> eri(memManager\_, basisSet\_, molecule\_, originalERI.threshSchwarz());}}
\DoxyCodeLine{97     }
\DoxyCodeLine{98     \textcolor{comment}{// Determine the number of OpenMP threads}}
\DoxyCodeLine{99     \textcolor{keywordtype}{size\_t} nThreads  = \mbox{\hyperlink{namespaceChronusQ_a3320ee560c87921c8d84885db82e9917}{GetNumThreads}}();}
\DoxyCodeLine{100     \textcolor{keywordtype}{size\_t} LAThreads = \mbox{\hyperlink{namespaceChronusQ_a3152808c4819d6cbf8a29aef92728866}{GetLAThreads}}();}
\DoxyCodeLine{101     \mbox{\hyperlink{namespaceChronusQ_a7b13ac1d1109f4a015feaab04cb3eaee}{SetLAThreads}}(1); \textcolor{comment}{// Turn off parallelism in LA functions}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 }
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \textcolor{comment}{    /****************************/}}
\DoxyCodeLine{106     \textcolor{comment}{/* Format Basis for Libcint */}}
\DoxyCodeLine{107 \textcolor{comment}{    /****************************/}}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{keywordtype}{int} nAtoms = molecule\_.\mbox{\hyperlink{structChronusQ_1_1Molecule_abe50222c8aa9cb69f03dbab8623ff171}{nAtoms}};}
\DoxyCodeLine{110     \textcolor{keywordtype}{int} nShells = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a936871b121472a416ee6f947ccdea4b4}{nShell}};}
\DoxyCodeLine{111     \textcolor{keywordtype}{int} iAtom, iShell, off;}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{comment}{// ATM\_SLOTS = 6; BAS\_SLOTS = 8;}}
\DoxyCodeLine{114     \textcolor{keywordtype}{int} *atm = memManager\_.template malloc<int>(nAtoms * ATM\_SLOTS);}
\DoxyCodeLine{115     \textcolor{keywordtype}{int} *bas = memManager\_.template malloc<int>(nShells * BAS\_SLOTS);}
\DoxyCodeLine{116     \textcolor{keywordtype}{double} *env = memManager\_.template malloc<double>(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_aa66974bc0717a4bdcb09cc61d469ebda}{getLibcintEnvLength}}(molecule\_));}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 }
\DoxyCodeLine{119     basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a0dea80bb1ae5e74a731372d40ebbe43e}{setLibcintEnv}}(molecule\_, atm, bas, env);}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 }
\DoxyCodeLine{122     \textcolor{keywordtype}{size\_t} cache\_size = 0;}
\DoxyCodeLine{123     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nShells; i++) \{}
\DoxyCodeLine{124       \textcolor{keywordtype}{size\_t} n;}
\DoxyCodeLine{125       \textcolor{keywordtype}{int} shls[4]\{i,i,i,i\};}
\DoxyCodeLine{126       \textcolor{keywordflow}{if}(matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba8578053891caf9c4af3c665d73fa43ac}{TWOBODY\_CONTRACTION\_TYPE::BARE\_COULOMB}} or}
\DoxyCodeLine{127          matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba1d269d4b7d6c561fc04b81a2a178e2a5}{TWOBODY\_CONTRACTION\_TYPE::LLLL}} or}
\DoxyCodeLine{128          matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbad5017ac8c585ad30ff49af6467d2efc6}{TWOBODY\_CONTRACTION\_TYPE::LLSS}}) \{}
\DoxyCodeLine{129         n = int2e\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{130         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{131       \}}
\DoxyCodeLine{132       \textcolor{keywordflow}{if}(matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbaf5b0f392e82b90ea1452a00512088d53}{TWOBODY\_CONTRACTION\_TYPE::SSSS}} or}
\DoxyCodeLine{133          matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba1d269d4b7d6c561fc04b81a2a178e2a5}{TWOBODY\_CONTRACTION\_TYPE::LLLL}} or}
\DoxyCodeLine{134          matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbad5017ac8c585ad30ff49af6467d2efc6}{TWOBODY\_CONTRACTION\_TYPE::LLSS}}) \{}
\DoxyCodeLine{135         n = int2e\_ipvip1ipvip2\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{136         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{137       \}}
\DoxyCodeLine{138       \textcolor{keywordflow}{if}(matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba1d269d4b7d6c561fc04b81a2a178e2a5}{TWOBODY\_CONTRACTION\_TYPE::LLLL}} or}
\DoxyCodeLine{139          matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbad5017ac8c585ad30ff49af6467d2efc6}{TWOBODY\_CONTRACTION\_TYPE::LLSS}}) \{}
\DoxyCodeLine{140         n = int2e\_ipvip1\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{141         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{142       \}}
\DoxyCodeLine{143       \textcolor{keywordflow}{if}(matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba619fb0d8a58386d6c365eb7fa1bae867}{TWOBODY\_CONTRACTION\_TYPE::GAUNT}}) \{}
\DoxyCodeLine{144         n = int2e\_ip1ip2\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{145         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{146       \}}
\DoxyCodeLine{147       \textcolor{keywordflow}{if}(matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba01337b51d63cd7bba6d5daf63ff8d911}{TWOBODY\_CONTRACTION\_TYPE::GAUGE}}) \{}
\DoxyCodeLine{148         n = int2e\_gauge\_r1\_ssp1sps2\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{149         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{150         n = int2e\_gauge\_r2\_ssp1sps2\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{151         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{152         n = int2e\_gauge\_r1\_ssp1ssp2\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{153         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{154         n = int2e\_gauge\_r2\_ssp1ssp2\_sph(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{155         cache\_size = std::max(cache\_size, n);}
\DoxyCodeLine{156       \}}
\DoxyCodeLine{157     \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 }
\DoxyCodeLine{160     \textcolor{keyword}{enum} ERI\_2ND\_DERIV \{}
\DoxyCodeLine{161       AxBx,}
\DoxyCodeLine{162       AxBy,}
\DoxyCodeLine{163       AxBz,}
\DoxyCodeLine{164       AyBx,}
\DoxyCodeLine{165       AyBy,}
\DoxyCodeLine{166       AyBz,}
\DoxyCodeLine{167       AzBx,}
\DoxyCodeLine{168       AzBy,}
\DoxyCodeLine{169       AzBz}
\DoxyCodeLine{170     \};}
\DoxyCodeLine{171 }
\DoxyCodeLine{172     \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{173     \textcolor{comment}{/* End of Basis Formatting for Libcint */}}
\DoxyCodeLine{174     \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{175 }
\DoxyCodeLine{176 }
\DoxyCodeLine{177 }
\DoxyCodeLine{178     \textcolor{comment}{// Get threads result buffer}}
\DoxyCodeLine{179     \textcolor{keywordtype}{size\_t} buffN4 = buffSize*buffSize*buffSize*buffSize;}
\DoxyCodeLine{180 }
\DoxyCodeLine{181     \textcolor{comment}{// 81 is for fourth-\/derivative; 9 for second derivative}}
\DoxyCodeLine{182     \textcolor{keywordtype}{int} nERI;}
\DoxyCodeLine{183     \textcolor{keywordtype}{double} *buffAll = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{184     \textcolor{keywordtype}{double} *cacheAll = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{185     \textcolor{keywordtype}{double} *ERIBuffer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{186 }
\DoxyCodeLine{187     \textcolor{keywordtype}{size\_t} maxShellSize = buffSize;}
\DoxyCodeLine{188     \textcolor{keywordtype}{size\_t} NB  = maxShellSize*4;}
\DoxyCodeLine{189     \textcolor{keywordtype}{size\_t} NB2 = NB*NB;}
\DoxyCodeLine{190     \textcolor{keywordtype}{size\_t} NB3 = NB2*NB;}
\DoxyCodeLine{191     \textcolor{keywordtype}{size\_t} NB4 = NB2*NB2;}
\DoxyCodeLine{192     \textcolor{keywordtype}{size\_t} NB4\_2 = 2*NB4;}
\DoxyCodeLine{193     \textcolor{keywordtype}{size\_t} NB4\_3 = 3*NB4;}
\DoxyCodeLine{194 }
\DoxyCodeLine{195     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nBasis   = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a40ad4a89b440bf71e0ef6ba317d8123f}{nBasis}};}
\DoxyCodeLine{196     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nMat     = matList.size();}
\DoxyCodeLine{197     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nShell   = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a936871b121472a416ee6f947ccdea4b4}{nShell}};}
\DoxyCodeLine{198 }
\DoxyCodeLine{199 }
\DoxyCodeLine{200     \textcolor{keyword}{enum} DIRAC\_PAULI\_SPINOR\_COMP \{}
\DoxyCodeLine{201       CLLMS,}
\DoxyCodeLine{202       XLLMS,}
\DoxyCodeLine{203       XLLMX,}
\DoxyCodeLine{204       XLLMY,}
\DoxyCodeLine{205       XLLMZ,}
\DoxyCodeLine{206       CSSMS,}
\DoxyCodeLine{207       CSSMX,}
\DoxyCodeLine{208       CSSMY,}
\DoxyCodeLine{209       CSSMZ,}
\DoxyCodeLine{210       XSSMS,}
\DoxyCodeLine{211       XSSMX,}
\DoxyCodeLine{212       XSSMY,}
\DoxyCodeLine{213       XSSMZ,}
\DoxyCodeLine{214       XLSMS,}
\DoxyCodeLine{215       XLSMX,}
\DoxyCodeLine{216       XLSMY,}
\DoxyCodeLine{217       XLSMZ,}
\DoxyCodeLine{218 \textcolor{comment}{//    Gaunt}}
\DoxyCodeLine{219       CLSMS,}
\DoxyCodeLine{220       CLSMX,}
\DoxyCodeLine{221       CLSMY,}
\DoxyCodeLine{222       CLSMZ,}
\DoxyCodeLine{223       CSLMS,}
\DoxyCodeLine{224       CSLMX,}
\DoxyCodeLine{225       CSLMY,}
\DoxyCodeLine{226       CSLMZ,}
\DoxyCodeLine{227       XSLMS,}
\DoxyCodeLine{228       XSLMX,}
\DoxyCodeLine{229       XSLMY,}
\DoxyCodeLine{230       XSLMZ}
\DoxyCodeLine{231     \};}
\DoxyCodeLine{232 }
\DoxyCodeLine{233 }
\DoxyCodeLine{234     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < nMat; iMat++)}
\DoxyCodeLine{235       memset(matList[iMat].AX,0.,nBasis*nBasis*\textcolor{keyword}{sizeof}(MatsT));}
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{comment}{// Set up scratch space}}
\DoxyCodeLine{238     std::vector<std::vector<MatsT*>> AXthreads;}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     MatsT *AXRaw = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{241     AXRaw = memManager\_.malloc<MatsT>(nThreads*nMat*nBasis*nBasis);    }
\DoxyCodeLine{242 }
\DoxyCodeLine{243     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iThread = 0; iThread < nThreads; iThread++) \{}
\DoxyCodeLine{244       AXthreads.emplace\_back();}
\DoxyCodeLine{245       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < nMat; iMat++) }
\DoxyCodeLine{246         AXthreads.back().push\_back(AXRaw + iThread*nMat*nBasis*nBasis + iMat*nBasis*nBasis);}
\DoxyCodeLine{247     \}}
\DoxyCodeLine{248 }
\DoxyCodeLine{249 }
\DoxyCodeLine{250 }
\DoxyCodeLine{251 }
\DoxyCodeLine{252 \textcolor{comment}{    /************************************/}}
\DoxyCodeLine{253     \textcolor{comment}{/*                                  */}}
\DoxyCodeLine{254     \textcolor{comment}{/* Preparation of Schwarz Screening */}}
\DoxyCodeLine{255     \textcolor{comment}{/*                                  */}}
\DoxyCodeLine{256 \textcolor{comment}{    /************************************/}}
\DoxyCodeLine{257 }
\DoxyCodeLine{258     \textcolor{keywordtype}{double} *SchwarzSSSS = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{259 }
\DoxyCodeLine{260     \textcolor{keywordtype}{double} *SchwarzERI = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{261 }
\DoxyCodeLine{262     \textcolor{keywordflow}{if}(matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba8578053891caf9c4af3c665d73fa43ac}{TWOBODY\_CONTRACTION\_TYPE::BARE\_COULOMB}} or}
\DoxyCodeLine{263        matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba1d269d4b7d6c561fc04b81a2a178e2a5}{TWOBODY\_CONTRACTION\_TYPE::LLLL}} or}
\DoxyCodeLine{264        matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbad5017ac8c585ad30ff49af6467d2efc6}{TWOBODY\_CONTRACTION\_TYPE::LLSS}}) \{}
\DoxyCodeLine{265 \textcolor{comment}{//      if(SchwarzERI == nullptr) eri.computeSchwarz();}}
\DoxyCodeLine{266   }
\DoxyCodeLine{267 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{268       \textcolor{keyword}{auto} topERIchwarz = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{269 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{270   }
\DoxyCodeLine{271       nERI = 1;}
\DoxyCodeLine{272       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(nERI*buffN4*nThreads);}
\DoxyCodeLine{273       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{274       SchwarzERI = memManager\_.malloc<\textcolor{keywordtype}{double}>(nShell*nShell);}
\DoxyCodeLine{275       memset(SchwarzERI,0,nShell*nShell*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{276   }
\DoxyCodeLine{277 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{278       \{}
\DoxyCodeLine{279   }
\DoxyCodeLine{280         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{281         \textcolor{keywordtype}{size\_t} n1,n2;}
\DoxyCodeLine{282   }
\DoxyCodeLine{283         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{284         \textcolor{keywordtype}{double} *buff = \&buffAll[nERI*buffN4*thread\_id];}
\DoxyCodeLine{285         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{286   }
\DoxyCodeLine{287         \textcolor{comment}{// set up Schwarz screening}}
\DoxyCodeLine{288         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s12(0); s1 < basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a936871b121472a416ee6f947ccdea4b4}{nShell}}; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{289   }
\DoxyCodeLine{290           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{291   }
\DoxyCodeLine{292         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 <= s1; bf2\_s+=n2, s2++, s12++) \{}
\DoxyCodeLine{293   }
\DoxyCodeLine{294           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{295   }
\DoxyCodeLine{296           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{297 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{298           \textcolor{keywordflow}{if}( s12 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{299 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{300   }
\DoxyCodeLine{301           shls[0] = int(s1);}
\DoxyCodeLine{302           shls[1] = int(s2);}
\DoxyCodeLine{303           shls[2] = int(s1);}
\DoxyCodeLine{304           shls[3] = int(s2);}
\DoxyCodeLine{305   }
\DoxyCodeLine{306           \textcolor{keyword}{auto} nQuad = n1*n2*n1*n2;}
\DoxyCodeLine{307   }
\DoxyCodeLine{308           \textcolor{keywordflow}{if}(int2e\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{309 }
\DoxyCodeLine{310           \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} iERI(0); iERI < nERI*nQuad; iERI++) }
\DoxyCodeLine{311             SchwarzERI[s1+s2*nShell] = std::max(SchwarzERI[s1+s2*nShell], std::abs(buff[iERI]));}
\DoxyCodeLine{312   }
\DoxyCodeLine{313           SchwarzERI[s1+s2*nShell] = std::sqrt(SchwarzERI[s1+s2*nShell]);}
\DoxyCodeLine{314           SchwarzERI[s2+s1*nShell] = SchwarzERI[s1+s2*nShell];}
\DoxyCodeLine{315   }
\DoxyCodeLine{316         \}}
\DoxyCodeLine{317         \}}
\DoxyCodeLine{318   }
\DoxyCodeLine{319       \};}
\DoxyCodeLine{320 }
\DoxyCodeLine{321       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{322   }
\DoxyCodeLine{323 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{324       \textcolor{keyword}{auto} durERIchwarz = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topERIchwarz);}
\DoxyCodeLine{325 \textcolor{comment}{//      std::cout << "{}ERI Schwarz took "{} <<  durERIchwarz << "{} s\(\backslash\)n"{}; }}
\DoxyCodeLine{326   }
\DoxyCodeLine{327       \textcolor{comment}{//std::cout << std::endl;}}
\DoxyCodeLine{328 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{329   }
\DoxyCodeLine{330     \};}
\DoxyCodeLine{331  }
\DoxyCodeLine{332 }
\DoxyCodeLine{333     \textcolor{keywordflow}{if}(matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbaf5b0f392e82b90ea1452a00512088d53}{TWOBODY\_CONTRACTION\_TYPE::SSSS}} or }
\DoxyCodeLine{334        matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba1d269d4b7d6c561fc04b81a2a178e2a5}{TWOBODY\_CONTRACTION\_TYPE::LLLL}} or}
\DoxyCodeLine{335        matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbad5017ac8c585ad30ff49af6467d2efc6}{TWOBODY\_CONTRACTION\_TYPE::LLSS}}) \{}
\DoxyCodeLine{336   }
\DoxyCodeLine{337 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{338       \textcolor{keyword}{auto} topSSSSSchwarz = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{339 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{340   }
\DoxyCodeLine{341       nERI = 81;}
\DoxyCodeLine{342       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(nERI*buffN4*nThreads);}
\DoxyCodeLine{343       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{344       SchwarzSSSS = memManager\_.malloc<\textcolor{keywordtype}{double}>(nShell*nShell);}
\DoxyCodeLine{345       memset(SchwarzSSSS,0,nShell*nShell*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{346   }
\DoxyCodeLine{347 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{348       \{}
\DoxyCodeLine{349   }
\DoxyCodeLine{350         \textcolor{keywordtype}{double} C2 = 1./(4*\mbox{\hyperlink{namespaceChronusQ_a387c8ccd4e18ad322b87f75f51fd008d}{SpeedOfLight}}*\mbox{\hyperlink{namespaceChronusQ_a387c8ccd4e18ad322b87f75f51fd008d}{SpeedOfLight}});}
\DoxyCodeLine{351         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{352         \textcolor{keywordtype}{size\_t} n1,n2;}
\DoxyCodeLine{353   }
\DoxyCodeLine{354         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{355         \textcolor{keywordtype}{double} *buff = \&buffAll[nERI*buffN4*thread\_id];}
\DoxyCodeLine{356         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{357   }
\DoxyCodeLine{358         \textcolor{comment}{// set up Schwarz screening}}
\DoxyCodeLine{359         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s12(0); s1 < basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a936871b121472a416ee6f947ccdea4b4}{nShell}}; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{360   }
\DoxyCodeLine{361           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{362   }
\DoxyCodeLine{363         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 <= s1; bf2\_s+=n2, s2++, s12++) \{}
\DoxyCodeLine{364   }
\DoxyCodeLine{365           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{366   }
\DoxyCodeLine{367           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{368 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{369           \textcolor{keywordflow}{if}( s12 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{370 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{371   }
\DoxyCodeLine{372           shls[0] = int(s1);}
\DoxyCodeLine{373           shls[1] = int(s2);}
\DoxyCodeLine{374           shls[2] = int(s1);}
\DoxyCodeLine{375           shls[3] = int(s2);}
\DoxyCodeLine{376   }
\DoxyCodeLine{377           \textcolor{keyword}{auto} nQuad = n1*n2*n1*n2;}
\DoxyCodeLine{378   }
\DoxyCodeLine{379           \textcolor{keywordflow}{if}(int2e\_ipvip1ipvip2\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{380 }
\DoxyCodeLine{381           \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} iERI(0); iERI < nERI*nQuad; iERI++) }
\DoxyCodeLine{382             SchwarzSSSS[s1+s2*nShell] = std::max(SchwarzSSSS[s1+s2*nShell], std::abs(buff[iERI]));}
\DoxyCodeLine{383   }
\DoxyCodeLine{384           SchwarzSSSS[s1+s2*nShell] = C2*std::sqrt(SchwarzSSSS[s1+s2*nShell]);}
\DoxyCodeLine{385           SchwarzSSSS[s2+s1*nShell] = SchwarzSSSS[s1+s2*nShell];}
\DoxyCodeLine{386   }
\DoxyCodeLine{387         \}}
\DoxyCodeLine{388         \}}
\DoxyCodeLine{389   }
\DoxyCodeLine{390       \};}
\DoxyCodeLine{391 }
\DoxyCodeLine{392       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{393   }
\DoxyCodeLine{394 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{395       \textcolor{keyword}{auto} durSSSSSchwarz = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topSSSSSchwarz);}
\DoxyCodeLine{396 \textcolor{comment}{//      std::cout << "{}∇A∇B∇C∇D Schwarz took "{} <<  durSSSSSchwarz << "{} s\(\backslash\)n"{}; }}
\DoxyCodeLine{397   }
\DoxyCodeLine{398       \textcolor{comment}{//std::cout << std::endl;}}
\DoxyCodeLine{399 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{400   }
\DoxyCodeLine{401     \};}
\DoxyCodeLine{402 \textcolor{comment}{    /****************************************/}}
\DoxyCodeLine{403     \textcolor{comment}{/*                                      */}}
\DoxyCodeLine{404     \textcolor{comment}{/* End Preparation of Schwarz Screening */}}
\DoxyCodeLine{405     \textcolor{comment}{/*                                      */}}
\DoxyCodeLine{406 \textcolor{comment}{    /****************************************/}}
\DoxyCodeLine{407 }
\DoxyCodeLine{408 }
\DoxyCodeLine{409 }
\DoxyCodeLine{410 }
\DoxyCodeLine{411 }
\DoxyCodeLine{412 }
\DoxyCodeLine{413 }
\DoxyCodeLine{414 }
\DoxyCodeLine{415 }
\DoxyCodeLine{416 }
\DoxyCodeLine{417     }
\DoxyCodeLine{418 }
\DoxyCodeLine{419 \textcolor{comment}{    /***********************************/}}
\DoxyCodeLine{420     \textcolor{comment}{/*                                 */}}
\DoxyCodeLine{421     \textcolor{comment}{/* Start of Bare-\/Coulomb-\/Exchange  */}}
\DoxyCodeLine{422     \textcolor{comment}{/*                                 */}}
\DoxyCodeLine{423 \textcolor{comment}{    /***********************************/}}
\DoxyCodeLine{424 }
\DoxyCodeLine{425     \textcolor{keywordflow}{if}( matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba8578053891caf9c4af3c665d73fa43ac}{TWOBODY\_CONTRACTION\_TYPE::BARE\_COULOMB}} ) \{}
\DoxyCodeLine{426 }
\DoxyCodeLine{427 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{428       \textcolor{keyword}{auto} topDirect = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{429 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{430 }
\DoxyCodeLine{431 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{432       \textcolor{comment}{// Compute shell block norms (∞-\/norm) of matList.X}}
\DoxyCodeLine{433       \textcolor{comment}{// CLLMS, XLLMS, XLLMX, XLLMY, XLLMZ Densitry matrices}}
\DoxyCodeLine{434       \textcolor{keywordtype}{int} mMat = 5;}
\DoxyCodeLine{435       \textcolor{keywordtype}{double} *ShBlkNorms\_raw = memManager\_.malloc<\textcolor{keywordtype}{double}>(mMat*nShell*nShell);}
\DoxyCodeLine{436       std::vector<double*> ShBlkNorms;}
\DoxyCodeLine{437   }
\DoxyCodeLine{438       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0, iOff = 0; iMat < mMat; iMat++, iOff += nShell*nShell ) \{}
\DoxyCodeLine{439   }
\DoxyCodeLine{440         \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[iMat].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{441         ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{442   }
\DoxyCodeLine{443       \}}
\DoxyCodeLine{444   }
\DoxyCodeLine{445       \textcolor{comment}{// Get the max over all the matricies for the shell block ∞-\/norms}}
\DoxyCodeLine{446       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} k = 0; k < nShell*nShell; k++) \{}
\DoxyCodeLine{447   }
\DoxyCodeLine{448         \textcolor{keywordtype}{double} mx = std::abs(ShBlkNorms[0][k]);}
\DoxyCodeLine{449         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < mMat; iMat++)}
\DoxyCodeLine{450           mx = std::max(mx,std::abs(ShBlkNorms[iMat][k]));}
\DoxyCodeLine{451         ShBlkNorms[0][k] = mx;}
\DoxyCodeLine{452    }
\DoxyCodeLine{453       \}}
\DoxyCodeLine{454 }
\DoxyCodeLine{455 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{456 }
\DoxyCodeLine{457 }
\DoxyCodeLine{458       \textcolor{comment}{// Keeping track of number of integrals skipped}}
\DoxyCodeLine{459       std::vector<size\_t> nSkip(nThreads,0);}
\DoxyCodeLine{460 }
\DoxyCodeLine{461       nERI = 1;}
\DoxyCodeLine{462       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(nERI*buffN4*nThreads);}
\DoxyCodeLine{463       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{464       memset(AXRaw,0,nThreads*nMat*nBasis*nBasis*\textcolor{keyword}{sizeof}(MatsT));}
\DoxyCodeLine{465 }
\DoxyCodeLine{466 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{467       \{}
\DoxyCodeLine{468         \textcolor{keywordtype}{int} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{469   }
\DoxyCodeLine{470         \textcolor{keyword}{auto} \&AX\_loc = AXthreads[thread\_id];}
\DoxyCodeLine{471   }
\DoxyCodeLine{472         \textcolor{keywordtype}{size\_t} n1,n2,n3,n4,m,n,k,l,mnkl,bf1,bf2,bf3,bf4;}
\DoxyCodeLine{473         \textcolor{keywordtype}{size\_t} s4\_max;}
\DoxyCodeLine{474         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{475         \textcolor{keywordtype}{double} *buff = \&buffAll[buffN4*thread\_id];}
\DoxyCodeLine{476         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{477   }
\DoxyCodeLine{478         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s1234(0); s1 < nShells; }
\DoxyCodeLine{479             bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{480   }
\DoxyCodeLine{481           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{482   }
\DoxyCodeLine{483         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 <= s1; bf2\_s+=n2, s2++) \{}
\DoxyCodeLine{484   }
\DoxyCodeLine{485           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{486           \textcolor{comment}{// Deneneracy factor for s1,s2 pair}}
\DoxyCodeLine{487           \textcolor{keywordtype}{double} s12\_deg = (s1 == s2) ? 1.0 : 2.0;}
\DoxyCodeLine{488 }
\DoxyCodeLine{489 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{490           \textcolor{keywordtype}{double} shMax12 = ShBlkNorms[0][s1 + s2*nShell];}
\DoxyCodeLine{491 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{492   }
\DoxyCodeLine{493         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s3(0), bf3\_s(0); s3 <= s1; bf3\_s+=n3, s3++) \{}
\DoxyCodeLine{494   }
\DoxyCodeLine{495           n3 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s3].size(); \textcolor{comment}{// Size of Shell 3}}
\DoxyCodeLine{496           s4\_max = (s1 == s3) ? s2 : s3; \textcolor{comment}{// Determine the unique max of Shell 4}}
\DoxyCodeLine{497 }
\DoxyCodeLine{498 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{499           \textcolor{keywordtype}{double} shMax123 = std::max(ShBlkNorms[0][s1 + s3*nShell], }
\DoxyCodeLine{500                                      ShBlkNorms[0][s2 + s3*nShell]);}
\DoxyCodeLine{501 }
\DoxyCodeLine{502           shMax123 = std::max(shMax123,shMax12);}
\DoxyCodeLine{503 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{504 }
\DoxyCodeLine{505         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s4(0), bf4\_s(0); s4 <= s4\_max; bf4\_s+=n4, s4++, s1234++) \{}
\DoxyCodeLine{506   }
\DoxyCodeLine{507           n4 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s4].size(); \textcolor{comment}{// Size of Shell 4}}
\DoxyCodeLine{508   }
\DoxyCodeLine{509           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{510 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{511           \textcolor{keywordflow}{if}( s1234 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{512 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{513   }
\DoxyCodeLine{514 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{515           \textcolor{keywordtype}{double} shMax = std::max(ShBlkNorms[0][s1 + s4*nShell],}
\DoxyCodeLine{516                                   std::max(ShBlkNorms[0][s2 + s4*nShell],}
\DoxyCodeLine{517                                            ShBlkNorms[0][s3 + s4*nShell]));}
\DoxyCodeLine{518 }
\DoxyCodeLine{519           shMax = std::max(shMax,shMax123);}
\DoxyCodeLine{520 }
\DoxyCodeLine{521           \textcolor{keywordflow}{if}((shMax*SchwarzERI[s1+s2*nShell]*SchwarzERI[s3+s4*nShell]) <}
\DoxyCodeLine{522           \textcolor{comment}{//if((SchwarzERI[s1+s2*nShell]*SchwarzERI[s3+s4*nShell]) <}}
\DoxyCodeLine{523              eri.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_a51ce753ee588706401406d4216c1ba74}{threshSchwarz}}()) \{ nSkip[thread\_id]++; \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{524 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{525 }
\DoxyCodeLine{526           \textcolor{comment}{// Degeneracy factor for s3,s4 pair}}
\DoxyCodeLine{527           \textcolor{keywordtype}{double} s34\_deg = (s3 == s4) ? 1.0 : 2.0;}
\DoxyCodeLine{528           \textcolor{comment}{// Degeneracy factor for s1, s2, s3, s4 quartet}}
\DoxyCodeLine{529           \textcolor{keywordtype}{double} s12\_34\_deg = (s1 == s3) ? (s2 == s4 ? 1.0 : 2.0) : 2.0;}
\DoxyCodeLine{530           \textcolor{comment}{// Total degeneracy factor}}
\DoxyCodeLine{531           \textcolor{keywordtype}{double} s1234\_deg = s12\_deg * s34\_deg * s12\_34\_deg;}
\DoxyCodeLine{532    }
\DoxyCodeLine{533           \textcolor{keyword}{auto} nQuad = n1*n2*n3*n4;}
\DoxyCodeLine{534 }
\DoxyCodeLine{535           shls[0] = int(s1);}
\DoxyCodeLine{536           shls[1] = int(s2);}
\DoxyCodeLine{537           shls[2] = int(s3);}
\DoxyCodeLine{538           shls[3] = int(s4);}
\DoxyCodeLine{539 }
\DoxyCodeLine{540           \textcolor{keywordflow}{if}(int2e\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{541 }
\DoxyCodeLine{542           \textcolor{keyword}{auto} ADCLLMS = AX\_loc[CLLMS];}
\DoxyCodeLine{543           \textcolor{keyword}{auto} ADXLLMS = AX\_loc[XLLMS];}
\DoxyCodeLine{544           \textcolor{keyword}{auto} ADXLLMX = AX\_loc[XLLMX];}
\DoxyCodeLine{545           \textcolor{keyword}{auto} ADXLLMY = AX\_loc[XLLMY];}
\DoxyCodeLine{546           \textcolor{keyword}{auto} ADXLLMZ = AX\_loc[XLLMZ];}
\DoxyCodeLine{547           \textcolor{keyword}{auto} DCLLMS  = matList[CLLMS].X;}
\DoxyCodeLine{548           \textcolor{keyword}{auto} DXLLMS  = matList[XLLMS].X;}
\DoxyCodeLine{549           \textcolor{keyword}{auto} DXLLMX  = matList[XLLMX].X;}
\DoxyCodeLine{550           \textcolor{keyword}{auto} DXLLMY  = matList[XLLMY].X;}
\DoxyCodeLine{551           \textcolor{keyword}{auto} DXLLMZ  = matList[XLLMZ].X;}
\DoxyCodeLine{552  }
\DoxyCodeLine{553           \textcolor{comment}{// Scale the buffer by the degeneracy factor and store}}
\DoxyCodeLine{554           \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i = 0ul; i < nQuad; i++) buff[i] *= 0.5*s1234\_deg;}
\DoxyCodeLine{555 }
\DoxyCodeLine{556           \textcolor{keywordflow}{for}(l = 0ul, bf4 = bf4\_s, mnkl=0ul ; l < n4; ++l, bf4++) \{}
\DoxyCodeLine{557   }
\DoxyCodeLine{558           \textcolor{keywordflow}{for}(k = 0ul, bf3 = bf3\_s           ; k < n3; ++k, bf3++) \{}
\DoxyCodeLine{559             \textcolor{keyword}{auto} bf43 = bf4 + bf3*nBasis;}
\DoxyCodeLine{560             \textcolor{keyword}{auto} bf34 = bf3 + bf4*nBasis;}
\DoxyCodeLine{561   }
\DoxyCodeLine{562           \textcolor{keywordflow}{for}(n = 0ul, bf2 = bf2\_s           ; n < n2; ++n, bf2++) \{}
\DoxyCodeLine{563             \textcolor{keyword}{auto} bf42 = bf4 + bf2*nBasis;}
\DoxyCodeLine{564             \textcolor{keyword}{auto} bf23 = bf2 + bf3*nBasis;}
\DoxyCodeLine{565             \textcolor{keyword}{auto} bf24 = bf2 + bf4*nBasis;}
\DoxyCodeLine{566   }
\DoxyCodeLine{567           \textcolor{keywordflow}{for}(m = 0ul, bf1 = bf1\_s           ; m < n1; ++m, bf1++, ++mnkl) \{}
\DoxyCodeLine{568             \textcolor{keyword}{auto} bf21 = bf2 + bf1*nBasis;}
\DoxyCodeLine{569             \textcolor{keyword}{auto} bf12 = bf1 + bf2*nBasis;}
\DoxyCodeLine{570             \textcolor{keyword}{auto} bf14 = bf1 + bf4*nBasis;}
\DoxyCodeLine{571             \textcolor{keyword}{auto} bf13 = bf1 + bf3*nBasis;}
\DoxyCodeLine{572  }
\DoxyCodeLine{573             \textcolor{comment}{// Start of Coulomb}}
\DoxyCodeLine{574             ADCLLMS[bf12] += buff[mnkl]*DCLLMS[bf43].real();}
\DoxyCodeLine{575             ADCLLMS[bf34] += buff[mnkl]*DCLLMS[bf21].real();}
\DoxyCodeLine{576 }
\DoxyCodeLine{577             \textcolor{comment}{// Start of Exchange}}
\DoxyCodeLine{578             buff[mnkl] *= 0.5;}
\DoxyCodeLine{579             ADXLLMS[bf14] += buff[mnkl]*DXLLMS[bf23];}
\DoxyCodeLine{580             ADXLLMX[bf14] += buff[mnkl]*DXLLMX[bf23];}
\DoxyCodeLine{581             ADXLLMY[bf14] += buff[mnkl]*DXLLMY[bf23];}
\DoxyCodeLine{582             ADXLLMZ[bf14] += buff[mnkl]*DXLLMZ[bf23];}
\DoxyCodeLine{583   }
\DoxyCodeLine{584             ADXLLMS[bf13] += buff[mnkl]*DXLLMS[bf24];}
\DoxyCodeLine{585             ADXLLMX[bf13] += buff[mnkl]*DXLLMX[bf24];}
\DoxyCodeLine{586             ADXLLMY[bf13] += buff[mnkl]*DXLLMY[bf24];}
\DoxyCodeLine{587             ADXLLMZ[bf13] += buff[mnkl]*DXLLMZ[bf24];}
\DoxyCodeLine{588   }
\DoxyCodeLine{589             ADXLLMS[bf24] += buff[mnkl]*DXLLMS[bf13];}
\DoxyCodeLine{590             ADXLLMX[bf24] += buff[mnkl]*DXLLMX[bf13];}
\DoxyCodeLine{591             ADXLLMY[bf24] += buff[mnkl]*DXLLMY[bf13];}
\DoxyCodeLine{592             ADXLLMZ[bf24] += buff[mnkl]*DXLLMZ[bf13];}
\DoxyCodeLine{593   }
\DoxyCodeLine{594             ADXLLMS[bf23] += buff[mnkl]*DXLLMS[bf14];}
\DoxyCodeLine{595             ADXLLMX[bf23] += buff[mnkl]*DXLLMX[bf14];}
\DoxyCodeLine{596             ADXLLMY[bf23] += buff[mnkl]*DXLLMY[bf14];}
\DoxyCodeLine{597             ADXLLMZ[bf23] += buff[mnkl]*DXLLMZ[bf14];}
\DoxyCodeLine{598 }
\DoxyCodeLine{599           \}; \textcolor{comment}{// bf1}}
\DoxyCodeLine{600           \}; \textcolor{comment}{// bf2}}
\DoxyCodeLine{601           \}; \textcolor{comment}{// bf3}}
\DoxyCodeLine{602           \}; \textcolor{comment}{// bf4  Contraction loop}}
\DoxyCodeLine{603   }
\DoxyCodeLine{604         \}; \textcolor{comment}{// s4}}
\DoxyCodeLine{605         \}; \textcolor{comment}{// s3}}
\DoxyCodeLine{606         \}; \textcolor{comment}{// s2}}
\DoxyCodeLine{607         \}; \textcolor{comment}{// s1}}
\DoxyCodeLine{608   }
\DoxyCodeLine{609       \}; \textcolor{comment}{// OpenMP context}}
\DoxyCodeLine{610   }
\DoxyCodeLine{611   }
\DoxyCodeLine{612       MatsT* SCR = memManager\_.malloc<MatsT>(nBasis * nBasis);}
\DoxyCodeLine{613 }
\DoxyCodeLine{614       \textcolor{comment}{// Take care of the Hermitian symmetry for CLLMS, XLLMS, XLLMX, XLLMY, XLLMZ}}
\DoxyCodeLine{615       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iMat = 0; iMat < 5;  iMat++ ) }
\DoxyCodeLine{616       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iTh  = 0; iTh < nThreads; iTh++) \{}
\DoxyCodeLine{617         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'C'},nBasis,nBasis,MatsT(0.5),AXthreads[iTh][iMat],nBasis,MatsT(0.5),}
\DoxyCodeLine{618           AXthreads[iTh][iMat],nBasis,SCR,nBasis);}
\DoxyCodeLine{619         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.), SCR,nBasis, }
\DoxyCodeLine{620           MatsT(1.), matList[iMat].AX,nBasis,matList[iMat].AX,nBasis);}
\DoxyCodeLine{621       \}}
\DoxyCodeLine{622    }
\DoxyCodeLine{623       memManager\_.free(SCR);}
\DoxyCodeLine{624       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{625 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{626       \textcolor{keywordflow}{if}(ShBlkNorms\_raw!=\textcolor{keyword}{nullptr}) memManager\_.free(ShBlkNorms\_raw);}
\DoxyCodeLine{627 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{628 }
\DoxyCodeLine{629 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{630       \textcolor{keywordtype}{size\_t} nIntSkip = std::accumulate(nSkip.begin(),nSkip.end(),0);}
\DoxyCodeLine{631       std::cout << \textcolor{stringliteral}{"{}Bare-\/Coulomb-\/Exchange Screened "{}} << nIntSkip << std::endl;}
\DoxyCodeLine{632   }
\DoxyCodeLine{633       \textcolor{keyword}{auto} durDirect = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topDirect);}
\DoxyCodeLine{634       std::cout << \textcolor{stringliteral}{"{}Bare-\/Coulomb-\/Exchange AO Direct Contraction took "{}} <<  durDirect << \textcolor{stringliteral}{"{} s\(\backslash\)n"{}}; }
\DoxyCodeLine{635   }
\DoxyCodeLine{636       std::cout << std::endl;}
\DoxyCodeLine{637 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{638   }
\DoxyCodeLine{639 }
\DoxyCodeLine{640     \};}
\DoxyCodeLine{641 }
\DoxyCodeLine{642 \textcolor{comment}{    /*********************************/}}
\DoxyCodeLine{643     \textcolor{comment}{/*                               */}}
\DoxyCodeLine{644     \textcolor{comment}{/* End of Bare-\/Coulomb-\/Exchange  */}}
\DoxyCodeLine{645     \textcolor{comment}{/*                               */}}
\DoxyCodeLine{646 \textcolor{comment}{    /*********************************/}}
\DoxyCodeLine{647 }
\DoxyCodeLine{648 }
\DoxyCodeLine{649 }
\DoxyCodeLine{650 }
\DoxyCodeLine{651 }
\DoxyCodeLine{652 }
\DoxyCodeLine{653 }
\DoxyCodeLine{654 }
\DoxyCodeLine{655 }
\DoxyCodeLine{656 }
\DoxyCodeLine{657 }
\DoxyCodeLine{658 }
\DoxyCodeLine{659 }
\DoxyCodeLine{660 }
\DoxyCodeLine{661 \textcolor{comment}{    /******************************************/}}
\DoxyCodeLine{662     \textcolor{comment}{/*                                        */}}
\DoxyCodeLine{663     \textcolor{comment}{/* Start of Dirac-\/Coulomb LL and C(2)-\/SS  */}}
\DoxyCodeLine{664     \textcolor{comment}{/*                                        */}}
\DoxyCodeLine{665 \textcolor{comment}{    /******************************************/}}
\DoxyCodeLine{666 }
\DoxyCodeLine{667     \textcolor{keywordflow}{if}( matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba1d269d4b7d6c561fc04b81a2a178e2a5}{TWOBODY\_CONTRACTION\_TYPE::LLLL}} ) \{}
\DoxyCodeLine{668 }
\DoxyCodeLine{669  }
\DoxyCodeLine{670 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{671       \textcolor{keyword}{auto} topDirectLL = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{672 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{673 }
\DoxyCodeLine{674 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{675       \textcolor{comment}{// Compute shell block norms (∞-\/norm) of matList.X}}
\DoxyCodeLine{676       \textcolor{comment}{// CLLMS, CSSMS, CSSMX, CSSMY, CSSMZ Densitry matrices}}
\DoxyCodeLine{677       \textcolor{keywordtype}{int} mMat = 5;}
\DoxyCodeLine{678       \textcolor{keywordtype}{double} *ShBlkNorms\_raw = memManager\_.malloc<\textcolor{keywordtype}{double}>(mMat*nShell*nShell);}
\DoxyCodeLine{679       std::vector<double*> ShBlkNorms;}
\DoxyCodeLine{680   }
\DoxyCodeLine{681       \textcolor{keyword}{auto} iOff = 0;}
\DoxyCodeLine{682       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CLLMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{683       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{684   }
\DoxyCodeLine{685       iOff += nShell*nShell;}
\DoxyCodeLine{686       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{687       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{688   }
\DoxyCodeLine{689       iOff += nShell*nShell;}
\DoxyCodeLine{690       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{691       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{692   }
\DoxyCodeLine{693       iOff += nShell*nShell;}
\DoxyCodeLine{694       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{695       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{696   }
\DoxyCodeLine{697       iOff += nShell*nShell;}
\DoxyCodeLine{698       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{699       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{700   }
\DoxyCodeLine{701       \textcolor{comment}{// Get the max over all the matricies for the shell block ∞-\/norms}}
\DoxyCodeLine{702       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} k = 0; k < nShell*nShell; k++) \{}
\DoxyCodeLine{703   }
\DoxyCodeLine{704         \textcolor{keywordtype}{double} mx = std::abs(ShBlkNorms[0][k]);}
\DoxyCodeLine{705         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < mMat; iMat++)}
\DoxyCodeLine{706           mx = std::max(mx,std::abs(ShBlkNorms[iMat][k]));}
\DoxyCodeLine{707         ShBlkNorms[0][k] = mx;}
\DoxyCodeLine{708    }
\DoxyCodeLine{709       \}}
\DoxyCodeLine{710 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{711 }
\DoxyCodeLine{712       \textcolor{comment}{// 81 is for fourth-\/derivative; 9 for second derivative}}
\DoxyCodeLine{713       nERI = 9;}
\DoxyCodeLine{714       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(nERI*buffN4*nThreads);}
\DoxyCodeLine{715       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{716       ERIBuffer = memManager\_.malloc<\textcolor{keywordtype}{double}>(2*4*NB4*nThreads);}
\DoxyCodeLine{717 }
\DoxyCodeLine{718       \textcolor{comment}{// Keeping track of number of integrals skipped}}
\DoxyCodeLine{719       std::vector<size\_t> nSkipLL(nThreads,0);}
\DoxyCodeLine{720 }
\DoxyCodeLine{721       memset(AXRaw,0,nThreads*nMat*nBasis*nBasis*\textcolor{keyword}{sizeof}(MatsT));}
\DoxyCodeLine{722 }
\DoxyCodeLine{723 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{724       \{}
\DoxyCodeLine{725 }
\DoxyCodeLine{726         \textcolor{keywordtype}{double} C2 = 1./(4*\mbox{\hyperlink{namespaceChronusQ_a387c8ccd4e18ad322b87f75f51fd008d}{SpeedOfLight}}*\mbox{\hyperlink{namespaceChronusQ_a387c8ccd4e18ad322b87f75f51fd008d}{SpeedOfLight}});}
\DoxyCodeLine{727   }
\DoxyCodeLine{728         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{729   }
\DoxyCodeLine{730         \textcolor{keyword}{auto} \&AX\_loc = AXthreads[thread\_id];}
\DoxyCodeLine{731   }
\DoxyCodeLine{732         \textcolor{keywordtype}{double} *ERIBuffAB   = \&ERIBuffer[thread\_id*4*NB4];}
\DoxyCodeLine{733         \textcolor{keywordtype}{double} *ERIBuffCD   = \&ERIBuffer[nThreads*4*NB4 + thread\_id*4*NB4];}
\DoxyCodeLine{734   }
\DoxyCodeLine{735         \textcolor{keywordtype}{size\_t} n1,n2,n3,n4,m,n,k,l,mnkl,bf1,bf2,bf3,bf4;}
\DoxyCodeLine{736         \textcolor{keywordtype}{size\_t} s4\_max;}
\DoxyCodeLine{737   }
\DoxyCodeLine{738         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{739         \textcolor{keywordtype}{double} *buff = \&buffAll[nERI*buffN4*thread\_id];}
\DoxyCodeLine{740         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{741   }
\DoxyCodeLine{742         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s1234(0); s1 < nShell; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{743   }
\DoxyCodeLine{744           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{745   }
\DoxyCodeLine{746         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 <= s1; bf2\_s+=n2, s2++) \{}
\DoxyCodeLine{747   }
\DoxyCodeLine{748           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{749           \textcolor{comment}{// Deneneracy factor for s1,s2 pair}}
\DoxyCodeLine{750           \textcolor{keywordtype}{double} s12\_deg = (s1 == s2) ? 1.0 : 2.0;}
\DoxyCodeLine{751   }
\DoxyCodeLine{752 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{753 \textcolor{comment}{//          double shMax12 = ShBlkNorms[0][s1 + s2*nShell];}}
\DoxyCodeLine{754 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{755   }
\DoxyCodeLine{756         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s3(0), bf3\_s(0); s3 < nShell; bf3\_s+=n3, s3++) \{}
\DoxyCodeLine{757   }
\DoxyCodeLine{758           n3 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s3].size(); \textcolor{comment}{// Size of Shell 3}}
\DoxyCodeLine{759           s4\_max = (s1 == s3) ? s2 : s3; \textcolor{comment}{// Determine the unique max of Shell 4}}
\DoxyCodeLine{760   }
\DoxyCodeLine{761 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{762 \textcolor{comment}{//          double shMax123 = std::max(ShBlkNorms[0][s1 + s3*nShell], ShBlkNorms[0][s2 + s3*nShell]);}}
\DoxyCodeLine{763 \textcolor{comment}{//          shMax123 = std::max(shMax123,shMax12);}}
\DoxyCodeLine{764 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{765    }
\DoxyCodeLine{766         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s4(0), bf4\_s(0); s4 <= s3; bf4\_s+=n4, s4++, s1234++) \{}
\DoxyCodeLine{767   }
\DoxyCodeLine{768           n4 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s4].size(); \textcolor{comment}{// Size of Shell 4}}
\DoxyCodeLine{769 }
\DoxyCodeLine{770           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{771 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{772           \textcolor{keywordflow}{if}( s1234 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{773 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{774 }
\DoxyCodeLine{775 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{776 \textcolor{comment}{//          double shMax = std::max(ShBlkNorms[0][s1 + s4*nShell],}}
\DoxyCodeLine{777 \textcolor{comment}{//                                  std::max(ShBlkNorms[0][s2 + s4*nShell],}}
\DoxyCodeLine{778 \textcolor{comment}{//                                           ShBlkNorms[0][s3 + s4*nShell]));}}
\DoxyCodeLine{779 }
\DoxyCodeLine{780 \textcolor{comment}{//          shMax = std::max(shMax,shMax123);}}
\DoxyCodeLine{781 }
\DoxyCodeLine{782 \textcolor{comment}{//          if((shMax*SchwarzSSSS[s1+s2*nShell]*SchwarzERI[s3 + s4*nShell]) <}}
\DoxyCodeLine{783 \textcolor{comment}{//             eri.threshSchwarz()) \{ nSkipLL[thread\_id]++; continue; \}}}
\DoxyCodeLine{784 }
\DoxyCodeLine{785           \textcolor{keywordtype}{double} shMax = std::max(ShBlkNorms[0][s1 + s2*nShell],ShBlkNorms[0][s3 + s4*nShell]);}
\DoxyCodeLine{786 }
\DoxyCodeLine{787           \textcolor{keywordflow}{if}((shMax*SchwarzSSSS[s1+s2*nShell]*SchwarzERI[s3 + s4*nShell]) <}
\DoxyCodeLine{788              eri.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_a51ce753ee588706401406d4216c1ba74}{threshSchwarz}}()) \{ nSkipLL[thread\_id]++; \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{789 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{790 }
\DoxyCodeLine{791           \textcolor{comment}{// Degeneracy factor for s3,s4 pair}}
\DoxyCodeLine{792           \textcolor{keywordtype}{double} s34\_deg = (s3 == s4) ? 1.0 : 2.0;}
\DoxyCodeLine{793 }
\DoxyCodeLine{794           \textcolor{keyword}{auto} nQuad = n1*n2*n3*n4;}
\DoxyCodeLine{795   }
\DoxyCodeLine{796           shls[0] = int(s1);}
\DoxyCodeLine{797           shls[1] = int(s2);}
\DoxyCodeLine{798           shls[2] = int(s3);}
\DoxyCodeLine{799           shls[3] = int(s4);}
\DoxyCodeLine{800   }
\DoxyCodeLine{801           \textcolor{keywordflow}{if}(int2e\_ipvip1\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{802 }
\DoxyCodeLine{803  }
\DoxyCodeLine{804           \textcolor{keywordflow}{for}(l = 3*maxShellSize, mnkl = 0ul; l < 3*maxShellSize + n4; ++l) \{}
\DoxyCodeLine{805             \textcolor{keyword}{auto} lNB3 = l*NB3;}
\DoxyCodeLine{806             \textcolor{keyword}{auto} lNB  = l*NB;}
\DoxyCodeLine{807 }
\DoxyCodeLine{808           \textcolor{keywordflow}{for}(k = 2*maxShellSize            ; k < 2*maxShellSize + n3; ++k) \{}
\DoxyCodeLine{809             \textcolor{keyword}{auto} kNB2lNB3 = k*NB2 + lNB3;}
\DoxyCodeLine{810             \textcolor{keyword}{auto} klNB  = k + lNB;}
\DoxyCodeLine{811 }
\DoxyCodeLine{812           \textcolor{keywordflow}{for}(n =   maxShellSize            ; n <   maxShellSize + n2; ++n) \{}
\DoxyCodeLine{813             \textcolor{keyword}{auto} nNBkNB2lNB3 = n*NB + kNB2lNB3;}
\DoxyCodeLine{814             \textcolor{keyword}{auto} klNBnNB3    = klNB + n*NB3;}
\DoxyCodeLine{815 }
\DoxyCodeLine{816           \textcolor{keywordflow}{for}(m = 0                         ; m <                  n1; ++m, ++mnkl) \{}
\DoxyCodeLine{817    }
\DoxyCodeLine{818             \textcolor{comment}{/* Dirac-\/Coulomb */}}
\DoxyCodeLine{819             \textcolor{comment}{// ∇A∙∇B(mn|kl)}}
\DoxyCodeLine{820             \textcolor{keyword}{auto} dAdotdB = buff[AxBx*nQuad+mnkl] + buff[AyBy*nQuad+mnkl] + buff[AzBz*nQuad+mnkl];}
\DoxyCodeLine{821             \textcolor{comment}{// ∇Ax∇B(mn|kl)}}
\DoxyCodeLine{822             \textcolor{keyword}{auto} dAcrossdB\_x =  buff[AyBz*nQuad+mnkl] -\/ buff[AzBy*nQuad+mnkl];}
\DoxyCodeLine{823             \textcolor{keyword}{auto} dAcrossdB\_y = -\/buff[AxBz*nQuad+mnkl] + buff[AzBx*nQuad+mnkl];}
\DoxyCodeLine{824             \textcolor{keyword}{auto} dAcrossdB\_z =  buff[AxBy*nQuad+mnkl] -\/ buff[AyBx*nQuad+mnkl];}
\DoxyCodeLine{825   }
\DoxyCodeLine{826             \textcolor{comment}{//auto MNKL = m + n*NB + k*NB2 + l*NB3;}}
\DoxyCodeLine{827             \textcolor{keyword}{auto} MNKL = m + nNBkNB2lNB3;}
\DoxyCodeLine{828             \textcolor{comment}{//auto KLMN = k + l*NB + m*NB2 + n*NB3;}}
\DoxyCodeLine{829             \textcolor{keyword}{auto} KLMN = m*NB2 + klNBnNB3;}
\DoxyCodeLine{830   }
\DoxyCodeLine{831   }
\DoxyCodeLine{832             \textcolor{comment}{// ∇A∙∇B(mn|kl) followed by ∇Ax∇B(mn|kl) X, Y, and Z}}
\DoxyCodeLine{833             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{834             ERIBuffAB[       MNKL] =  (double)s34\_deg*dAdotdB;}
\DoxyCodeLine{835             ERIBuffAB[   NB4+MNKL] =  (double)s34\_deg*dAcrossdB\_x;}
\DoxyCodeLine{836             ERIBuffAB[ NB4\_2+MNKL] =  (double)s34\_deg*dAcrossdB\_y;}
\DoxyCodeLine{837             ERIBuffAB[ NB4\_3+MNKL] =  (double)s34\_deg*dAcrossdB\_z;}
\DoxyCodeLine{838   }
\DoxyCodeLine{839             \textcolor{comment}{// ∇C∙∇D(kl|nm) followed by ∇Cx∇D(kl|nm) X, Y, and Z}}
\DoxyCodeLine{840             \textcolor{comment}{// (kl|mn)}}
\DoxyCodeLine{841             ERIBuffCD[       KLMN] =  (double)s12\_deg*dAdotdB;}
\DoxyCodeLine{842             ERIBuffCD[   NB4+KLMN] =  (double)s12\_deg*dAcrossdB\_x;}
\DoxyCodeLine{843             ERIBuffCD[ NB4\_2+KLMN] =  (double)s12\_deg*dAcrossdB\_y;}
\DoxyCodeLine{844             ERIBuffCD[ NB4\_3+KLMN] =  (double)s12\_deg*dAcrossdB\_z;}
\DoxyCodeLine{845  }
\DoxyCodeLine{846           \}}
\DoxyCodeLine{847           \}}
\DoxyCodeLine{848           \} }
\DoxyCodeLine{849           \} \textcolor{comment}{// ∇A∇B integral preparation loop}}
\DoxyCodeLine{850   }
\DoxyCodeLine{851 }
\DoxyCodeLine{852 }
\DoxyCodeLine{853 \textcolor{preprocessor}{\#ifdef \_CONTRACTION\_ }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{854 }
\DoxyCodeLine{855           \textcolor{keyword}{auto} ADCLLMS = AX\_loc[CLLMS];}
\DoxyCodeLine{856           \textcolor{keyword}{auto} ADCSSMS = AX\_loc[CSSMS];}
\DoxyCodeLine{857           \textcolor{keyword}{auto} ADCSSMX = AX\_loc[CSSMX];}
\DoxyCodeLine{858           \textcolor{keyword}{auto} ADCSSMY = AX\_loc[CSSMY];}
\DoxyCodeLine{859           \textcolor{keyword}{auto} ADCSSMZ = AX\_loc[CSSMZ];}
\DoxyCodeLine{860 }
\DoxyCodeLine{861           \textcolor{keyword}{auto} DCLLMS  = matList[CLLMS].X;}
\DoxyCodeLine{862           \textcolor{keyword}{auto} DCSSMS  = matList[CSSMS].X;}
\DoxyCodeLine{863           \textcolor{keyword}{auto} DCSSMX  = matList[CSSMX].X;}
\DoxyCodeLine{864           \textcolor{keyword}{auto} DCSSMY  = matList[CSSMY].X;}
\DoxyCodeLine{865           \textcolor{keyword}{auto} DCSSMZ  = matList[CSSMZ].X;}
\DoxyCodeLine{866  }
\DoxyCodeLine{867 }
\DoxyCodeLine{868           \textcolor{keywordflow}{for}(m = 0ul,            bf1 = bf1\_s; m <                  n1; ++m, bf1++) \{}
\DoxyCodeLine{869             \textcolor{keyword}{auto} mNB2 = m*NB2;}
\DoxyCodeLine{870             \textcolor{keyword}{auto} bf1nB = bf1*nBasis;}
\DoxyCodeLine{871 }
\DoxyCodeLine{872           \textcolor{keywordflow}{for}(n =   maxShellSize, bf2 = bf2\_s; n <   maxShellSize + n2; ++n, bf2++) \{}
\DoxyCodeLine{873             \textcolor{keyword}{auto} mNB2nNB3 = mNB2 + n*NB3;}
\DoxyCodeLine{874             \textcolor{keyword}{auto} mnNB     = m + n*NB;}
\DoxyCodeLine{875             \textcolor{keyword}{auto} bf21 = bf2 + bf1nB;}
\DoxyCodeLine{876             \textcolor{keyword}{auto} bf12 = bf1 + bf2*nBasis;}
\DoxyCodeLine{877 }
\DoxyCodeLine{878           \textcolor{keywordflow}{for}(k = 2*maxShellSize, bf3 = bf3\_s; k < 2*maxShellSize + n3; ++k, bf3++) \{}
\DoxyCodeLine{879             \textcolor{keyword}{auto} mnNBkNB2  = mnNB + k*NB2;}
\DoxyCodeLine{880             \textcolor{keyword}{auto} kmNB2nNB3 = k + mNB2nNB3;}
\DoxyCodeLine{881             \textcolor{keyword}{auto} bf3nB = bf3*nBasis;}
\DoxyCodeLine{882 }
\DoxyCodeLine{883           \textcolor{keywordflow}{for}(l = 3*maxShellSize, bf4 = bf4\_s; l < 3*maxShellSize + n4; ++l, bf4++) \{}
\DoxyCodeLine{884   }
\DoxyCodeLine{885             \textcolor{comment}{//auto MNKL = m + n*NB + k*NB2 + l*NB3;}}
\DoxyCodeLine{886             \textcolor{keyword}{auto} MNKL = mnNBkNB2 + l*NB3;}
\DoxyCodeLine{887             \textcolor{comment}{//auto KLMN = k + l*NB + m*NB2 + n*NB3;}}
\DoxyCodeLine{888             \textcolor{keyword}{auto} KLMN = kmNB2nNB3 + l*NB;}
\DoxyCodeLine{889   }
\DoxyCodeLine{890             \textcolor{keyword}{auto} bf43 = bf4 + bf3nB;}
\DoxyCodeLine{891             \textcolor{keyword}{auto} bf34 = bf3 + bf4*nBasis;}
\DoxyCodeLine{892   }
\DoxyCodeLine{893             \textcolor{keyword}{auto} DotPrdMNKL = MNKL;}
\DoxyCodeLine{894             \textcolor{keyword}{auto} CrossXMNKL = MNKL+NB4;}
\DoxyCodeLine{895             \textcolor{keyword}{auto} CrossYMNKL = MNKL+NB4\_2;}
\DoxyCodeLine{896             \textcolor{keyword}{auto} CrossZMNKL = MNKL+NB4\_3;}
\DoxyCodeLine{897   }
\DoxyCodeLine{898             \textcolor{keyword}{auto} DotPrdKLMN = KLMN;}
\DoxyCodeLine{899             \textcolor{keyword}{auto} CrossXKLMN = KLMN+NB4;}
\DoxyCodeLine{900             \textcolor{keyword}{auto} CrossYKLMN = KLMN+NB4\_2;}
\DoxyCodeLine{901             \textcolor{keyword}{auto} CrossZKLMN = KLMN+NB4\_3;}
\DoxyCodeLine{902   }
\DoxyCodeLine{903   }
\DoxyCodeLine{904 }
\DoxyCodeLine{905             \textcolor{comment}{/*++++++++++++++++++++++++++++++++++++++++++++*/}}
\DoxyCodeLine{906             \textcolor{comment}{/* Start of Dirac-\/Coulomb (LL|LL) Contraction */}}
\DoxyCodeLine{907             \textcolor{comment}{/*++++++++++++++++++++++++++++++++++++++++++++*/}}
\DoxyCodeLine{908   }
\DoxyCodeLine{909             \textcolor{comment}{//KLMN}}
\DoxyCodeLine{910             \textcolor{keywordflow}{if}(bf3 >= bf4 ) \{}
\DoxyCodeLine{911               ADCLLMS[bf34] +=  ERIBuffCD[DotPrdKLMN]*DCSSMS[bf21].real()}
\DoxyCodeLine{912                                -\/ERIBuffCD[CrossZKLMN]*DCSSMZ[bf21].imag()}
\DoxyCodeLine{913                                -\/ERIBuffCD[CrossXKLMN]*DCSSMX[bf21].imag()}
\DoxyCodeLine{914                                -\/ERIBuffCD[CrossYKLMN]*DCSSMY[bf21].imag();}
\DoxyCodeLine{915             \}}
\DoxyCodeLine{916            }
\DoxyCodeLine{917             \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{918             \textcolor{comment}{/* End of Dirac-\/Coulomb (LL|LL) Contraction */}}
\DoxyCodeLine{919             \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{920   }
\DoxyCodeLine{921   }
\DoxyCodeLine{922   }
\DoxyCodeLine{923   }
\DoxyCodeLine{924   }
\DoxyCodeLine{925             \textcolor{comment}{/*+++++++++++++++++++++++++++++++++++++++++++++++++*/}}
\DoxyCodeLine{926             \textcolor{comment}{/* Start of Dirac-\/Coulomb C(2)-\/(SS|SS) Contraction */}}
\DoxyCodeLine{927             \textcolor{comment}{/*+++++++++++++++++++++++++++++++++++++++++++++++++*/}}
\DoxyCodeLine{928   }
\DoxyCodeLine{929   }
\DoxyCodeLine{930             \textcolor{comment}{/* MNKL */}}
\DoxyCodeLine{931             \textcolor{keywordflow}{if} (bf1 >= bf2) \{}
\DoxyCodeLine{932               ADCSSMS[bf12] += ERIBuffAB[DotPrdMNKL]*DCLLMS[bf43].real();}
\DoxyCodeLine{933               ADCSSMX[bf12] += ERIBuffAB[CrossXMNKL]*DCLLMS[bf43].real();}
\DoxyCodeLine{934               ADCSSMY[bf12] += ERIBuffAB[CrossYMNKL]*DCLLMS[bf43].real();}
\DoxyCodeLine{935               ADCSSMZ[bf12] += ERIBuffAB[CrossZMNKL]*DCLLMS[bf43].real();}
\DoxyCodeLine{936             \} }
\DoxyCodeLine{937   }
\DoxyCodeLine{938             \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{939             \textcolor{comment}{/* End of Dirac-\/Coulomb C(2)-\/(SS|SS) Contraction */}}
\DoxyCodeLine{940             \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{941           \};}
\DoxyCodeLine{942           \};}
\DoxyCodeLine{943           \};  }
\DoxyCodeLine{944           \}; \textcolor{comment}{// contraction loop}}
\DoxyCodeLine{945   }
\DoxyCodeLine{946 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{947   }
\DoxyCodeLine{948   }
\DoxyCodeLine{949         \}; \textcolor{comment}{// loop s4}}
\DoxyCodeLine{950         \}; \textcolor{comment}{// loop s3}}
\DoxyCodeLine{951         \}; \textcolor{comment}{// loop s2}}
\DoxyCodeLine{952         \}; \textcolor{comment}{// loop s1}}
\DoxyCodeLine{953   }
\DoxyCodeLine{954   }
\DoxyCodeLine{955       \} \textcolor{comment}{// OpenMP context}}
\DoxyCodeLine{956  }
\DoxyCodeLine{957       \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}} iscale = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{958 }
\DoxyCodeLine{959       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iTh  = 0; iTh < nThreads; iTh++) \{}
\DoxyCodeLine{960  }
\DoxyCodeLine{961         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLLMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{962            matList[CLLMS].AX,nBasis,matList[CLLMS].AX,nBasis);}
\DoxyCodeLine{963 }
\DoxyCodeLine{964         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CSSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{965            matList[CSSMS].AX,nBasis,matList[CSSMS].AX,nBasis);}
\DoxyCodeLine{966 }
\DoxyCodeLine{967         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis, iscale, AXthreads[iTh][CSSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{968            matList[CSSMX].AX,nBasis,matList[CSSMX].AX,nBasis);}
\DoxyCodeLine{969 }
\DoxyCodeLine{970         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis, iscale, AXthreads[iTh][CSSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{971            matList[CSSMY].AX,nBasis,matList[CSSMY].AX,nBasis);}
\DoxyCodeLine{972 }
\DoxyCodeLine{973         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis, iscale, AXthreads[iTh][CSSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{974            matList[CSSMZ].AX,nBasis,matList[CSSMZ].AX,nBasis);}
\DoxyCodeLine{975 }
\DoxyCodeLine{976       \};}
\DoxyCodeLine{977 }
\DoxyCodeLine{978 \textcolor{preprocessor}{\#if 1}}
\DoxyCodeLine{979       \textcolor{comment}{// Take care of the Hermitian symmetry in the LL and SS blocks}}
\DoxyCodeLine{980       \textcolor{keyword}{auto} ADCLLMS = matList[CLLMS].AX;}
\DoxyCodeLine{981       \textcolor{keyword}{auto} ADCSSMS = matList[CSSMS].AX;}
\DoxyCodeLine{982       \textcolor{keyword}{auto} ADCSSMX = matList[CSSMX].AX;}
\DoxyCodeLine{983       \textcolor{keyword}{auto} ADCSSMY = matList[CSSMY].AX;}
\DoxyCodeLine{984       \textcolor{keyword}{auto} ADCSSMZ = matList[CSSMZ].AX;}
\DoxyCodeLine{985 }
\DoxyCodeLine{986       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} i = 0; i < nBasis; i++ ) }
\DoxyCodeLine{987       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} j = 0; j < i; j++ ) \{}
\DoxyCodeLine{988         ADCLLMS[j + i*nBasis] = std::conj(ADCLLMS[i + j*nBasis]);}
\DoxyCodeLine{989         ADCSSMS[j + i*nBasis] = std::conj(ADCSSMS[i + j*nBasis]);}
\DoxyCodeLine{990         ADCSSMX[j + i*nBasis] = std::conj(ADCSSMX[i + j*nBasis]);}
\DoxyCodeLine{991         ADCSSMY[j + i*nBasis] = std::conj(ADCSSMY[i + j*nBasis]);}
\DoxyCodeLine{992         ADCSSMZ[j + i*nBasis] = std::conj(ADCSSMZ[i + j*nBasis]);}
\DoxyCodeLine{993       \}}
\DoxyCodeLine{994 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{995 }
\DoxyCodeLine{996       memManager\_.free(ERIBuffer);}
\DoxyCodeLine{997       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{998 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{999       \textcolor{keywordflow}{if}(ShBlkNorms\_raw!=\textcolor{keyword}{nullptr}) memManager\_.free(ShBlkNorms\_raw);}
\DoxyCodeLine{1000 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1001 }
\DoxyCodeLine{1002 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{1003       \textcolor{keywordtype}{size\_t} nIntSkipLL = std::accumulate(nSkipLL.begin(),nSkipLL.end(),0);}
\DoxyCodeLine{1004       std::cout << \textcolor{stringliteral}{"{}Dirac-\/Coulomb-\/LL/C(2)-\/SS Screened "{}} << nIntSkipLL << std::endl;}
\DoxyCodeLine{1005 }
\DoxyCodeLine{1006       \textcolor{keyword}{auto} durDirectLL = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topDirectLL);}
\DoxyCodeLine{1007       std::cout << \textcolor{stringliteral}{"{}Dirac-\/Coulomb-\/LL/C(2)-\/SS AO Direct Contraction took "{}} <<  durDirectLL << \textcolor{stringliteral}{"{} s\(\backslash\)n"{}}; }
\DoxyCodeLine{1008 }
\DoxyCodeLine{1009       std::cout << std::endl;}
\DoxyCodeLine{1010 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1011     }
\DoxyCodeLine{1012 }
\DoxyCodeLine{1013     \} \textcolor{comment}{// if(LLLL)}}
\DoxyCodeLine{1014    }
\DoxyCodeLine{1015 \textcolor{comment}{    /******************************************/}}
\DoxyCodeLine{1016     \textcolor{comment}{/*                                        */}}
\DoxyCodeLine{1017     \textcolor{comment}{/*   End of Dirac-\/Coulomb LL and C(2)-\/SS  */}}
\DoxyCodeLine{1018     \textcolor{comment}{/*                                        */}}
\DoxyCodeLine{1019 \textcolor{comment}{    /******************************************/}}
\DoxyCodeLine{1020 }
\DoxyCodeLine{1021 }
\DoxyCodeLine{1022 }
\DoxyCodeLine{1023 }
\DoxyCodeLine{1024 }
\DoxyCodeLine{1025 }
\DoxyCodeLine{1026 }
\DoxyCodeLine{1027 \textcolor{comment}{    /***************************/}}
\DoxyCodeLine{1028     \textcolor{comment}{/*                         */}}
\DoxyCodeLine{1029     \textcolor{comment}{/* Start of (LLSS)/(SSLL)  */}}
\DoxyCodeLine{1030     \textcolor{comment}{/*                         */}}
\DoxyCodeLine{1031 \textcolor{comment}{    /***************************/}}
\DoxyCodeLine{1032 }
\DoxyCodeLine{1033     \textcolor{keywordflow}{if}( matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbad5017ac8c585ad30ff49af6467d2efc6}{TWOBODY\_CONTRACTION\_TYPE::LLSS}} ) \{}
\DoxyCodeLine{1034 }
\DoxyCodeLine{1035 }
\DoxyCodeLine{1036 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{1037       \textcolor{keyword}{auto} topDirectLS = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{1038 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1039 }
\DoxyCodeLine{1040 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1041       \textcolor{comment}{// Compute shell block norms (∞-\/norm) of matList.X}}
\DoxyCodeLine{1042       \textcolor{comment}{// XLSMS, XLSMX, XLSMY, XLSMZ Densitry matrices}}
\DoxyCodeLine{1043       \textcolor{keywordtype}{int} mMat = 4;}
\DoxyCodeLine{1044       \textcolor{keywordtype}{double} *ShBlkNorms\_raw = memManager\_.malloc<\textcolor{keywordtype}{double}>(mMat*nShell*nShell);}
\DoxyCodeLine{1045       std::vector<double*> ShBlkNorms;}
\DoxyCodeLine{1046   }
\DoxyCodeLine{1047       \textcolor{keyword}{auto} iOff = 0;}
\DoxyCodeLine{1048       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1049       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1050   }
\DoxyCodeLine{1051       iOff += nShell*nShell;}
\DoxyCodeLine{1052       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1053       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1054   }
\DoxyCodeLine{1055       iOff += nShell*nShell;}
\DoxyCodeLine{1056       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1057       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1058   }
\DoxyCodeLine{1059       iOff += nShell*nShell;}
\DoxyCodeLine{1060       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1061       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1062   }
\DoxyCodeLine{1063       \textcolor{comment}{// Get the max over all the matricies for the shell block ∞-\/norms}}
\DoxyCodeLine{1064       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} k = 0; k < nShell*nShell; k++) \{}
\DoxyCodeLine{1065   }
\DoxyCodeLine{1066         \textcolor{keywordtype}{double} mx = std::abs(ShBlkNorms[0][k]);}
\DoxyCodeLine{1067         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < mMat; iMat++)}
\DoxyCodeLine{1068           mx = std::max(mx,std::abs(ShBlkNorms[iMat][k]));}
\DoxyCodeLine{1069         ShBlkNorms[0][k] = mx;}
\DoxyCodeLine{1070    }
\DoxyCodeLine{1071       \}}
\DoxyCodeLine{1072 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1073 }
\DoxyCodeLine{1074       nERI = 9;}
\DoxyCodeLine{1075       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(nERI*buffN4*nThreads);}
\DoxyCodeLine{1076       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{1077       ERIBuffer = memManager\_.malloc<\textcolor{keywordtype}{double}>(2*4*NB4*nThreads);}
\DoxyCodeLine{1078       memset(AXRaw,0,nThreads*nMat*nBasis*nBasis*\textcolor{keyword}{sizeof}(MatsT));}
\DoxyCodeLine{1079       std::vector<size\_t> nSkipLS(nThreads,0);}
\DoxyCodeLine{1080   }
\DoxyCodeLine{1081 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{1082       \{}
\DoxyCodeLine{1083   }
\DoxyCodeLine{1084         \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}} iscale = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{1085   }
\DoxyCodeLine{1086         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{1087   }
\DoxyCodeLine{1088         \textcolor{keyword}{auto} \&AX\_loc = AXthreads[thread\_id];}
\DoxyCodeLine{1089   }
\DoxyCodeLine{1090         \textcolor{keywordtype}{double} *ERIBuffAB   = \&ERIBuffer[thread\_id*4*NB4];}
\DoxyCodeLine{1091         \textcolor{keywordtype}{double} *ERIBuffCD   = \&ERIBuffer[nThreads*4*NB4 + thread\_id*4*NB4];}
\DoxyCodeLine{1092   }
\DoxyCodeLine{1093         \textcolor{keywordtype}{size\_t} n1,n2,n3,n4,m,n,k,l,mnkl,bf1,bf2,bf3,bf4;}
\DoxyCodeLine{1094         \textcolor{keywordtype}{size\_t} s4\_max;}
\DoxyCodeLine{1095   }
\DoxyCodeLine{1096         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{1097         \textcolor{keywordtype}{double} *buff = \&buffAll[nERI*buffN4*thread\_id];}
\DoxyCodeLine{1098         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{1099   }
\DoxyCodeLine{1100         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s1234(0); s1 < nShell; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{1101   }
\DoxyCodeLine{1102           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{1103   }
\DoxyCodeLine{1104         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 <= s1; bf2\_s+=n2, s2++) \{}
\DoxyCodeLine{1105   }
\DoxyCodeLine{1106           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{1107   }
\DoxyCodeLine{1108 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1109           \textcolor{keywordtype}{double} shMax12 = ShBlkNorms[0][s1 + s2*nShell];}
\DoxyCodeLine{1110 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1111   }
\DoxyCodeLine{1112         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s3(0), bf3\_s(0); s3 < nShell; bf3\_s+=n3, s3++) \{}
\DoxyCodeLine{1113   }
\DoxyCodeLine{1114           n3 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s3].size(); \textcolor{comment}{// Size of Shell 3}}
\DoxyCodeLine{1115           s4\_max = (s1 == s3) ? s2 : s3; \textcolor{comment}{// Determine the unique max of Shell 4}}
\DoxyCodeLine{1116   }
\DoxyCodeLine{1117 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1118           \textcolor{keywordtype}{double} shMax123 = std::max(ShBlkNorms[0][s1 + s3*nShell], ShBlkNorms[0][s2 + s3*nShell]);}
\DoxyCodeLine{1119           shMax123 = std::max(shMax123,shMax12);}
\DoxyCodeLine{1120 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1121    }
\DoxyCodeLine{1122   }
\DoxyCodeLine{1123         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s4(0), bf4\_s(0); s4 <= s3; bf4\_s+=n4, s4++, s1234++) \{}
\DoxyCodeLine{1124   }
\DoxyCodeLine{1125           n4 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s4].size(); \textcolor{comment}{// Size of Shell 4}}
\DoxyCodeLine{1126   }
\DoxyCodeLine{1127           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{1128 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{1129           \textcolor{keywordflow}{if}( s1234 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1130 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{1131   }
\DoxyCodeLine{1132 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1133   }
\DoxyCodeLine{1134           \textcolor{keywordtype}{double} shMax = std::max(ShBlkNorms[0][s1 + s4*nShell],}
\DoxyCodeLine{1135                                   std::max(ShBlkNorms[0][s2 + s4*nShell],}
\DoxyCodeLine{1136                                            ShBlkNorms[0][s3 + s4*nShell]));}
\DoxyCodeLine{1137   }
\DoxyCodeLine{1138           shMax = std::max(shMax,shMax123);}
\DoxyCodeLine{1139 }
\DoxyCodeLine{1140           \textcolor{keywordflow}{if}((shMax*SchwarzSSSS[s3+s4*nShell]*SchwarzERI[s1 + s2*nShell]) <}
\DoxyCodeLine{1141              eri.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_a51ce753ee588706401406d4216c1ba74}{threshSchwarz}}()) \{ nSkipLS[thread\_id]++; \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{1142 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1143   }
\DoxyCodeLine{1144           \textcolor{keyword}{auto} nQuad = n1*n2*n3*n4;}
\DoxyCodeLine{1145   }
\DoxyCodeLine{1146           shls[0] = int(s3);}
\DoxyCodeLine{1147           shls[1] = int(s4);}
\DoxyCodeLine{1148           shls[2] = int(s1);}
\DoxyCodeLine{1149           shls[3] = int(s2);}
\DoxyCodeLine{1150   }
\DoxyCodeLine{1151           \textcolor{keywordflow}{if}(int2e\_ipvip1\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1152   }
\DoxyCodeLine{1153           \textcolor{keywordflow}{for}(n =   maxShellSize, mnkl = 0ul; n <   maxShellSize + n2; ++n) }
\DoxyCodeLine{1154           \textcolor{keywordflow}{for}(m = 0                         ; m <                  n1; ++m) }
\DoxyCodeLine{1155           \textcolor{keywordflow}{for}(l = 3*maxShellSize            ; l < 3*maxShellSize + n4; ++l)}
\DoxyCodeLine{1156           \textcolor{keywordflow}{for}(k = 2*maxShellSize            ; k < 2*maxShellSize + n3; ++k, ++mnkl) \{}
\DoxyCodeLine{1157    }
\DoxyCodeLine{1158             \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{1159             \textcolor{keyword}{auto} KLMN = k + l*NB + m*NB2 + n*NB3;}
\DoxyCodeLine{1160   }
\DoxyCodeLine{1161             \textcolor{comment}{/* Dirac-\/Coulomb */}}
\DoxyCodeLine{1162             \textcolor{comment}{// ∇C∙∇D(mn|kl)}}
\DoxyCodeLine{1163             \textcolor{keyword}{auto} dCdotdD = buff[AxBx*nQuad+mnkl] + buff[AyBy*nQuad+mnkl] + buff[AzBz*nQuad+mnkl];}
\DoxyCodeLine{1164             \textcolor{comment}{// ∇Ax∇B(mn|kl)}}
\DoxyCodeLine{1165             \textcolor{keyword}{auto} dCcrossdD\_x =  buff[AyBz*nQuad+mnkl] -\/ buff[AzBy*nQuad+mnkl];}
\DoxyCodeLine{1166             \textcolor{keyword}{auto} dCcrossdD\_y = -\/buff[AxBz*nQuad+mnkl] + buff[AzBx*nQuad+mnkl];}
\DoxyCodeLine{1167             \textcolor{keyword}{auto} dCcrossdD\_z =  buff[AxBy*nQuad+mnkl] -\/ buff[AyBx*nQuad+mnkl];}
\DoxyCodeLine{1168   }
\DoxyCodeLine{1169   }
\DoxyCodeLine{1170             \textcolor{comment}{// ∇A∙∇B(kl|mn) followed by ∇Ax∇B(kl|mn) X, Y, and Z}}
\DoxyCodeLine{1171             \textcolor{comment}{// (kl|mn)}}
\DoxyCodeLine{1172             ERIBuffAB[      KLMN] =  dCdotdD;}
\DoxyCodeLine{1173             ERIBuffAB[  NB4+KLMN] =  dCcrossdD\_x;}
\DoxyCodeLine{1174             ERIBuffAB[NB4\_2+KLMN] =  dCcrossdD\_y;}
\DoxyCodeLine{1175             ERIBuffAB[NB4\_3+KLMN] =  dCcrossdD\_z;}
\DoxyCodeLine{1176   }
\DoxyCodeLine{1177             \textcolor{comment}{// ∇C∙∇D(mn|kl) followed by ∇Cx∇D(mn|kl) X, Y, and Z}}
\DoxyCodeLine{1178             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{1179             ERIBuffCD[      MNKL] =  dCdotdD;}
\DoxyCodeLine{1180             ERIBuffCD[  NB4+MNKL] =  dCcrossdD\_x;}
\DoxyCodeLine{1181             ERIBuffCD[NB4\_2+MNKL] =  dCcrossdD\_y;}
\DoxyCodeLine{1182             ERIBuffCD[NB4\_3+MNKL] =  dCcrossdD\_z;}
\DoxyCodeLine{1183   }
\DoxyCodeLine{1184         \} \textcolor{comment}{// ∇C∙∇D integral preparation loop}}
\DoxyCodeLine{1185   }
\DoxyCodeLine{1186   }
\DoxyCodeLine{1187   }
\DoxyCodeLine{1188   }
\DoxyCodeLine{1189 \textcolor{preprocessor}{\#ifdef \_CONTRACTION\_ }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{1190 }
\DoxyCodeLine{1191           \textcolor{keyword}{auto} ADXLSMS  = AX\_loc[XLSMS];}
\DoxyCodeLine{1192           \textcolor{keyword}{auto} ADXLSMX  = AX\_loc[XLSMX];}
\DoxyCodeLine{1193           \textcolor{keyword}{auto} ADXLSMY  = AX\_loc[XLSMY];}
\DoxyCodeLine{1194           \textcolor{keyword}{auto} ADXLSMZ  = AX\_loc[XLSMZ];}
\DoxyCodeLine{1195           \textcolor{keyword}{auto} DXLSMS = matList[XLSMS].X;}
\DoxyCodeLine{1196           \textcolor{keyword}{auto} DXLSMX = matList[XLSMX].X;}
\DoxyCodeLine{1197           \textcolor{keyword}{auto} DXLSMY = matList[XLSMY].X;}
\DoxyCodeLine{1198           \textcolor{keyword}{auto} DXLSMZ = matList[XLSMZ].X;}
\DoxyCodeLine{1199  }
\DoxyCodeLine{1200           \textcolor{keywordflow}{for}(m = 0ul,            bf1 = bf1\_s; m <                  n1; ++m, bf1++) \{}
\DoxyCodeLine{1201           \textcolor{keywordflow}{for}(n =   maxShellSize, bf2 = bf2\_s; n <   maxShellSize + n2; ++n, bf2++) \{}
\DoxyCodeLine{1202             \textcolor{keyword}{auto} mn1 = m + n*NB;}
\DoxyCodeLine{1203             \textcolor{keyword}{auto} mn2 = m*NB2 + n*NB3;}
\DoxyCodeLine{1204             \textcolor{keyword}{auto} bf1nB = bf1*nBasis;}
\DoxyCodeLine{1205             \textcolor{keyword}{auto} bf2nB = bf2*nBasis;}
\DoxyCodeLine{1206 }
\DoxyCodeLine{1207           \textcolor{keywordflow}{for}(k = 2*maxShellSize, bf3 = bf3\_s; k < 2*maxShellSize + n3; ++k, bf3++) \{}
\DoxyCodeLine{1208             \textcolor{keyword}{auto} bf3nB = bf3*nBasis;}
\DoxyCodeLine{1209             \textcolor{keyword}{auto} kmn1 = mn1 + k*NB2;}
\DoxyCodeLine{1210             \textcolor{keyword}{auto} kmn2 = k + mn2;}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212           \textcolor{keywordflow}{for}(l = 3*maxShellSize, bf4 = bf4\_s; l < 3*maxShellSize + n4; ++l, bf4++) \{}
\DoxyCodeLine{1213             \textcolor{keyword}{auto} MNKL = kmn1 + l*NB3;}
\DoxyCodeLine{1214             \textcolor{keyword}{auto} KLMN = kmn2 + l*NB;}
\DoxyCodeLine{1215 }
\DoxyCodeLine{1216             \textcolor{keyword}{auto} bf4nB= bf4*nBasis;  }
\DoxyCodeLine{1217 }
\DoxyCodeLine{1218             \textcolor{keyword}{auto} bf14 = bf1 + bf4nB;}
\DoxyCodeLine{1219             \textcolor{keyword}{auto} bf24 = bf2 + bf4nB;}
\DoxyCodeLine{1220             \textcolor{keyword}{auto} bf23 = bf2 + bf3nB;}
\DoxyCodeLine{1221             \textcolor{keyword}{auto} bf13 = bf1 + bf3nB;}
\DoxyCodeLine{1222             \textcolor{keyword}{auto} bf41 = bf4 + bf1nB;}
\DoxyCodeLine{1223             \textcolor{keyword}{auto} bf31 = bf3 + bf1nB;}
\DoxyCodeLine{1224             \textcolor{keyword}{auto} bf32 = bf3 + bf2nB;}
\DoxyCodeLine{1225             \textcolor{keyword}{auto} bf42 = bf4 + bf2nB;}
\DoxyCodeLine{1226   }
\DoxyCodeLine{1227             \textcolor{keyword}{auto} DotPrdMNKL = MNKL;}
\DoxyCodeLine{1228             \textcolor{keyword}{auto} CrossXMNKL = MNKL+NB4;}
\DoxyCodeLine{1229             \textcolor{keyword}{auto} CrossYMNKL = MNKL+NB4\_2;}
\DoxyCodeLine{1230             \textcolor{keyword}{auto} CrossZMNKL = MNKL+NB4\_3;}
\DoxyCodeLine{1231   }
\DoxyCodeLine{1232             \textcolor{keyword}{auto} DotPrdKLMN = KLMN;}
\DoxyCodeLine{1233             \textcolor{keyword}{auto} CrossXKLMN = KLMN+NB4;}
\DoxyCodeLine{1234             \textcolor{keyword}{auto} CrossYKLMN = KLMN+NB4\_2;}
\DoxyCodeLine{1235             \textcolor{keyword}{auto} CrossZKLMN = KLMN+NB4\_3;}
\DoxyCodeLine{1236   }
\DoxyCodeLine{1237   }
\DoxyCodeLine{1238             \textcolor{comment}{/*++++++++++++++++++++++++++++++++++++++++++*/}}
\DoxyCodeLine{1239             \textcolor{comment}{/* Start of Dirac-\/Coulomb (LL|SS) / (SS|LL) */}}
\DoxyCodeLine{1240             \textcolor{comment}{/*++++++++++++++++++++++++++++++++++++++++++*/}}
\DoxyCodeLine{1241   }
\DoxyCodeLine{1242   }
\DoxyCodeLine{1243  }
\DoxyCodeLine{1244             \textcolor{comment}{//MNKL}}
\DoxyCodeLine{1245             ADXLSMS[bf14]+= -\/ERIBuffCD[DotPrdMNKL]*DXLSMS[bf23]}
\DoxyCodeLine{1246                             -\/( ERIBuffCD[CrossZMNKL]*DXLSMZ[bf23]}
\DoxyCodeLine{1247                               +ERIBuffCD[CrossXMNKL]*DXLSMX[bf23]}
\DoxyCodeLine{1248                               +ERIBuffCD[CrossYMNKL]*DXLSMY[bf23])*iscale;}
\DoxyCodeLine{1249   }
\DoxyCodeLine{1250             ADXLSMX[bf14]+= -\/ERIBuffCD[CrossXMNKL]*DXLSMS[bf23]*iscale}
\DoxyCodeLine{1251                             -\/ERIBuffCD[CrossYMNKL]*DXLSMZ[bf23]}
\DoxyCodeLine{1252                             -\/ERIBuffCD[DotPrdMNKL]*DXLSMX[bf23]}
\DoxyCodeLine{1253                             +ERIBuffCD[CrossZMNKL]*DXLSMY[bf23];}
\DoxyCodeLine{1254   }
\DoxyCodeLine{1255             ADXLSMY[bf14]+= -\/ERIBuffCD[CrossYMNKL]*DXLSMS[bf23]*iscale}
\DoxyCodeLine{1256                             +ERIBuffCD[CrossXMNKL]*DXLSMZ[bf23]}
\DoxyCodeLine{1257                             -\/ERIBuffCD[DotPrdMNKL]*DXLSMY[bf23]}
\DoxyCodeLine{1258                             -\/ERIBuffCD[CrossZMNKL]*DXLSMX[bf23];}
\DoxyCodeLine{1259   }
\DoxyCodeLine{1260             ADXLSMZ[bf14]+= -\/ERIBuffCD[CrossZMNKL]*DXLSMS[bf23]*iscale}
\DoxyCodeLine{1261                             -\/ERIBuffCD[DotPrdMNKL]*DXLSMZ[bf23]}
\DoxyCodeLine{1262                             +ERIBuffCD[CrossYMNKL]*DXLSMX[bf23]}
\DoxyCodeLine{1263                             -\/ERIBuffCD[CrossXMNKL]*DXLSMY[bf23];}
\DoxyCodeLine{1264   }
\DoxyCodeLine{1265             \textcolor{comment}{//MNLK}}
\DoxyCodeLine{1266             \textcolor{keywordflow}{if}(bf3\_s!=bf4\_s) \{}
\DoxyCodeLine{1267   }
\DoxyCodeLine{1268               ADXLSMS[bf13]+= -\/ERIBuffCD[DotPrdMNKL]*DXLSMS[bf24]}
\DoxyCodeLine{1269                               +( ERIBuffCD[CrossZMNKL]*DXLSMZ[bf24]}
\DoxyCodeLine{1270                                 +ERIBuffCD[CrossXMNKL]*DXLSMX[bf24]}
\DoxyCodeLine{1271                                 +ERIBuffCD[CrossYMNKL]*DXLSMY[bf24])*iscale;}
\DoxyCodeLine{1272   }
\DoxyCodeLine{1273               ADXLSMX[bf13]+=  ERIBuffCD[CrossXMNKL]*DXLSMS[bf24]*iscale}
\DoxyCodeLine{1274                               +ERIBuffCD[CrossYMNKL]*DXLSMZ[bf24]}
\DoxyCodeLine{1275                               -\/ERIBuffCD[DotPrdMNKL]*DXLSMX[bf24]}
\DoxyCodeLine{1276                               -\/ERIBuffCD[CrossZMNKL]*DXLSMY[bf24];}
\DoxyCodeLine{1277   }
\DoxyCodeLine{1278               ADXLSMY[bf13]+=  ERIBuffCD[CrossYMNKL]*DXLSMS[bf24]*iscale}
\DoxyCodeLine{1279                               -\/ERIBuffCD[CrossXMNKL]*DXLSMZ[bf24]}
\DoxyCodeLine{1280                               +ERIBuffCD[CrossZMNKL]*DXLSMX[bf24]}
\DoxyCodeLine{1281                               -\/ERIBuffCD[DotPrdMNKL]*DXLSMY[bf24];}
\DoxyCodeLine{1282   }
\DoxyCodeLine{1283               ADXLSMZ[bf13]+=  ERIBuffCD[CrossZMNKL]*DXLSMS[bf24]*iscale}
\DoxyCodeLine{1284                               -\/ERIBuffCD[DotPrdMNKL]*DXLSMZ[bf24]}
\DoxyCodeLine{1285                               -\/ERIBuffCD[CrossYMNKL]*DXLSMX[bf24]}
\DoxyCodeLine{1286                               +ERIBuffCD[CrossXMNKL]*DXLSMY[bf24];}
\DoxyCodeLine{1287   }
\DoxyCodeLine{1288             \}}
\DoxyCodeLine{1289   }
\DoxyCodeLine{1290             \textcolor{comment}{//NMKL}}
\DoxyCodeLine{1291             \textcolor{keywordflow}{if}(bf1\_s!=bf2\_s)\{}
\DoxyCodeLine{1292               ADXLSMS[bf24]+= -\/ERIBuffCD[DotPrdMNKL]*DXLSMS[bf13]}
\DoxyCodeLine{1293                               -\/( ERIBuffCD[CrossZMNKL]*DXLSMZ[bf13]}
\DoxyCodeLine{1294                                 +ERIBuffCD[CrossXMNKL]*DXLSMX[bf13]}
\DoxyCodeLine{1295                                 +ERIBuffCD[CrossYMNKL]*DXLSMY[bf13])*iscale;}
\DoxyCodeLine{1296   }
\DoxyCodeLine{1297               ADXLSMX[bf24]+= -\/ERIBuffCD[CrossXMNKL]*DXLSMS[bf13]*iscale}
\DoxyCodeLine{1298                               -\/ERIBuffCD[CrossYMNKL]*DXLSMZ[bf13]}
\DoxyCodeLine{1299                               -\/ERIBuffCD[DotPrdMNKL]*DXLSMX[bf13]}
\DoxyCodeLine{1300                               +ERIBuffCD[CrossZMNKL]*DXLSMY[bf13];}
\DoxyCodeLine{1301   }
\DoxyCodeLine{1302               ADXLSMY[bf24]+= -\/ERIBuffCD[CrossYMNKL]*DXLSMS[bf13]*iscale}
\DoxyCodeLine{1303                               +ERIBuffCD[CrossXMNKL]*DXLSMZ[bf13]}
\DoxyCodeLine{1304                               -\/ERIBuffCD[CrossZMNKL]*DXLSMX[bf13]}
\DoxyCodeLine{1305                               -\/ERIBuffCD[DotPrdMNKL]*DXLSMY[bf13];}
\DoxyCodeLine{1306   }
\DoxyCodeLine{1307               ADXLSMZ[bf24]+= -\/ERIBuffCD[CrossZMNKL]*DXLSMS[bf13]*iscale}
\DoxyCodeLine{1308                               -\/ERIBuffCD[DotPrdMNKL]*DXLSMZ[bf13]}
\DoxyCodeLine{1309                               +ERIBuffCD[CrossYMNKL]*DXLSMX[bf13]}
\DoxyCodeLine{1310                               -\/ERIBuffCD[CrossXMNKL]*DXLSMY[bf13];}
\DoxyCodeLine{1311   }
\DoxyCodeLine{1312               \textcolor{keywordflow}{if}(bf3\_s!=bf4\_s) \{}
\DoxyCodeLine{1313   }
\DoxyCodeLine{1314                 ADXLSMS[bf23]+= -\/ERIBuffCD[DotPrdMNKL]*DXLSMS[bf14]}
\DoxyCodeLine{1315                                 +( ERIBuffCD[CrossZMNKL]*DXLSMZ[bf14]}
\DoxyCodeLine{1316                                   +ERIBuffCD[CrossXMNKL]*DXLSMX[bf14]}
\DoxyCodeLine{1317                                   +ERIBuffCD[CrossYMNKL]*DXLSMY[bf14])*iscale;}
\DoxyCodeLine{1318   }
\DoxyCodeLine{1319                 ADXLSMX[bf23]+= +ERIBuffCD[CrossXMNKL]*DXLSMS[bf14]*iscale}
\DoxyCodeLine{1320                                 +ERIBuffCD[CrossYMNKL]*DXLSMZ[bf14]}
\DoxyCodeLine{1321                                 -\/ERIBuffCD[DotPrdMNKL]*DXLSMX[bf14]}
\DoxyCodeLine{1322                                 -\/ERIBuffCD[CrossZMNKL]*DXLSMY[bf14];}
\DoxyCodeLine{1323   }
\DoxyCodeLine{1324                 ADXLSMY[bf23]+= +ERIBuffCD[CrossYMNKL]*DXLSMS[bf14]*iscale}
\DoxyCodeLine{1325                                 -\/ERIBuffCD[CrossXMNKL]*DXLSMZ[bf14]}
\DoxyCodeLine{1326                                 +ERIBuffCD[CrossZMNKL]*DXLSMX[bf14]}
\DoxyCodeLine{1327                                 -\/ERIBuffCD[DotPrdMNKL]*DXLSMY[bf14];}
\DoxyCodeLine{1328   }
\DoxyCodeLine{1329                 ADXLSMZ[bf23]+= +ERIBuffCD[CrossZMNKL]*DXLSMS[bf14]*iscale}
\DoxyCodeLine{1330                                 -\/ERIBuffCD[DotPrdMNKL]*DXLSMZ[bf14]}
\DoxyCodeLine{1331                                 -\/ERIBuffCD[CrossYMNKL]*DXLSMX[bf14]}
\DoxyCodeLine{1332                                 +ERIBuffCD[CrossXMNKL]*DXLSMY[bf14];}
\DoxyCodeLine{1333   }
\DoxyCodeLine{1334               \}}
\DoxyCodeLine{1335             \}}
\DoxyCodeLine{1336   }
\DoxyCodeLine{1337             \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{1338             \textcolor{comment}{/*   End of Dirac-\/Coulomb (LL|SS) / (SS|LL) */}}
\DoxyCodeLine{1339             \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{1340           \}}
\DoxyCodeLine{1341         \}}
\DoxyCodeLine{1342         \}  }
\DoxyCodeLine{1343           \} \textcolor{comment}{// contraction loop}}
\DoxyCodeLine{1344   }
\DoxyCodeLine{1345 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{1346   }
\DoxyCodeLine{1347   }
\DoxyCodeLine{1348         \}; \textcolor{comment}{// loop s4}}
\DoxyCodeLine{1349         \}; \textcolor{comment}{// loop s3}}
\DoxyCodeLine{1350         \}; \textcolor{comment}{// loop s2}}
\DoxyCodeLine{1351         \}; \textcolor{comment}{// loop s1}}
\DoxyCodeLine{1352   }
\DoxyCodeLine{1353   }
\DoxyCodeLine{1354       \} \textcolor{comment}{// OpenMP context}}
\DoxyCodeLine{1355   }
\DoxyCodeLine{1356   }
\DoxyCodeLine{1357       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iTh  = 0; iTh < nThreads; iTh++) \{}
\DoxyCodeLine{1358    }
\DoxyCodeLine{1359         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{1360            matList[XLSMS].AX,nBasis,matList[XLSMS].AX,nBasis);}
\DoxyCodeLine{1361 }
\DoxyCodeLine{1362         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{1363            matList[XLSMX].AX,nBasis,matList[XLSMX].AX,nBasis);}
\DoxyCodeLine{1364 }
\DoxyCodeLine{1365         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{1366            matList[XLSMY].AX,nBasis,matList[XLSMY].AX,nBasis);}
\DoxyCodeLine{1367 }
\DoxyCodeLine{1368         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{1369            matList[XLSMZ].AX,nBasis,matList[XLSMZ].AX,nBasis);}
\DoxyCodeLine{1370   }
\DoxyCodeLine{1371       \};}
\DoxyCodeLine{1372    }
\DoxyCodeLine{1373       memManager\_.free(ERIBuffer);}
\DoxyCodeLine{1374       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{1375 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1376       \textcolor{keywordflow}{if}(ShBlkNorms\_raw!=\textcolor{keyword}{nullptr}) memManager\_.free(ShBlkNorms\_raw);}
\DoxyCodeLine{1377 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1378   }
\DoxyCodeLine{1379 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{1380       \textcolor{keywordtype}{size\_t} nIntSkipLS = std::accumulate(nSkipLS.begin(),nSkipLS.end(),0);}
\DoxyCodeLine{1381       std::cout << \textcolor{stringliteral}{"{}Dirac-\/Coulomb-\/LS Screened "{}} << nIntSkipLS << std::endl;}
\DoxyCodeLine{1382   }
\DoxyCodeLine{1383       \textcolor{keyword}{auto} durDirectLS = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topDirectLS);}
\DoxyCodeLine{1384       std::cout << \textcolor{stringliteral}{"{}Dirac-\/Coulomb-\/LS AO Direct Contraction took "{}} <<  durDirectLS << \textcolor{stringliteral}{"{} s\(\backslash\)n"{}}; }
\DoxyCodeLine{1385   }
\DoxyCodeLine{1386       std::cout << std::endl;}
\DoxyCodeLine{1387 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1388 }
\DoxyCodeLine{1389     \} \textcolor{comment}{// if(LLSS)}}
\DoxyCodeLine{1390 }
\DoxyCodeLine{1391 \textcolor{comment}{    /***************************/}}
\DoxyCodeLine{1392     \textcolor{comment}{/*                         */}}
\DoxyCodeLine{1393     \textcolor{comment}{/*   End of (LLSS)/(SSLL)  */}}
\DoxyCodeLine{1394     \textcolor{comment}{/*                         */}}
\DoxyCodeLine{1395 \textcolor{comment}{    /***************************/}}
\DoxyCodeLine{1396 }
\DoxyCodeLine{1397 }
\DoxyCodeLine{1398 }
\DoxyCodeLine{1399 }
\DoxyCodeLine{1400 }
\DoxyCodeLine{1401 }
\DoxyCodeLine{1402 }
\DoxyCodeLine{1403 }
\DoxyCodeLine{1404 }
\DoxyCodeLine{1405 }
\DoxyCodeLine{1406 }
\DoxyCodeLine{1407 \textcolor{comment}{    /****************************************/}}
\DoxyCodeLine{1408     \textcolor{comment}{/*                                      */}}
\DoxyCodeLine{1409     \textcolor{comment}{/* Start of Dirac-\/Coulomb C(4)-\/SSSS     */}}
\DoxyCodeLine{1410     \textcolor{comment}{/*                                      */}}
\DoxyCodeLine{1411 \textcolor{comment}{    /****************************************/}}
\DoxyCodeLine{1412 }
\DoxyCodeLine{1413     \textcolor{keywordflow}{if}( matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cbaf5b0f392e82b90ea1452a00512088d53}{TWOBODY\_CONTRACTION\_TYPE::SSSS}} ) \{}
\DoxyCodeLine{1414   }
\DoxyCodeLine{1415       \textcolor{keyword}{enum} ERI\_4TH\_DERIV \{}
\DoxyCodeLine{1416         AxBxCxDx,}
\DoxyCodeLine{1417         AxBxCxDy,}
\DoxyCodeLine{1418         AxBxCxDz,}
\DoxyCodeLine{1419         AxBxCyDx,}
\DoxyCodeLine{1420         AxBxCyDy,}
\DoxyCodeLine{1421         AxBxCyDz,}
\DoxyCodeLine{1422         AxBxCzDx,}
\DoxyCodeLine{1423         AxBxCzDy,}
\DoxyCodeLine{1424         AxBxCzDz,}
\DoxyCodeLine{1425         AxByCxDx,}
\DoxyCodeLine{1426         AxByCxDy,}
\DoxyCodeLine{1427         AxByCxDz,}
\DoxyCodeLine{1428         AxByCyDx,}
\DoxyCodeLine{1429         AxByCyDy,}
\DoxyCodeLine{1430         AxByCyDz,}
\DoxyCodeLine{1431         AxByCzDx,}
\DoxyCodeLine{1432         AxByCzDy,}
\DoxyCodeLine{1433         AxByCzDz,}
\DoxyCodeLine{1434         AxBzCxDx,}
\DoxyCodeLine{1435         AxBzCxDy,}
\DoxyCodeLine{1436         AxBzCxDz,}
\DoxyCodeLine{1437         AxBzCyDx,}
\DoxyCodeLine{1438         AxBzCyDy,}
\DoxyCodeLine{1439         AxBzCyDz,}
\DoxyCodeLine{1440         AxBzCzDx,}
\DoxyCodeLine{1441         AxBzCzDy,}
\DoxyCodeLine{1442         AxBzCzDz,}
\DoxyCodeLine{1443         AyBxCxDx,}
\DoxyCodeLine{1444         AyBxCxDy,}
\DoxyCodeLine{1445         AyBxCxDz,}
\DoxyCodeLine{1446         AyBxCyDx,}
\DoxyCodeLine{1447         AyBxCyDy,}
\DoxyCodeLine{1448         AyBxCyDz,}
\DoxyCodeLine{1449         AyBxCzDx,}
\DoxyCodeLine{1450         AyBxCzDy,}
\DoxyCodeLine{1451         AyBxCzDz,}
\DoxyCodeLine{1452         AyByCxDx,}
\DoxyCodeLine{1453         AyByCxDy,}
\DoxyCodeLine{1454         AyByCxDz,}
\DoxyCodeLine{1455         AyByCyDx,}
\DoxyCodeLine{1456         AyByCyDy,}
\DoxyCodeLine{1457         AyByCyDz,}
\DoxyCodeLine{1458         AyByCzDx,}
\DoxyCodeLine{1459         AyByCzDy,}
\DoxyCodeLine{1460         AyByCzDz,}
\DoxyCodeLine{1461         AyBzCxDx,}
\DoxyCodeLine{1462         AyBzCxDy,}
\DoxyCodeLine{1463         AyBzCxDz,}
\DoxyCodeLine{1464         AyBzCyDx,}
\DoxyCodeLine{1465         AyBzCyDy,}
\DoxyCodeLine{1466         AyBzCyDz,}
\DoxyCodeLine{1467         AyBzCzDx,}
\DoxyCodeLine{1468         AyBzCzDy,}
\DoxyCodeLine{1469         AyBzCzDz,}
\DoxyCodeLine{1470         AzBxCxDx,}
\DoxyCodeLine{1471         AzBxCxDy,}
\DoxyCodeLine{1472         AzBxCxDz,}
\DoxyCodeLine{1473         AzBxCyDx,}
\DoxyCodeLine{1474         AzBxCyDy,}
\DoxyCodeLine{1475         AzBxCyDz,}
\DoxyCodeLine{1476         AzBxCzDx,}
\DoxyCodeLine{1477         AzBxCzDy,}
\DoxyCodeLine{1478         AzBxCzDz,}
\DoxyCodeLine{1479         AzByCxDx,}
\DoxyCodeLine{1480         AzByCxDy,}
\DoxyCodeLine{1481         AzByCxDz,}
\DoxyCodeLine{1482         AzByCyDx,}
\DoxyCodeLine{1483         AzByCyDy,}
\DoxyCodeLine{1484         AzByCyDz,}
\DoxyCodeLine{1485         AzByCzDx,}
\DoxyCodeLine{1486         AzByCzDy,}
\DoxyCodeLine{1487         AzByCzDz,}
\DoxyCodeLine{1488         AzBzCxDx,}
\DoxyCodeLine{1489         AzBzCxDy,}
\DoxyCodeLine{1490         AzBzCxDz,}
\DoxyCodeLine{1491         AzBzCyDx,}
\DoxyCodeLine{1492         AzBzCyDy,}
\DoxyCodeLine{1493         AzBzCyDz,}
\DoxyCodeLine{1494         AzBzCzDx,}
\DoxyCodeLine{1495         AzBzCzDy,}
\DoxyCodeLine{1496         AzBzCzDz,}
\DoxyCodeLine{1497       \};}
\DoxyCodeLine{1498   }
\DoxyCodeLine{1499   }
\DoxyCodeLine{1500 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{1501       \textcolor{keyword}{auto} topDirectSSSS = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{1502 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1503 }
\DoxyCodeLine{1504 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1505       \textcolor{comment}{// Compute shell block norms (∞-\/norm) of matList.X}}
\DoxyCodeLine{1506       \textcolor{comment}{// CSSMS, CSSMX, CSSMY, CSSMZ Densitry matrices}}
\DoxyCodeLine{1507       \textcolor{keywordtype}{int} mMat = 4;}
\DoxyCodeLine{1508       \textcolor{keywordtype}{double} *ShBlkNorms\_raw = memManager\_.malloc<\textcolor{keywordtype}{double}>(mMat*nShell*nShell);}
\DoxyCodeLine{1509       std::vector<double*> ShBlkNorms;}
\DoxyCodeLine{1510   }
\DoxyCodeLine{1511       \textcolor{keyword}{auto} iOff = 0;}
\DoxyCodeLine{1512       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1513       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1514   }
\DoxyCodeLine{1515       iOff += nShell*nShell;}
\DoxyCodeLine{1516       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1517       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1518   }
\DoxyCodeLine{1519       iOff += nShell*nShell;}
\DoxyCodeLine{1520       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1521       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1522   }
\DoxyCodeLine{1523       iOff += nShell*nShell;}
\DoxyCodeLine{1524       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[CSSMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1525       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{1526   }
\DoxyCodeLine{1527       \textcolor{comment}{// Get the max over all the matricies for the shell block ∞-\/norms}}
\DoxyCodeLine{1528       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} k = 0; k < nShell*nShell; k++) \{}
\DoxyCodeLine{1529   }
\DoxyCodeLine{1530         \textcolor{keywordtype}{double} mx = std::abs(ShBlkNorms[0][k]);}
\DoxyCodeLine{1531         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < mMat; iMat++)}
\DoxyCodeLine{1532           mx = std::max(mx,std::abs(ShBlkNorms[iMat][k]));}
\DoxyCodeLine{1533         ShBlkNorms[0][k] = mx;}
\DoxyCodeLine{1534    }
\DoxyCodeLine{1535       \}}
\DoxyCodeLine{1536 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1537 }
\DoxyCodeLine{1538 }
\DoxyCodeLine{1539 }
\DoxyCodeLine{1540       nERI = 81;}
\DoxyCodeLine{1541       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(nERI*buffN4*nThreads);}
\DoxyCodeLine{1542       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{1543       ERIBuffer = memManager\_.malloc<\textcolor{keywordtype}{double}>(16*NB4*nThreads);}
\DoxyCodeLine{1544   }
\DoxyCodeLine{1545       memset(AXRaw,0,nThreads*nMat*nBasis*nBasis*\textcolor{keyword}{sizeof}(MatsT));}
\DoxyCodeLine{1546   }
\DoxyCodeLine{1547       \textcolor{comment}{// Keeping track of number of integrals skipped}}
\DoxyCodeLine{1548       std::vector<size\_t> nSkipSSSS(nThreads,0);}
\DoxyCodeLine{1549 }
\DoxyCodeLine{1550       \textcolor{keyword}{auto} NB4\_4  = 4*NB4;  }
\DoxyCodeLine{1551       \textcolor{keyword}{auto} NB4\_5  = 5*NB4;  }
\DoxyCodeLine{1552       \textcolor{keyword}{auto} NB4\_6  = 6*NB4;  }
\DoxyCodeLine{1553       \textcolor{keyword}{auto} NB4\_7  = 7*NB4;  }
\DoxyCodeLine{1554       \textcolor{keyword}{auto} NB4\_8  = 8*NB4;  }
\DoxyCodeLine{1555       \textcolor{keyword}{auto} NB4\_9  = 9*NB4;  }
\DoxyCodeLine{1556       \textcolor{keyword}{auto} NB4\_10 =10*NB4;  }
\DoxyCodeLine{1557       \textcolor{keyword}{auto} NB4\_11 =11*NB4;  }
\DoxyCodeLine{1558       \textcolor{keyword}{auto} NB4\_12 =12*NB4;  }
\DoxyCodeLine{1559       \textcolor{keyword}{auto} NB4\_13 =13*NB4;  }
\DoxyCodeLine{1560       \textcolor{keyword}{auto} NB4\_14 =14*NB4;  }
\DoxyCodeLine{1561       \textcolor{keyword}{auto} NB4\_15 =15*NB4;  }
\DoxyCodeLine{1562   }
\DoxyCodeLine{1563   }
\DoxyCodeLine{1564 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{1565       \{}
\DoxyCodeLine{1566   }
\DoxyCodeLine{1567         \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}} iscale = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{1568   }
\DoxyCodeLine{1569         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{1570   }
\DoxyCodeLine{1571         \textcolor{keyword}{auto} \&AX\_loc = AXthreads[thread\_id];}
\DoxyCodeLine{1572   }
\DoxyCodeLine{1573         \textcolor{keywordtype}{double} *ERIBuffABCD = \&ERIBuffer[thread\_id*16*NB4];}
\DoxyCodeLine{1574   }
\DoxyCodeLine{1575         \textcolor{keywordtype}{size\_t} n1,n2,n3,n4,m,n,k,l,mnkl,bf1,bf2,bf3,bf4;}
\DoxyCodeLine{1576         \textcolor{keywordtype}{size\_t} s4\_max;}
\DoxyCodeLine{1577   }
\DoxyCodeLine{1578         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{1579         \textcolor{keywordtype}{double} *buff = \&buffAll[nERI*buffN4*thread\_id];}
\DoxyCodeLine{1580         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{1581   }
\DoxyCodeLine{1582   }
\DoxyCodeLine{1583         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s1234(0); s1 < basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a936871b121472a416ee6f947ccdea4b4}{nShell}}; }
\DoxyCodeLine{1584             bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{1585   }
\DoxyCodeLine{1586           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{1587   }
\DoxyCodeLine{1588         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 <= s1; bf2\_s+=n2, s2++) \{}
\DoxyCodeLine{1589   }
\DoxyCodeLine{1590           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{1591   }
\DoxyCodeLine{1592 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1593           \textcolor{keywordtype}{double} shMax12 = ShBlkNorms[0][s1 + s2*nShell];}
\DoxyCodeLine{1594 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1595   }
\DoxyCodeLine{1596         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s3(0), bf3\_s(0); s3 <= s1; bf3\_s+=n3, s3++) \{}
\DoxyCodeLine{1597   }
\DoxyCodeLine{1598           n3 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s3].size(); \textcolor{comment}{// Size of Shell 3}}
\DoxyCodeLine{1599           s4\_max = (s1 == s3) ? s2 : s3; \textcolor{comment}{// Determine the unique max of Shell 4}}
\DoxyCodeLine{1600   }
\DoxyCodeLine{1601 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1602           \textcolor{keywordtype}{double} shMax123 = std::max(ShBlkNorms[0][s1 + s3*nShell], ShBlkNorms[0][s2 + s3*nShell]);}
\DoxyCodeLine{1603           shMax123 = std::max(shMax123,shMax12);}
\DoxyCodeLine{1604 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1605 }
\DoxyCodeLine{1606         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s4(0), bf4\_s(0); s4 <= s4\_max; bf4\_s+=n4, s4++, s1234++) \{}
\DoxyCodeLine{1607   }
\DoxyCodeLine{1608           n4 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s4].size(); \textcolor{comment}{// Size of Shell 4}}
\DoxyCodeLine{1609   }
\DoxyCodeLine{1610           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{1611 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{1612           \textcolor{keywordflow}{if}( s1234 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1613 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{1614 }
\DoxyCodeLine{1615 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{1616           \textcolor{keywordtype}{double} shMax = std::max(ShBlkNorms[0][s1 + s4*nShell],}
\DoxyCodeLine{1617                                   std::max(ShBlkNorms[0][s2 + s4*nShell],}
\DoxyCodeLine{1618                                            ShBlkNorms[0][s3 + s4*nShell]));}
\DoxyCodeLine{1619 }
\DoxyCodeLine{1620           shMax = std::max(shMax,shMax123);}
\DoxyCodeLine{1621 }
\DoxyCodeLine{1622           \textcolor{keywordflow}{if}((shMax*SchwarzSSSS[s1+s2*nShell]*SchwarzSSSS[s3 + s4*nShell]) <}
\DoxyCodeLine{1623              eri.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_a51ce753ee588706401406d4216c1ba74}{threshSchwarz}}()) \{ nSkipSSSS[thread\_id]++; \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{1624 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1625 }
\DoxyCodeLine{1626 }
\DoxyCodeLine{1627           \textcolor{keyword}{auto} nQuad = n1*n2*n3*n4;}
\DoxyCodeLine{1628   }
\DoxyCodeLine{1629           shls[0] = int(s1);}
\DoxyCodeLine{1630           shls[1] = int(s2);}
\DoxyCodeLine{1631           shls[2] = int(s3);}
\DoxyCodeLine{1632           shls[3] = int(s4);}
\DoxyCodeLine{1633   }
\DoxyCodeLine{1634           \textcolor{keywordflow}{if}(int2e\_ipvip1ipvip2\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{1635   }
\DoxyCodeLine{1636           \textcolor{keywordflow}{for}(l = 3*maxShellSize, mnkl = 0ul; l < 3*maxShellSize + n4; ++l)}
\DoxyCodeLine{1637           \textcolor{keywordflow}{for}(k = 2*maxShellSize            ; k < 2*maxShellSize + n3; ++k) }
\DoxyCodeLine{1638           \textcolor{keywordflow}{for}(n =   maxShellSize            ; n <   maxShellSize + n2; ++n) }
\DoxyCodeLine{1639           \textcolor{keywordflow}{for}(m = 0                         ; m <                  n1; ++m, ++mnkl) \{}
\DoxyCodeLine{1640   }
\DoxyCodeLine{1641             \textcolor{comment}{// (∇A∙∇B)(∇C∙∇D)(mnkl)}}
\DoxyCodeLine{1642             \textcolor{keyword}{auto} dAdotdBdCdotdD =  buff[AxBxCxDx*nQuad+mnkl] + buff[AxBxCyDy*nQuad+mnkl] + buff[AxBxCzDz*nQuad+mnkl]}
\DoxyCodeLine{1643                                  + buff[AyByCxDx*nQuad+mnkl] + buff[AyByCyDy*nQuad+mnkl] + buff[AyByCzDz*nQuad+mnkl]}
\DoxyCodeLine{1644                                  + buff[AzBzCxDx*nQuad+mnkl] + buff[AzBzCyDy*nQuad+mnkl] + buff[AzBzCzDz*nQuad+mnkl];}
\DoxyCodeLine{1645   }
\DoxyCodeLine{1646             \textcolor{comment}{// (∇Ax∇B)(∇C∙∇D)(mnkl)}}
\DoxyCodeLine{1647             \textcolor{keyword}{auto} dAcrossdB\_xdCdotdD =  buff[AyBzCxDx*nQuad+mnkl] -\/ buff[AzByCxDx*nQuad+mnkl]}
\DoxyCodeLine{1648                                      + buff[AyBzCyDy*nQuad+mnkl] -\/ buff[AzByCyDy*nQuad+mnkl]}
\DoxyCodeLine{1649                                      + buff[AyBzCzDz*nQuad+mnkl] -\/ buff[AzByCzDz*nQuad+mnkl];}
\DoxyCodeLine{1650   }
\DoxyCodeLine{1651             \textcolor{keyword}{auto} dAcrossdB\_ydCdotdD = -\/buff[AxBzCxDx*nQuad+mnkl] + buff[AzBxCxDx*nQuad+mnkl]}
\DoxyCodeLine{1652                                       -\/buff[AxBzCyDy*nQuad+mnkl] + buff[AzBxCyDy*nQuad+mnkl]}
\DoxyCodeLine{1653                                       -\/buff[AxBzCzDz*nQuad+mnkl] + buff[AzBxCzDz*nQuad+mnkl];}
\DoxyCodeLine{1654                                       }
\DoxyCodeLine{1655             \textcolor{keyword}{auto} dAcrossdB\_zdCdotdD =  buff[AxByCxDx*nQuad+mnkl] -\/ buff[AyBxCxDx*nQuad+mnkl]}
\DoxyCodeLine{1656                                      + buff[AxByCyDy*nQuad+mnkl] -\/ buff[AyBxCyDy*nQuad+mnkl]}
\DoxyCodeLine{1657                                      + buff[AxByCzDz*nQuad+mnkl] -\/ buff[AyBxCzDz*nQuad+mnkl];}
\DoxyCodeLine{1658     }
\DoxyCodeLine{1659             \textcolor{comment}{// (∇A∙∇B)(∇Cx∇D)(mnkl)}}
\DoxyCodeLine{1660             \textcolor{keyword}{auto} dAdotdBdCcrossdD\_x =  buff[AxBxCyDz*nQuad+mnkl] -\/ buff[AxBxCzDy*nQuad+mnkl]}
\DoxyCodeLine{1661                                      + buff[AyByCyDz*nQuad+mnkl] -\/ buff[AyByCzDy*nQuad+mnkl]}
\DoxyCodeLine{1662                                      + buff[AzBzCyDz*nQuad+mnkl] -\/ buff[AzBzCzDy*nQuad+mnkl];}
\DoxyCodeLine{1663   }
\DoxyCodeLine{1664             \textcolor{keyword}{auto} dAdotdBdCcrossdD\_y = -\/buff[AxBxCxDz*nQuad+mnkl] + buff[AxBxCzDx*nQuad+mnkl]}
\DoxyCodeLine{1665                                       -\/buff[AyByCxDz*nQuad+mnkl] + buff[AyByCzDx*nQuad+mnkl]}
\DoxyCodeLine{1666                                       -\/buff[AzBzCxDz*nQuad+mnkl] + buff[AzBzCzDx*nQuad+mnkl];}
\DoxyCodeLine{1667                                       }
\DoxyCodeLine{1668             \textcolor{keyword}{auto} dAdotdBdCcrossdD\_z =  buff[AxBxCxDy*nQuad+mnkl] -\/ buff[AxBxCyDx*nQuad+mnkl]}
\DoxyCodeLine{1669                                      + buff[AyByCxDy*nQuad+mnkl] -\/ buff[AyByCyDx*nQuad+mnkl]}
\DoxyCodeLine{1670                                      + buff[AzBzCxDy*nQuad+mnkl] -\/ buff[AzBzCyDx*nQuad+mnkl];}
\DoxyCodeLine{1671   }
\DoxyCodeLine{1672             \textcolor{comment}{// (∇Ax∇B)(∇Cx∇D)(mnkl)}}
\DoxyCodeLine{1673             \textcolor{keyword}{auto} dAcrossdB\_xdCcrossdD\_x =  buff[AyBzCyDz*nQuad+mnkl] -\/ buff[AzByCyDz*nQuad+mnkl]}
\DoxyCodeLine{1674                                          -\/ buff[AyBzCzDy*nQuad+mnkl] + buff[AzByCzDy*nQuad+mnkl];}
\DoxyCodeLine{1675   }
\DoxyCodeLine{1676             \textcolor{keyword}{auto} dAcrossdB\_xdCcrossdD\_y =  buff[AyBzCzDx*nQuad+mnkl] -\/ buff[AzByCzDx*nQuad+mnkl]}
\DoxyCodeLine{1677                                          -\/ buff[AyBzCxDz*nQuad+mnkl] + buff[AzByCxDz*nQuad+mnkl];}
\DoxyCodeLine{1678   }
\DoxyCodeLine{1679             \textcolor{keyword}{auto} dAcrossdB\_xdCcrossdD\_z =  buff[AyBzCxDy*nQuad+mnkl] -\/ buff[AzByCxDy*nQuad+mnkl]}
\DoxyCodeLine{1680                                          -\/ buff[AyBzCyDx*nQuad+mnkl] + buff[AzByCyDx*nQuad+mnkl];}
\DoxyCodeLine{1681   }
\DoxyCodeLine{1682             \textcolor{keyword}{auto} dAcrossdB\_ydCcrossdD\_x =  buff[AzBxCyDz*nQuad+mnkl] -\/ buff[AxBzCyDz*nQuad+mnkl]}
\DoxyCodeLine{1683                                          -\/ buff[AzBxCzDy*nQuad+mnkl] + buff[AxBzCzDy*nQuad+mnkl];}
\DoxyCodeLine{1684   }
\DoxyCodeLine{1685             \textcolor{keyword}{auto} dAcrossdB\_ydCcrossdD\_y =  buff[AzBxCzDx*nQuad+mnkl] -\/ buff[AxBzCzDx*nQuad+mnkl]}
\DoxyCodeLine{1686                                          -\/ buff[AzBxCxDz*nQuad+mnkl] + buff[AxBzCxDz*nQuad+mnkl];}
\DoxyCodeLine{1687   }
\DoxyCodeLine{1688             \textcolor{keyword}{auto} dAcrossdB\_ydCcrossdD\_z =  buff[AzBxCxDy*nQuad+mnkl] -\/ buff[AxBzCxDy*nQuad+mnkl]}
\DoxyCodeLine{1689                                          -\/ buff[AzBxCyDx*nQuad+mnkl] + buff[AxBzCyDx*nQuad+mnkl];}
\DoxyCodeLine{1690   }
\DoxyCodeLine{1691             \textcolor{keyword}{auto} dAcrossdB\_zdCcrossdD\_x =  buff[AxByCyDz*nQuad+mnkl] -\/ buff[AyBxCyDz*nQuad+mnkl]}
\DoxyCodeLine{1692                                          -\/ buff[AxByCzDy*nQuad+mnkl] + buff[AyBxCzDy*nQuad+mnkl];}
\DoxyCodeLine{1693   }
\DoxyCodeLine{1694             \textcolor{keyword}{auto} dAcrossdB\_zdCcrossdD\_y =  buff[AxByCzDx*nQuad+mnkl] -\/ buff[AyBxCzDx*nQuad+mnkl]}
\DoxyCodeLine{1695                                          -\/ buff[AxByCxDz*nQuad+mnkl] + buff[AyBxCxDz*nQuad+mnkl];}
\DoxyCodeLine{1696   }
\DoxyCodeLine{1697             \textcolor{keyword}{auto} dAcrossdB\_zdCcrossdD\_z =  buff[AxByCxDy*nQuad+mnkl] -\/ buff[AyBxCxDy*nQuad+mnkl]}
\DoxyCodeLine{1698                                          -\/ buff[AxByCyDx*nQuad+mnkl] + buff[AyBxCyDx*nQuad+mnkl];}
\DoxyCodeLine{1699   }
\DoxyCodeLine{1700   }
\DoxyCodeLine{1701             \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{1702             \textcolor{keyword}{auto} KLMN = k + l*NB + m*NB2 + n*NB3;}
\DoxyCodeLine{1703 }
\DoxyCodeLine{1704             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{1705             ERIBuffABCD[         MNKL] =  dAdotdBdCdotdD;}
\DoxyCodeLine{1706             ERIBuffABCD[   NB4 + MNKL] =  dAcrossdB\_xdCdotdD;}
\DoxyCodeLine{1707             ERIBuffABCD[ NB4\_2 + MNKL] =  dAcrossdB\_ydCdotdD;}
\DoxyCodeLine{1708             ERIBuffABCD[ NB4\_3 + MNKL] =  dAcrossdB\_zdCdotdD;}
\DoxyCodeLine{1709             ERIBuffABCD[ NB4\_4 + MNKL] =  dAdotdBdCcrossdD\_x;}
\DoxyCodeLine{1710             ERIBuffABCD[ NB4\_5 + MNKL] =  dAdotdBdCcrossdD\_y;}
\DoxyCodeLine{1711             ERIBuffABCD[ NB4\_6 + MNKL] =  dAdotdBdCcrossdD\_z;}
\DoxyCodeLine{1712             ERIBuffABCD[ NB4\_7 + MNKL] =  dAcrossdB\_xdCcrossdD\_x;}
\DoxyCodeLine{1713             ERIBuffABCD[ NB4\_8 + MNKL] =  dAcrossdB\_xdCcrossdD\_y;}
\DoxyCodeLine{1714             ERIBuffABCD[ NB4\_9 + MNKL] =  dAcrossdB\_xdCcrossdD\_z;}
\DoxyCodeLine{1715             ERIBuffABCD[NB4\_10 + MNKL] =  dAcrossdB\_ydCcrossdD\_x;}
\DoxyCodeLine{1716             ERIBuffABCD[NB4\_11 + MNKL] =  dAcrossdB\_ydCcrossdD\_y;}
\DoxyCodeLine{1717             ERIBuffABCD[NB4\_12 + MNKL] =  dAcrossdB\_ydCcrossdD\_z;}
\DoxyCodeLine{1718             ERIBuffABCD[NB4\_13 + MNKL] =  dAcrossdB\_zdCcrossdD\_x; }
\DoxyCodeLine{1719             ERIBuffABCD[NB4\_14 + MNKL] =  dAcrossdB\_zdCcrossdD\_y;}
\DoxyCodeLine{1720             ERIBuffABCD[NB4\_15 + MNKL] =  dAcrossdB\_zdCcrossdD\_z;}
\DoxyCodeLine{1721   }
\DoxyCodeLine{1722             \textcolor{comment}{// (kl|mn)}}
\DoxyCodeLine{1723             ERIBuffABCD[         KLMN] =  dAdotdBdCdotdD;}
\DoxyCodeLine{1724             ERIBuffABCD[   NB4 + KLMN] =  dAdotdBdCcrossdD\_x;}
\DoxyCodeLine{1725             ERIBuffABCD[ NB4\_2 + KLMN] =  dAdotdBdCcrossdD\_y;}
\DoxyCodeLine{1726             ERIBuffABCD[ NB4\_3 + KLMN] =  dAdotdBdCcrossdD\_z;}
\DoxyCodeLine{1727             ERIBuffABCD[ NB4\_4 + KLMN] =  dAcrossdB\_xdCdotdD;}
\DoxyCodeLine{1728             ERIBuffABCD[ NB4\_5 + KLMN] =  dAcrossdB\_ydCdotdD;}
\DoxyCodeLine{1729             ERIBuffABCD[ NB4\_6 + KLMN] =  dAcrossdB\_zdCdotdD;}
\DoxyCodeLine{1730             ERIBuffABCD[ NB4\_7 + KLMN] =  dAcrossdB\_xdCcrossdD\_x;}
\DoxyCodeLine{1731             ERIBuffABCD[ NB4\_8 + KLMN] =  dAcrossdB\_ydCcrossdD\_x;}
\DoxyCodeLine{1732             ERIBuffABCD[ NB4\_9 + KLMN] =  dAcrossdB\_zdCcrossdD\_x;}
\DoxyCodeLine{1733             ERIBuffABCD[NB4\_10 + KLMN] =  dAcrossdB\_xdCcrossdD\_y;}
\DoxyCodeLine{1734             ERIBuffABCD[NB4\_11 + KLMN] =  dAcrossdB\_ydCcrossdD\_y;}
\DoxyCodeLine{1735             ERIBuffABCD[NB4\_12 + KLMN] =  dAcrossdB\_zdCcrossdD\_y;}
\DoxyCodeLine{1736             ERIBuffABCD[NB4\_13 + KLMN] =  dAcrossdB\_xdCcrossdD\_z; }
\DoxyCodeLine{1737             ERIBuffABCD[NB4\_14 + KLMN] =  dAcrossdB\_ydCcrossdD\_z;}
\DoxyCodeLine{1738             ERIBuffABCD[NB4\_15 + KLMN] =  dAcrossdB\_zdCcrossdD\_z;}
\DoxyCodeLine{1739   }
\DoxyCodeLine{1740           \} \textcolor{comment}{// ∇A∇B∇C∇D (SSSS) integrals }}
\DoxyCodeLine{1741   }
\DoxyCodeLine{1742   }
\DoxyCodeLine{1743   }
\DoxyCodeLine{1744   }
\DoxyCodeLine{1745   }
\DoxyCodeLine{1746   }
\DoxyCodeLine{1747   }
\DoxyCodeLine{1748 \textcolor{preprocessor}{\#ifdef \_CONTRACTION\_ }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{1749   }
\DoxyCodeLine{1750           \textcolor{keyword}{auto} DCSSMS = matList[CSSMS].X;}
\DoxyCodeLine{1751           \textcolor{keyword}{auto} DCSSMX = matList[CSSMX].X;}
\DoxyCodeLine{1752           \textcolor{keyword}{auto} DCSSMY = matList[CSSMY].X;}
\DoxyCodeLine{1753           \textcolor{keyword}{auto} DCSSMZ = matList[CSSMZ].X;}
\DoxyCodeLine{1754   }
\DoxyCodeLine{1755           \textcolor{keyword}{auto} ADCSSMS  = AX\_loc[CSSMS];}
\DoxyCodeLine{1756           \textcolor{keyword}{auto} ADCSSMX  = AX\_loc[CSSMX];}
\DoxyCodeLine{1757           \textcolor{keyword}{auto} ADCSSMY  = AX\_loc[CSSMY];}
\DoxyCodeLine{1758           \textcolor{keyword}{auto} ADCSSMZ  = AX\_loc[CSSMZ];}
\DoxyCodeLine{1759   }
\DoxyCodeLine{1760           \textcolor{keyword}{auto} DXSSMS = matList[XSSMS].X;}
\DoxyCodeLine{1761           \textcolor{keyword}{auto} DXSSMX = matList[XSSMX].X;}
\DoxyCodeLine{1762           \textcolor{keyword}{auto} DXSSMY = matList[XSSMY].X;}
\DoxyCodeLine{1763           \textcolor{keyword}{auto} DXSSMZ = matList[XSSMZ].X;}
\DoxyCodeLine{1764   }
\DoxyCodeLine{1765           \textcolor{keyword}{auto} ADXSSMS  = AX\_loc[XSSMS];}
\DoxyCodeLine{1766           \textcolor{keyword}{auto} ADXSSMX  = AX\_loc[XSSMX];}
\DoxyCodeLine{1767           \textcolor{keyword}{auto} ADXSSMY  = AX\_loc[XSSMY];}
\DoxyCodeLine{1768           \textcolor{keyword}{auto} ADXSSMZ  = AX\_loc[XSSMZ];}
\DoxyCodeLine{1769   }
\DoxyCodeLine{1770           \textcolor{keywordflow}{for}(m = 0ul,            bf1 = bf1\_s; m <                  n1; ++m, bf1++) \{}
\DoxyCodeLine{1771 }
\DoxyCodeLine{1772           \textcolor{keywordflow}{for}(n =   maxShellSize, bf2 = bf2\_s; n <   maxShellSize + n2; ++n, bf2++) \{}
\DoxyCodeLine{1773             \textcolor{keyword}{auto} bf1nB = bf1*nBasis;}
\DoxyCodeLine{1774             \textcolor{keyword}{auto} bf2nB = bf2*nBasis;}
\DoxyCodeLine{1775             \textcolor{keyword}{auto} bf21 = bf2 + bf1nB;}
\DoxyCodeLine{1776             \textcolor{keyword}{auto} bf12 = bf1 + bf2nB;}
\DoxyCodeLine{1777             \textcolor{keyword}{auto} mn1 = m + n*NB;}
\DoxyCodeLine{1778             \textcolor{keyword}{auto} mn2 = m*NB2 + n*NB3;}
\DoxyCodeLine{1779 }
\DoxyCodeLine{1780           \textcolor{keywordflow}{for}(k = 2*maxShellSize, bf3 = bf3\_s; k < 2*maxShellSize + n3; ++k, bf3++) \{}
\DoxyCodeLine{1781             \textcolor{keyword}{auto} bf3nB = bf3*nBasis;}
\DoxyCodeLine{1782             \textcolor{keyword}{auto} kmn1 = mn1 + k*NB2;}
\DoxyCodeLine{1783             \textcolor{keyword}{auto} kmn2 = k + mn2;}
\DoxyCodeLine{1784 }
\DoxyCodeLine{1785           \textcolor{keywordflow}{for}(l = 3*maxShellSize, bf4 = bf4\_s; l < 3*maxShellSize + n4; ++l, bf4++) \{}
\DoxyCodeLine{1786             \textcolor{keyword}{auto} MNKL = kmn1 + l*NB3;}
\DoxyCodeLine{1787             \textcolor{keyword}{auto} KLMN = kmn2 + l*NB;}
\DoxyCodeLine{1788 }
\DoxyCodeLine{1789             \textcolor{keyword}{auto} bf4nB = bf4*nBasis;}
\DoxyCodeLine{1790   }
\DoxyCodeLine{1791             \textcolor{keyword}{auto} bf14 = bf1 + bf4nB;}
\DoxyCodeLine{1792             \textcolor{keyword}{auto} bf24 = bf2 + bf4nB;}
\DoxyCodeLine{1793             \textcolor{keyword}{auto} bf23 = bf2 + bf3nB;}
\DoxyCodeLine{1794             \textcolor{keyword}{auto} bf13 = bf1 + bf3nB;}
\DoxyCodeLine{1795 }
\DoxyCodeLine{1796             \textcolor{keyword}{auto} bf41 = bf4 + bf1nB;}
\DoxyCodeLine{1797             \textcolor{keyword}{auto} bf31 = bf3 + bf1nB;}
\DoxyCodeLine{1798             \textcolor{keyword}{auto} bf32 = bf3 + bf2nB;}
\DoxyCodeLine{1799             \textcolor{keyword}{auto} bf42 = bf4 + bf2nB;}
\DoxyCodeLine{1800  }
\DoxyCodeLine{1801 }
\DoxyCodeLine{1802             \textcolor{keyword}{auto} bf43 = bf4 + bf3nB;}
\DoxyCodeLine{1803             \textcolor{keyword}{auto} bf34 = bf3 + bf4nB;}
\DoxyCodeLine{1804   }
\DoxyCodeLine{1805  }
\DoxyCodeLine{1806 }
\DoxyCodeLine{1807 \textcolor{comment}{            /*********************************/}}
\DoxyCodeLine{1808             \textcolor{comment}{/* Dirac-\/Coulomb (SSSS) Integral */}}
\DoxyCodeLine{1809 \textcolor{comment}{            /*********************************/}}
\DoxyCodeLine{1810       }
\DoxyCodeLine{1811   }
\DoxyCodeLine{1812             \textcolor{keyword}{auto} MNKLdAdotdBdCdotdD          = ERIBuffABCD[         MNKL];}
\DoxyCodeLine{1813             \textcolor{keyword}{auto} MNKLdAcrossdB\_xdCdotdD      = ERIBuffABCD[   NB4 + MNKL];}
\DoxyCodeLine{1814             \textcolor{keyword}{auto} MNKLdAcrossdB\_ydCdotdD      = ERIBuffABCD[ NB4\_2 + MNKL];}
\DoxyCodeLine{1815             \textcolor{keyword}{auto} MNKLdAcrossdB\_zdCdotdD      = ERIBuffABCD[ NB4\_3 + MNKL];}
\DoxyCodeLine{1816             \textcolor{keyword}{auto} MNKLdAdotdBdCcrossdD\_x      = ERIBuffABCD[ NB4\_4 + MNKL];}
\DoxyCodeLine{1817             \textcolor{keyword}{auto} MNKLdAdotdBdCcrossdD\_y      = ERIBuffABCD[ NB4\_5 + MNKL];}
\DoxyCodeLine{1818             \textcolor{keyword}{auto} MNKLdAdotdBdCcrossdD\_z      = ERIBuffABCD[ NB4\_6 + MNKL];}
\DoxyCodeLine{1819             \textcolor{keyword}{auto} MNKLdAcrossdB\_xdCcrossdD\_x  = ERIBuffABCD[ NB4\_7 + MNKL];}
\DoxyCodeLine{1820             \textcolor{keyword}{auto} MNKLdAcrossdB\_xdCcrossdD\_y  = ERIBuffABCD[ NB4\_8 + MNKL];}
\DoxyCodeLine{1821             \textcolor{keyword}{auto} MNKLdAcrossdB\_xdCcrossdD\_z  = ERIBuffABCD[ NB4\_9 + MNKL];}
\DoxyCodeLine{1822             \textcolor{keyword}{auto} MNKLdAcrossdB\_ydCcrossdD\_x  = ERIBuffABCD[NB4\_10 + MNKL];}
\DoxyCodeLine{1823             \textcolor{keyword}{auto} MNKLdAcrossdB\_ydCcrossdD\_y  = ERIBuffABCD[NB4\_11 + MNKL];}
\DoxyCodeLine{1824             \textcolor{keyword}{auto} MNKLdAcrossdB\_ydCcrossdD\_z  = ERIBuffABCD[NB4\_12 + MNKL];}
\DoxyCodeLine{1825             \textcolor{keyword}{auto} MNKLdAcrossdB\_zdCcrossdD\_x  = ERIBuffABCD[NB4\_13 + MNKL];}
\DoxyCodeLine{1826             \textcolor{keyword}{auto} MNKLdAcrossdB\_zdCcrossdD\_y  = ERIBuffABCD[NB4\_14 + MNKL];}
\DoxyCodeLine{1827             \textcolor{keyword}{auto} MNKLdAcrossdB\_zdCcrossdD\_z  = ERIBuffABCD[NB4\_15 + MNKL];}
\DoxyCodeLine{1828 }
\DoxyCodeLine{1829             \textcolor{keyword}{auto} KLMNdAdotdBdCdotdD          = ERIBuffABCD[         KLMN];}
\DoxyCodeLine{1830             \textcolor{keyword}{auto} KLMNdAcrossdB\_xdCdotdD      = ERIBuffABCD[   NB4 + KLMN];}
\DoxyCodeLine{1831             \textcolor{keyword}{auto} KLMNdAcrossdB\_ydCdotdD      = ERIBuffABCD[ NB4\_2 + KLMN];}
\DoxyCodeLine{1832             \textcolor{keyword}{auto} KLMNdAcrossdB\_zdCdotdD      = ERIBuffABCD[ NB4\_3 + KLMN];}
\DoxyCodeLine{1833             \textcolor{keyword}{auto} KLMNdAdotdBdCcrossdD\_x      = ERIBuffABCD[ NB4\_4 + KLMN];}
\DoxyCodeLine{1834             \textcolor{keyword}{auto} KLMNdAdotdBdCcrossdD\_y      = ERIBuffABCD[ NB4\_5 + KLMN];}
\DoxyCodeLine{1835             \textcolor{keyword}{auto} KLMNdAdotdBdCcrossdD\_z      = ERIBuffABCD[ NB4\_6 + KLMN];}
\DoxyCodeLine{1836             \textcolor{keyword}{auto} KLMNdAcrossdB\_xdCcrossdD\_x  = ERIBuffABCD[ NB4\_7 + KLMN];}
\DoxyCodeLine{1837             \textcolor{keyword}{auto} KLMNdAcrossdB\_xdCcrossdD\_y  = ERIBuffABCD[ NB4\_8 + KLMN];}
\DoxyCodeLine{1838             \textcolor{keyword}{auto} KLMNdAcrossdB\_xdCcrossdD\_z  = ERIBuffABCD[ NB4\_9 + KLMN];}
\DoxyCodeLine{1839             \textcolor{keyword}{auto} KLMNdAcrossdB\_ydCcrossdD\_x  = ERIBuffABCD[NB4\_10 + KLMN];}
\DoxyCodeLine{1840             \textcolor{keyword}{auto} KLMNdAcrossdB\_ydCcrossdD\_y  = ERIBuffABCD[NB4\_11 + KLMN];}
\DoxyCodeLine{1841             \textcolor{keyword}{auto} KLMNdAcrossdB\_ydCcrossdD\_z  = ERIBuffABCD[NB4\_12 + KLMN];}
\DoxyCodeLine{1842             \textcolor{keyword}{auto} KLMNdAcrossdB\_zdCcrossdD\_x  = ERIBuffABCD[NB4\_13 + KLMN];}
\DoxyCodeLine{1843             \textcolor{keyword}{auto} KLMNdAcrossdB\_zdCcrossdD\_y  = ERIBuffABCD[NB4\_14 + KLMN];}
\DoxyCodeLine{1844             \textcolor{keyword}{auto} KLMNdAcrossdB\_zdCcrossdD\_z  = ERIBuffABCD[NB4\_15 + KLMN];}
\DoxyCodeLine{1845  }
\DoxyCodeLine{1846   }
\DoxyCodeLine{1847             \textcolor{comment}{/* Hermitian Density Matrices */}}
\DoxyCodeLine{1848             \textcolor{keyword}{auto} ScaleF = 2.0;}
\DoxyCodeLine{1849             \textcolor{keyword}{auto} iScaleF = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 2.0);}
\DoxyCodeLine{1850   }
\DoxyCodeLine{1851             \textcolor{keywordflow}{if}(bf3\_s==bf4\_s) \{}
\DoxyCodeLine{1852               ScaleF = 1.0;}
\DoxyCodeLine{1853               iScaleF = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{1854             \}}
\DoxyCodeLine{1855   }
\DoxyCodeLine{1856             \textcolor{comment}{//}}
\DoxyCodeLine{1857             \textcolor{comment}{// COULOMB}}
\DoxyCodeLine{1858             \textcolor{comment}{// MNKL}}
\DoxyCodeLine{1859   }
\DoxyCodeLine{1860             \textcolor{keywordflow}{if}(bf1 >= bf2) \{}
\DoxyCodeLine{1861   }
\DoxyCodeLine{1862               \textcolor{comment}{/* Equation 70 in the paper */}}
\DoxyCodeLine{1863               ADCSSMS[bf12] +=}
\DoxyCodeLine{1864                 ( DCSSMS[bf43].real()*MNKLdAdotdBdCdotdD}
\DoxyCodeLine{1865                  -\/DCSSMZ[bf43].imag()*MNKLdAdotdBdCcrossdD\_z}
\DoxyCodeLine{1866                  -\/DCSSMX[bf43].imag()*MNKLdAdotdBdCcrossdD\_x}
\DoxyCodeLine{1867                  -\/DCSSMY[bf43].imag()*MNKLdAdotdBdCcrossdD\_y}
\DoxyCodeLine{1868               )*ScaleF;}
\DoxyCodeLine{1869     }
\DoxyCodeLine{1870               \textcolor{comment}{/* Equation 71 in the paper */}}
\DoxyCodeLine{1871               ADCSSMZ[bf12] +=}
\DoxyCodeLine{1872                 ( DCSSMS[bf43].real()*MNKLdAcrossdB\_zdCdotdD}
\DoxyCodeLine{1873                  -\/DCSSMX[bf43].imag()*MNKLdAcrossdB\_zdCcrossdD\_x}
\DoxyCodeLine{1874                  -\/DCSSMY[bf43].imag()*MNKLdAcrossdB\_zdCcrossdD\_y}
\DoxyCodeLine{1875                  -\/DCSSMZ[bf43].imag()*MNKLdAcrossdB\_zdCcrossdD\_z}
\DoxyCodeLine{1876                 )*iScaleF;}
\DoxyCodeLine{1877         }
\DoxyCodeLine{1878               \textcolor{comment}{/* Equation 72 in the paper */}}
\DoxyCodeLine{1879               ADCSSMX[bf12] +=}
\DoxyCodeLine{1880                 ( DCSSMS[bf43].real()*MNKLdAcrossdB\_xdCdotdD}
\DoxyCodeLine{1881                  -\/DCSSMX[bf43].imag()*MNKLdAcrossdB\_xdCcrossdD\_x}
\DoxyCodeLine{1882                  -\/DCSSMY[bf43].imag()*MNKLdAcrossdB\_xdCcrossdD\_y}
\DoxyCodeLine{1883                  -\/DCSSMZ[bf43].imag()*MNKLdAcrossdB\_xdCcrossdD\_z}
\DoxyCodeLine{1884                 )*iScaleF;}
\DoxyCodeLine{1885         }
\DoxyCodeLine{1886               \textcolor{comment}{/* Equation 73 in the paper */}}
\DoxyCodeLine{1887               ADCSSMY[bf12] +=}
\DoxyCodeLine{1888                 ( DCSSMS[bf43].real()*MNKLdAcrossdB\_ydCdotdD}
\DoxyCodeLine{1889                  -\/DCSSMX[bf43].imag()*MNKLdAcrossdB\_ydCcrossdD\_x}
\DoxyCodeLine{1890                  -\/DCSSMY[bf43].imag()*MNKLdAcrossdB\_ydCcrossdD\_y}
\DoxyCodeLine{1891                  -\/DXSSMZ[bf43].imag()*MNKLdAcrossdB\_ydCcrossdD\_z}
\DoxyCodeLine{1892                 )*iScaleF;}
\DoxyCodeLine{1893   }
\DoxyCodeLine{1894             \}}
\DoxyCodeLine{1895   }
\DoxyCodeLine{1896   }
\DoxyCodeLine{1897   }
\DoxyCodeLine{1898   }
\DoxyCodeLine{1899             \textcolor{comment}{/* KLMN */}}
\DoxyCodeLine{1900             \textcolor{keywordflow}{if}((bf1\_s!=bf3\_s or bf2\_s!=bf4\_s) and bf3 >= bf4)\{}
\DoxyCodeLine{1901  }
\DoxyCodeLine{1902               ScaleF = 2.0;}
\DoxyCodeLine{1903               iScaleF = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 2.0);}
\DoxyCodeLine{1904   }
\DoxyCodeLine{1905               \textcolor{keywordflow}{if}(bf1\_s==bf2\_s) \{}
\DoxyCodeLine{1906                 ScaleF = 1.0;}
\DoxyCodeLine{1907                 iScaleF = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{1908               \}}
\DoxyCodeLine{1909   }
\DoxyCodeLine{1910               \textcolor{comment}{/* Equation 70 in the paper */}}
\DoxyCodeLine{1911               ADCSSMS[bf34] +=}
\DoxyCodeLine{1912                 ( DCSSMS[bf21].real()*KLMNdAdotdBdCdotdD}
\DoxyCodeLine{1913                  -\/DCSSMZ[bf21].imag()*KLMNdAdotdBdCcrossdD\_z}
\DoxyCodeLine{1914                  -\/DCSSMX[bf21].imag()*KLMNdAdotdBdCcrossdD\_x}
\DoxyCodeLine{1915                  -\/DCSSMY[bf21].imag()*KLMNdAdotdBdCcrossdD\_y}
\DoxyCodeLine{1916               )*ScaleF;}
\DoxyCodeLine{1917   }
\DoxyCodeLine{1918               \textcolor{comment}{/* Equation 71 in the paper */}}
\DoxyCodeLine{1919               ADCSSMZ[bf34] +=}
\DoxyCodeLine{1920                 ( DCSSMS[bf21].real()*KLMNdAcrossdB\_zdCdotdD}
\DoxyCodeLine{1921                  -\/DCSSMX[bf21].imag()*KLMNdAcrossdB\_zdCcrossdD\_x}
\DoxyCodeLine{1922                  -\/DCSSMY[bf21].imag()*KLMNdAcrossdB\_zdCcrossdD\_y}
\DoxyCodeLine{1923                  -\/DCSSMZ[bf21].imag()*KLMNdAcrossdB\_zdCcrossdD\_z}
\DoxyCodeLine{1924               )*iScaleF;}
\DoxyCodeLine{1925       }
\DoxyCodeLine{1926               \textcolor{comment}{/* Equation 72 in the paper */}}
\DoxyCodeLine{1927               ADCSSMX[bf34] +=}
\DoxyCodeLine{1928                 ( DCSSMS[bf21].real()*KLMNdAcrossdB\_xdCdotdD}
\DoxyCodeLine{1929                  -\/DCSSMX[bf21].imag()*KLMNdAcrossdB\_xdCcrossdD\_x}
\DoxyCodeLine{1930                  -\/DCSSMY[bf21].imag()*KLMNdAcrossdB\_xdCcrossdD\_y}
\DoxyCodeLine{1931                  -\/DCSSMZ[bf21].imag()*KLMNdAcrossdB\_xdCcrossdD\_z}
\DoxyCodeLine{1932               )*iScaleF;}
\DoxyCodeLine{1933       }
\DoxyCodeLine{1934               \textcolor{comment}{/* Equation 73 in the paper */}}
\DoxyCodeLine{1935               ADCSSMY[bf34] +=}
\DoxyCodeLine{1936                 ( DCSSMS[bf21].real()*KLMNdAcrossdB\_ydCdotdD}
\DoxyCodeLine{1937                  -\/DCSSMX[bf21].imag()*KLMNdAcrossdB\_ydCcrossdD\_x}
\DoxyCodeLine{1938                  -\/DCSSMY[bf21].imag()*KLMNdAcrossdB\_ydCcrossdD\_y}
\DoxyCodeLine{1939                  -\/DCSSMZ[bf21].imag()*KLMNdAcrossdB\_ydCcrossdD\_z}
\DoxyCodeLine{1940               )*iScaleF;}
\DoxyCodeLine{1941   }
\DoxyCodeLine{1942             \}}
\DoxyCodeLine{1943   }
\DoxyCodeLine{1944     }
\DoxyCodeLine{1945 \textcolor{preprocessor}{\#if 1}}
\DoxyCodeLine{1946             \textcolor{comment}{/* EXCHANGE */}}
\DoxyCodeLine{1947  }
\DoxyCodeLine{1948   }
\DoxyCodeLine{1949             \textcolor{comment}{// MNKL}}
\DoxyCodeLine{1950             \textcolor{keywordflow}{if}(bf1 >= bf4) \{}
\DoxyCodeLine{1951   }
\DoxyCodeLine{1952               \textcolor{comment}{/* Equation 70 in the paper */}}
\DoxyCodeLine{1953               ADXSSMS[bf14] +=}
\DoxyCodeLine{1954                   DXSSMS[bf23]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_y +MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{1955                +( DXSSMX[bf23]*(-\/MNKLdAcrossdB\_xdCdotdD -\/MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{1956                  +DXSSMY[bf23]*(-\/MNKLdAcrossdB\_ydCdotdD -\/MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_zdCcrossdD\_x +MNKLdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{1957                  +DXSSMZ[bf23]*(-\/MNKLdAcrossdB\_zdCdotdD -\/MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{1958     }
\DoxyCodeLine{1959               \textcolor{comment}{/* Equation 71 in the paper */}}
\DoxyCodeLine{1960               ADXSSMZ[bf14] +=}
\DoxyCodeLine{1961                 DXSSMZ[bf23]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_zdCcrossdD\_z -\/MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{1962                +DXSSMS[bf23]*(-\/MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_zdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{1963                +DXSSMY[bf23]*(-\/MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_xdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{1964                +DXSSMX[bf23]*( MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_ydCdotdD +MNKLdAcrossdB\_xdCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{1965           }
\DoxyCodeLine{1966               \textcolor{comment}{/* Equation 72 in the paper */}}
\DoxyCodeLine{1967               ADXSSMX[bf14] += }
\DoxyCodeLine{1968                 DXSSMX[bf23]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_y -\/MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{1969                +DXSSMS[bf23]*(-\/MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_xdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{1970                +DXSSMY[bf23]*( MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_zdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{1971                +DXSSMZ[bf23]*(-\/MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_ydCdotdD +MNKLdAcrossdB\_xdCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{1972         }
\DoxyCodeLine{1973               \textcolor{comment}{/* Equation 73 in the paper */}}
\DoxyCodeLine{1974               ADXSSMY[bf14] += }
\DoxyCodeLine{1975                 DXSSMY[bf23]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_y -\/MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{1976                +DXSSMS[bf23]*(-\/MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_ydCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{1977                +DXSSMX[bf23]*(-\/MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_zdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{1978                +DXSSMZ[bf23]*( MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_xdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{1979     }
\DoxyCodeLine{1980             \}}
\DoxyCodeLine{1981   }
\DoxyCodeLine{1982             \textcolor{comment}{//MNLK}}
\DoxyCodeLine{1983             \textcolor{keywordflow}{if}(bf3\_s!=bf4\_s and bf1 >= bf3) \{}
\DoxyCodeLine{1984   }
\DoxyCodeLine{1985               ADXSSMS[bf13] +=}
\DoxyCodeLine{1986                   DXSSMS[bf24]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_y -\/MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{1987                +( DXSSMX[bf24]*(-\/MNKLdAcrossdB\_xdCdotdD +MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{1988                  +DXSSMY[bf24]*(-\/MNKLdAcrossdB\_ydCdotdD +MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_zdCcrossdD\_x -\/MNKLdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{1989                  +DXSSMZ[bf24]*(-\/MNKLdAcrossdB\_zdCdotdD +MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{1990    }
\DoxyCodeLine{1991               ADXSSMZ[bf13] +=}
\DoxyCodeLine{1992                 DXSSMZ[bf24]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_zdCcrossdD\_z +MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{1993                +DXSSMS[bf24]*( MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_zdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{1994                +DXSSMY[bf24]*( MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_xdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{1995                +DXSSMX[bf24]*(-\/MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_ydCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{1996           }
\DoxyCodeLine{1997               ADXSSMX[bf13] += }
\DoxyCodeLine{1998                 DXSSMX[bf24]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_y +MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{1999                +DXSSMS[bf24]*( MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_xdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{2000                +DXSSMY[bf24]*(-\/MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_zdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2001                +DXSSMZ[bf24]*( MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_ydCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2002         }
\DoxyCodeLine{2003               ADXSSMY[bf13] += }
\DoxyCodeLine{2004                 DXSSMY[bf24]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_y +MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2005                +DXSSMS[bf24]*( MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_ydCdotdD +MNKLdAcrossdB\_xdCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{2006                +DXSSMX[bf24]*( MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_zdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2007                +DXSSMZ[bf24]*(-\/MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_xdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{2008   }
\DoxyCodeLine{2009             \}}
\DoxyCodeLine{2010   }
\DoxyCodeLine{2011   }
\DoxyCodeLine{2012   }
\DoxyCodeLine{2013             \textcolor{comment}{//NMKL}}
\DoxyCodeLine{2014             \textcolor{keywordflow}{if}(bf1\_s!=bf2\_s)\{}
\DoxyCodeLine{2015               }
\DoxyCodeLine{2016               \textcolor{keywordflow}{if}(bf2 >= bf4) \{}
\DoxyCodeLine{2017   }
\DoxyCodeLine{2018                 ADXSSMS[bf24] +=}
\DoxyCodeLine{2019                     DXSSMS[bf13]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_y -\/MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2020                  +( DXSSMX[bf13]*( MNKLdAcrossdB\_xdCdotdD -\/MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2021                    +DXSSMY[bf13]*( MNKLdAcrossdB\_ydCdotdD -\/MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_zdCcrossdD\_x -\/MNKLdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{2022                    +DXSSMZ[bf13]*( MNKLdAcrossdB\_zdCdotdD -\/MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{2023     }
\DoxyCodeLine{2024                 ADXSSMZ[bf24] +=}
\DoxyCodeLine{2025                   DXSSMZ[bf13]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_zdCcrossdD\_z +MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{2026                  +DXSSMS[bf13]*(-\/MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_zdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{2027                  +DXSSMY[bf13]*(-\/MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_xdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2028                  +DXSSMX[bf13]*( MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_ydCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2029             }
\DoxyCodeLine{2030                 ADXSSMX[bf24] += }
\DoxyCodeLine{2031                   DXSSMX[bf13]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_y +MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2032                  +DXSSMS[bf13]*(-\/MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_xdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{2033                  +DXSSMY[bf13]*( MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_zdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2034                  +DXSSMZ[bf13]*(-\/MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_ydCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2035           }
\DoxyCodeLine{2036                 ADXSSMY[bf24] += }
\DoxyCodeLine{2037                   DXSSMY[bf13]*(-\/MNKLdAdotdBdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_y +MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2038                  +DXSSMS[bf13]*(-\/MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_ydCdotdD +MNKLdAcrossdB\_xdCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{2039                  +DXSSMX[bf13]*(-\/MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_zdCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2040                  +DXSSMZ[bf13]*( MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_xdCdotdD -\/MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{2041   }
\DoxyCodeLine{2042               \}}
\DoxyCodeLine{2043     }
\DoxyCodeLine{2044   }
\DoxyCodeLine{2045               \textcolor{keywordflow}{if}(bf3\_s!=bf4\_s and bf2 >= bf3) \{}
\DoxyCodeLine{2046   }
\DoxyCodeLine{2047                 ADXSSMS[bf23] +=}
\DoxyCodeLine{2048                     DXSSMS[bf14]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_x +MNKLdAcrossdB\_ydCcrossdD\_y +MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2049                  +( DXSSMX[bf14]*( MNKLdAcrossdB\_xdCdotdD +MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2050                    +DXSSMY[bf14]*( MNKLdAcrossdB\_ydCdotdD +MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_zdCcrossdD\_x +MNKLdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{2051                    +DXSSMZ[bf14]*( MNKLdAcrossdB\_zdCdotdD +MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{2052   }
\DoxyCodeLine{2053                 ADXSSMZ[bf23] +=}
\DoxyCodeLine{2054                   DXSSMZ[bf14]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_zdCcrossdD\_z -\/MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{2055                  +DXSSMS[bf14]*( MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_zdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_y -\/MNKLdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{2056                  +DXSSMY[bf14]*( MNKLdAdotdBdCcrossdD\_x -\/MNKLdAcrossdB\_xdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2057                  +DXSSMX[bf14]*(-\/MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_ydCdotdD +MNKLdAcrossdB\_xdCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2058             }
\DoxyCodeLine{2059                 ADXSSMX[bf23] += }
\DoxyCodeLine{2060                   DXSSMX[bf14]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_ydCcrossdD\_y -\/MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2061                  +DXSSMS[bf14]*( MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_xdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_z -\/MNKLdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{2062                  +DXSSMY[bf14]*(-\/MNKLdAdotdBdCcrossdD\_z +MNKLdAcrossdB\_zdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2063                  +DXSSMZ[bf14]*( MNKLdAdotdBdCcrossdD\_y -\/MNKLdAcrossdB\_ydCdotdD +MNKLdAcrossdB\_xdCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2064           }
\DoxyCodeLine{2065                 ADXSSMY[bf23] += }
\DoxyCodeLine{2066                   DXSSMY[bf14]*(-\/MNKLdAdotdBdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_y -\/MNKLdAcrossdB\_xdCcrossdD\_x -\/MNKLdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2067                  +DXSSMS[bf14]*( MNKLdAdotdBdCcrossdD\_y +MNKLdAcrossdB\_ydCdotdD -\/MNKLdAcrossdB\_xdCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{2068                  +DXSSMX[bf14]*( MNKLdAdotdBdCcrossdD\_z -\/MNKLdAcrossdB\_zdCdotdD +MNKLdAcrossdB\_xdCcrossdD\_y +MNKLdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2069                  +DXSSMZ[bf14]*(-\/MNKLdAdotdBdCcrossdD\_x +MNKLdAcrossdB\_xdCdotdD +MNKLdAcrossdB\_ydCcrossdD\_z +MNKLdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{2070   }
\DoxyCodeLine{2071       }
\DoxyCodeLine{2072               \}}
\DoxyCodeLine{2073             \}}
\DoxyCodeLine{2074   }
\DoxyCodeLine{2075   }
\DoxyCodeLine{2076   }
\DoxyCodeLine{2077   }
\DoxyCodeLine{2078             \textcolor{keywordflow}{if}(bf1\_s!=bf3\_s or bf2\_s!=bf4\_s)\{}
\DoxyCodeLine{2079  }
\DoxyCodeLine{2080               \textcolor{keywordflow}{if}(bf3 >= bf2 ) \{}
\DoxyCodeLine{2081   }
\DoxyCodeLine{2082                 ADXSSMS[bf32] +=}
\DoxyCodeLine{2083                     DXSSMS[bf41]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_y +KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2084                  +( DXSSMX[bf41]*(-\/KLMNdAcrossdB\_xdCdotdD -\/KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2085                    +DXSSMY[bf41]*(-\/KLMNdAcrossdB\_ydCdotdD -\/KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_zdCcrossdD\_x +KLMNdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{2086                    +DXSSMZ[bf41]*(-\/KLMNdAcrossdB\_zdCdotdD -\/KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{2087     }
\DoxyCodeLine{2088                 ADXSSMZ[bf32] +=}
\DoxyCodeLine{2089                   DXSSMZ[bf41]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_zdCcrossdD\_z -\/KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{2090                  +DXSSMS[bf41]*(-\/KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_zdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{2091                  +DXSSMY[bf41]*(-\/KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_xdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2092                  +DXSSMX[bf41]*( KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_ydCdotdD +KLMNdAcrossdB\_xdCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2093             }
\DoxyCodeLine{2094                 ADXSSMX[bf32] += }
\DoxyCodeLine{2095                   DXSSMX[bf41]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_y -\/KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2096                  +DXSSMS[bf41]*(-\/KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_xdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{2097                  +DXSSMY[bf41]*( KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_zdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2098                  +DXSSMZ[bf41]*(-\/KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_ydCdotdD +KLMNdAcrossdB\_xdCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2099           }
\DoxyCodeLine{2100                 ADXSSMY[bf32] += }
\DoxyCodeLine{2101                   DXSSMY[bf41]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_y -\/KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2102                  +DXSSMS[bf41]*(-\/KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_ydCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{2103                  +DXSSMX[bf41]*(-\/KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_zdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2104                  +DXSSMZ[bf41]*( KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_xdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{2105   }
\DoxyCodeLine{2106               \}}
\DoxyCodeLine{2107    }
\DoxyCodeLine{2108               }
\DoxyCodeLine{2109               \textcolor{keywordflow}{if}(bf1\_s!=bf2\_s and bf3>=bf1) \{}
\DoxyCodeLine{2110   }
\DoxyCodeLine{2111                 ADXSSMS[bf31] +=}
\DoxyCodeLine{2112                     DXSSMS[bf42]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_y -\/KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2113                  +( DXSSMX[bf42]*(-\/KLMNdAcrossdB\_xdCdotdD +KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2114                    +DXSSMY[bf42]*(-\/KLMNdAcrossdB\_ydCdotdD +KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_zdCcrossdD\_x -\/KLMNdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{2115                    +DXSSMZ[bf42]*(-\/KLMNdAcrossdB\_zdCdotdD +KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{2116      }
\DoxyCodeLine{2117                 ADXSSMZ[bf31] +=}
\DoxyCodeLine{2118                   DXSSMZ[bf42]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_zdCcrossdD\_z +KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{2119                  +DXSSMS[bf42]*( KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_zdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{2120                  +DXSSMY[bf42]*( KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_xdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2121                  +DXSSMX[bf42]*(-\/KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_ydCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2122             }
\DoxyCodeLine{2123                 ADXSSMX[bf31] += }
\DoxyCodeLine{2124                   DXSSMX[bf42]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_y +KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2125                  +DXSSMS[bf42]*( KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_xdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{2126                  +DXSSMY[bf42]*(-\/KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_zdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2127                  +DXSSMZ[bf42]*( KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_ydCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2128           }
\DoxyCodeLine{2129                 ADXSSMY[bf31] += }
\DoxyCodeLine{2130                   DXSSMY[bf42]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_y +KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2131                  +DXSSMS[bf42]*( KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_ydCdotdD +KLMNdAcrossdB\_xdCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{2132                  +DXSSMX[bf42]*( KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_zdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2133                  +DXSSMZ[bf42]*(-\/KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_xdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{2134      }
\DoxyCodeLine{2135      }
\DoxyCodeLine{2136               \}}
\DoxyCodeLine{2137     }
\DoxyCodeLine{2138               \textcolor{comment}{//NMKL}}
\DoxyCodeLine{2139               \textcolor{keywordflow}{if}(bf3\_s!=bf4\_s and bf4>=bf2)\{}
\DoxyCodeLine{2140     }
\DoxyCodeLine{2141                 ADXSSMS[bf42] +=}
\DoxyCodeLine{2142                     DXSSMS[bf31]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_y -\/KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2143                  +( DXSSMX[bf31]*( KLMNdAcrossdB\_xdCdotdD -\/KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2144                    +DXSSMY[bf31]*( KLMNdAcrossdB\_ydCdotdD -\/KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_zdCcrossdD\_x -\/KLMNdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{2145                    +DXSSMZ[bf31]*( KLMNdAcrossdB\_zdCdotdD -\/KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{2146      }
\DoxyCodeLine{2147                 ADXSSMZ[bf42] +=}
\DoxyCodeLine{2148                   DXSSMZ[bf31]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_zdCcrossdD\_z +KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{2149                  +DXSSMS[bf31]*(-\/KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_zdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{2150                  +DXSSMY[bf31]*(-\/KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_xdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2151                  +DXSSMX[bf31]*( KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_ydCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2152             }
\DoxyCodeLine{2153                 ADXSSMX[bf42] += }
\DoxyCodeLine{2154                   DXSSMX[bf31]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_y +KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2155                  +DXSSMS[bf31]*(-\/KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_xdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{2156                  +DXSSMY[bf31]*( KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_zdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2157                  +DXSSMZ[bf31]*(-\/KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_ydCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2158           }
\DoxyCodeLine{2159                 ADXSSMY[bf42] += }
\DoxyCodeLine{2160                   DXSSMY[bf31]*(-\/KLMNdAdotdBdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_y +KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2161                  +DXSSMS[bf31]*(-\/KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_ydCdotdD +KLMNdAcrossdB\_xdCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{2162                  +DXSSMX[bf31]*(-\/KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_zdCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2163                  +DXSSMZ[bf31]*( KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_xdCdotdD -\/KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{2164      }
\DoxyCodeLine{2165       }
\DoxyCodeLine{2166     }
\DoxyCodeLine{2167                 \textcolor{keywordflow}{if}(bf1\_s!=bf2\_s and bf4>=bf1) \{}
\DoxyCodeLine{2168     }
\DoxyCodeLine{2169                   ADXSSMS[bf41] +=}
\DoxyCodeLine{2170                       DXSSMS[bf32]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_x +KLMNdAcrossdB\_ydCcrossdD\_y +KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2171                    +( DXSSMX[bf32]*( KLMNdAcrossdB\_xdCdotdD +KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2172                      +DXSSMY[bf32]*( KLMNdAcrossdB\_ydCdotdD +KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_zdCcrossdD\_x +KLMNdAcrossdB\_xdCcrossdD\_z)}
\DoxyCodeLine{2173                      +DXSSMZ[bf32]*( KLMNdAcrossdB\_zdCdotdD +KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x))*iscale;}
\DoxyCodeLine{2174   }
\DoxyCodeLine{2175                   ADXSSMZ[bf41] +=}
\DoxyCodeLine{2176                     DXSSMZ[bf32]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_zdCcrossdD\_z -\/KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_y)}
\DoxyCodeLine{2177                    +DXSSMS[bf32]*( KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_zdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_y -\/KLMNdAcrossdB\_ydCcrossdD\_x)*iscale}
\DoxyCodeLine{2178                    +DXSSMY[bf32]*( KLMNdAdotdBdCcrossdD\_x -\/KLMNdAcrossdB\_xdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y)}
\DoxyCodeLine{2179                    +DXSSMX[bf32]*(-\/KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_ydCdotdD +KLMNdAcrossdB\_xdCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2180               }
\DoxyCodeLine{2181                   ADXSSMX[bf41] += }
\DoxyCodeLine{2182                     DXSSMX[bf32]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_ydCcrossdD\_y -\/KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2183                    +DXSSMS[bf32]*( KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_xdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_z -\/KLMNdAcrossdB\_zdCcrossdD\_y)*iscale}
\DoxyCodeLine{2184                    +DXSSMY[bf32]*(-\/KLMNdAdotdBdCcrossdD\_z +KLMNdAcrossdB\_zdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2185                    +DXSSMZ[bf32]*( KLMNdAdotdBdCcrossdD\_y -\/KLMNdAcrossdB\_ydCdotdD +KLMNdAcrossdB\_xdCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_x);}
\DoxyCodeLine{2186             }
\DoxyCodeLine{2187                   ADXSSMY[bf41] += }
\DoxyCodeLine{2188                     DXSSMY[bf32]*(-\/KLMNdAdotdBdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_y -\/KLMNdAcrossdB\_xdCcrossdD\_x -\/KLMNdAcrossdB\_zdCcrossdD\_z)}
\DoxyCodeLine{2189                    +DXSSMS[bf32]*( KLMNdAdotdBdCcrossdD\_y +KLMNdAcrossdB\_ydCdotdD -\/KLMNdAcrossdB\_xdCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_x)*iscale}
\DoxyCodeLine{2190                    +DXSSMX[bf32]*( KLMNdAdotdBdCcrossdD\_z -\/KLMNdAcrossdB\_zdCdotdD +KLMNdAcrossdB\_xdCcrossdD\_y +KLMNdAcrossdB\_ydCcrossdD\_x)}
\DoxyCodeLine{2191                    +DXSSMZ[bf32]*(-\/KLMNdAdotdBdCcrossdD\_x +KLMNdAcrossdB\_xdCdotdD +KLMNdAcrossdB\_ydCcrossdD\_z +KLMNdAcrossdB\_zdCcrossdD\_y);}
\DoxyCodeLine{2192         }
\DoxyCodeLine{2193                 \}}
\DoxyCodeLine{2194               \}}
\DoxyCodeLine{2195  }
\DoxyCodeLine{2196             \}}
\DoxyCodeLine{2197 \textcolor{preprocessor}{\#endif  }}
\DoxyCodeLine{2198           \}}
\DoxyCodeLine{2199           \}}
\DoxyCodeLine{2200           \}}
\DoxyCodeLine{2201           \} \textcolor{comment}{// contraction loop}}
\DoxyCodeLine{2202   }
\DoxyCodeLine{2203 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{2204   }
\DoxyCodeLine{2205   }
\DoxyCodeLine{2206       \}; \textcolor{comment}{// loop s4}}
\DoxyCodeLine{2207       \}; \textcolor{comment}{// loop s3}}
\DoxyCodeLine{2208       \}; \textcolor{comment}{// loop s2}}
\DoxyCodeLine{2209       \}; \textcolor{comment}{// loop s1}}
\DoxyCodeLine{2210   }
\DoxyCodeLine{2211   }
\DoxyCodeLine{2212       \}; \textcolor{comment}{// OpenMP context}}
\DoxyCodeLine{2213   }
\DoxyCodeLine{2214   }
\DoxyCodeLine{2215       \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}} iscale = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{2216       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iTh  = 0; iTh < nThreads; iTh++) \{}
\DoxyCodeLine{2217    }
\DoxyCodeLine{2218         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CSSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{2219            matList[CSSMS].AX,nBasis,matList[CSSMS].AX,nBasis);}
\DoxyCodeLine{2220 }
\DoxyCodeLine{2221         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CSSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{2222            matList[CSSMX].AX,nBasis,matList[CSSMX].AX,nBasis);}
\DoxyCodeLine{2223 }
\DoxyCodeLine{2224         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CSSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{2225            matList[CSSMY].AX,nBasis,matList[CSSMY].AX,nBasis);}
\DoxyCodeLine{2226 }
\DoxyCodeLine{2227         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CSSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{2228            matList[CSSMZ].AX,nBasis,matList[CSSMZ].AX,nBasis);}
\DoxyCodeLine{2229  }
\DoxyCodeLine{2230         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{2231            matList[XSSMS].AX,nBasis,matList[XSSMS].AX,nBasis);}
\DoxyCodeLine{2232 }
\DoxyCodeLine{2233         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{2234            matList[XSSMX].AX,nBasis,matList[XSSMX].AX,nBasis);}
\DoxyCodeLine{2235 }
\DoxyCodeLine{2236         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{2237            matList[XSSMY].AX,nBasis,matList[XSSMY].AX,nBasis);}
\DoxyCodeLine{2238 }
\DoxyCodeLine{2239         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{2240            matList[XSSMZ].AX,nBasis,matList[XSSMZ].AX,nBasis);}
\DoxyCodeLine{2241   }
\DoxyCodeLine{2242       \};}
\DoxyCodeLine{2243       }
\DoxyCodeLine{2244 \textcolor{preprocessor}{\#if 1}}
\DoxyCodeLine{2245       \textcolor{comment}{// Take care of the Hermitian symmetry in the LL and SS blocks}}
\DoxyCodeLine{2246       \textcolor{keyword}{auto} ADCSSMS = matList[CSSMS].AX;}
\DoxyCodeLine{2247       \textcolor{keyword}{auto} ADCSSMX = matList[CSSMX].AX;}
\DoxyCodeLine{2248       \textcolor{keyword}{auto} ADCSSMY = matList[CSSMY].AX;}
\DoxyCodeLine{2249       \textcolor{keyword}{auto} ADCSSMZ = matList[CSSMZ].AX;}
\DoxyCodeLine{2250       \textcolor{keyword}{auto} ADXSSMS = matList[XSSMS].AX;}
\DoxyCodeLine{2251       \textcolor{keyword}{auto} ADXSSMX = matList[XSSMX].AX;}
\DoxyCodeLine{2252       \textcolor{keyword}{auto} ADXSSMY = matList[XSSMY].AX;}
\DoxyCodeLine{2253       \textcolor{keyword}{auto} ADXSSMZ = matList[XSSMZ].AX;}
\DoxyCodeLine{2254 }
\DoxyCodeLine{2255       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} i = 0; i < nBasis; i++ )}
\DoxyCodeLine{2256       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} j = 0; j < i; j++ ) \{}
\DoxyCodeLine{2257         ADCSSMS[j + i*nBasis] = std::conj(ADCSSMS[i + j*nBasis]);}
\DoxyCodeLine{2258         ADCSSMX[j + i*nBasis] = std::conj(ADCSSMX[i + j*nBasis]);}
\DoxyCodeLine{2259         ADCSSMY[j + i*nBasis] = std::conj(ADCSSMY[i + j*nBasis]);}
\DoxyCodeLine{2260         ADCSSMZ[j + i*nBasis] = std::conj(ADCSSMZ[i + j*nBasis]);}
\DoxyCodeLine{2261         ADXSSMS[j + i*nBasis] = std::conj(ADXSSMS[i + j*nBasis]);}
\DoxyCodeLine{2262         ADXSSMX[j + i*nBasis] = std::conj(ADXSSMX[i + j*nBasis]);}
\DoxyCodeLine{2263         ADXSSMY[j + i*nBasis] = std::conj(ADXSSMY[i + j*nBasis]);}
\DoxyCodeLine{2264         ADXSSMZ[j + i*nBasis] = std::conj(ADXSSMZ[i + j*nBasis]);}
\DoxyCodeLine{2265       \}}
\DoxyCodeLine{2266 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2267 }
\DoxyCodeLine{2268 }
\DoxyCodeLine{2269       memManager\_.free(ERIBuffer);}
\DoxyCodeLine{2270       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{2271 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{2272       \textcolor{keywordflow}{if}(ShBlkNorms\_raw!=\textcolor{keyword}{nullptr}) memManager\_.free(ShBlkNorms\_raw);}
\DoxyCodeLine{2273 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2274 }
\DoxyCodeLine{2275 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{2276       \textcolor{keywordtype}{size\_t} nIntSkipSSSS = std::accumulate(nSkipSSSS.begin(),nSkipSSSS.end(),0);}
\DoxyCodeLine{2277       std::cout << \textcolor{stringliteral}{"{}Dirac-\/Coulomb-\/SSSS Screened "{}} << nIntSkipSSSS << std::endl;}
\DoxyCodeLine{2278   }
\DoxyCodeLine{2279       \textcolor{keyword}{auto} durDirectSSSS = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topDirectSSSS);}
\DoxyCodeLine{2280       std::cout << \textcolor{stringliteral}{"{}Dirac-\/Coulomb-\/SSSS AO Direct Contraction took "{}} <<  durDirectSSSS << \textcolor{stringliteral}{"{} s\(\backslash\)n"{}}; }
\DoxyCodeLine{2281   }
\DoxyCodeLine{2282       std::cout << std::endl;}
\DoxyCodeLine{2283 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2284   }
\DoxyCodeLine{2285     \} \textcolor{comment}{// if(SSSS)}}
\DoxyCodeLine{2286 }
\DoxyCodeLine{2287 \textcolor{comment}{    /*************************************/}}
\DoxyCodeLine{2288     \textcolor{comment}{/*                                   */}}
\DoxyCodeLine{2289     \textcolor{comment}{/* End of Dirac-\/Coulomb C(4)-\/SSSS    */}}
\DoxyCodeLine{2290     \textcolor{comment}{/*                                   */}}
\DoxyCodeLine{2291 \textcolor{comment}{    /*************************************/}}
\DoxyCodeLine{2292 }
\DoxyCodeLine{2293 }
\DoxyCodeLine{2294 }
\DoxyCodeLine{2295 }
\DoxyCodeLine{2296 }
\DoxyCodeLine{2297 }
\DoxyCodeLine{2298 }
\DoxyCodeLine{2299 }
\DoxyCodeLine{2300 }
\DoxyCodeLine{2301 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{2302     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{2303     \textcolor{comment}{/* Start of Gaunt  */}}
\DoxyCodeLine{2304     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{2305 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{2306 }
\DoxyCodeLine{2307     \textcolor{keywordflow}{if}( matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba619fb0d8a58386d6c365eb7fa1bae867}{TWOBODY\_CONTRACTION\_TYPE::GAUNT}} ) \{}
\DoxyCodeLine{2308 }
\DoxyCodeLine{2309       \textcolor{keyword}{enum} Gaunt\_2ND\_DERIV\_AC \{}
\DoxyCodeLine{2310         AxCx,}
\DoxyCodeLine{2311         AxCy,}
\DoxyCodeLine{2312         AxCz,}
\DoxyCodeLine{2313         AyCx,}
\DoxyCodeLine{2314         AyCy,}
\DoxyCodeLine{2315         AyCz,}
\DoxyCodeLine{2316         AzCx,}
\DoxyCodeLine{2317         AzCy,}
\DoxyCodeLine{2318         AzCz}
\DoxyCodeLine{2319       \};}
\DoxyCodeLine{2320   }
\DoxyCodeLine{2321       \textcolor{keyword}{enum} Gaunt\_2ND\_DERIV\_BC \{}
\DoxyCodeLine{2322         BxCx,}
\DoxyCodeLine{2323         BxCy,}
\DoxyCodeLine{2324         BxCz,}
\DoxyCodeLine{2325         ByCx,}
\DoxyCodeLine{2326         ByCy,}
\DoxyCodeLine{2327         ByCz,}
\DoxyCodeLine{2328         BzCx,}
\DoxyCodeLine{2329         BzCy,}
\DoxyCodeLine{2330         BzCz}
\DoxyCodeLine{2331       \};}
\DoxyCodeLine{2332   }
\DoxyCodeLine{2333       \textcolor{keyword}{auto} NB4\_4  = 4*NB4;  }
\DoxyCodeLine{2334       \textcolor{keyword}{auto} NB4\_5  = 5*NB4;  }
\DoxyCodeLine{2335       \textcolor{keyword}{auto} NB4\_6  = 6*NB4;  }
\DoxyCodeLine{2336       \textcolor{keyword}{auto} NB4\_7  = 7*NB4;  }
\DoxyCodeLine{2337       \textcolor{keyword}{auto} NB4\_8  = 8*NB4;  }
\DoxyCodeLine{2338       \textcolor{keyword}{auto} NB4\_9  = 9*NB4;  }
\DoxyCodeLine{2339       \textcolor{keyword}{auto} NB4\_10 =10*NB4;  }
\DoxyCodeLine{2340       \textcolor{keyword}{auto} NB4\_11 =11*NB4;  }
\DoxyCodeLine{2341       \textcolor{keyword}{auto} NB4\_12 =12*NB4;  }
\DoxyCodeLine{2342       \textcolor{keyword}{auto} NB4\_13 =13*NB4;  }
\DoxyCodeLine{2343       \textcolor{keyword}{auto} NB4\_14 =14*NB4;  }
\DoxyCodeLine{2344       \textcolor{keyword}{auto} NB4\_15 =15*NB4;  }
\DoxyCodeLine{2345       \textcolor{keyword}{auto} NB4\_16 =16*NB4;  }
\DoxyCodeLine{2346       \textcolor{keyword}{auto} NB4\_17 =17*NB4;  }
\DoxyCodeLine{2347       \textcolor{keyword}{auto} NB4\_18 =18*NB4;  }
\DoxyCodeLine{2348    }
\DoxyCodeLine{2349 }
\DoxyCodeLine{2350 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{2351       \textcolor{keyword}{auto} topDirectGaunt = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{2352 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2353 }
\DoxyCodeLine{2354       nERI = 9;}
\DoxyCodeLine{2355       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(nERI*buffN4*nThreads);}
\DoxyCodeLine{2356       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{2357 }
\DoxyCodeLine{2358 }
\DoxyCodeLine{2359 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{2360   }
\DoxyCodeLine{2361       \textcolor{keywordtype}{double} *SchwarzGaunt = memManager\_.malloc<\textcolor{keywordtype}{double}>(nShell*nShell);}
\DoxyCodeLine{2362       memset(SchwarzGaunt,0,nShell*nShell*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{2363   }
\DoxyCodeLine{2364 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{2365       \{}
\DoxyCodeLine{2366   }
\DoxyCodeLine{2367         \textcolor{keywordtype}{double} C1 = 1./(2*\mbox{\hyperlink{namespaceChronusQ_a387c8ccd4e18ad322b87f75f51fd008d}{SpeedOfLight}});}
\DoxyCodeLine{2368         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{2369         \textcolor{keywordtype}{size\_t} n1,n2;}
\DoxyCodeLine{2370   }
\DoxyCodeLine{2371         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{2372         \textcolor{keywordtype}{double} *buff = \&buffAll[nERI*buffN4*thread\_id];}
\DoxyCodeLine{2373         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{2374   }
\DoxyCodeLine{2375         \textcolor{comment}{// set up Schwarz screening}}
\DoxyCodeLine{2376         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s12(0); s1 < nShell; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{2377   }
\DoxyCodeLine{2378           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{2379   }
\DoxyCodeLine{2380         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 < nShell; bf2\_s+=n2, s2++, s12++) \{}
\DoxyCodeLine{2381   }
\DoxyCodeLine{2382           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{2383   }
\DoxyCodeLine{2384           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{2385 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{2386           \textcolor{keywordflow}{if}( s12 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2387 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{2388   }
\DoxyCodeLine{2389           shls[0] = int(s1);}
\DoxyCodeLine{2390           shls[1] = int(s2);}
\DoxyCodeLine{2391           shls[2] = int(s1);}
\DoxyCodeLine{2392           shls[3] = int(s2);}
\DoxyCodeLine{2393   }
\DoxyCodeLine{2394           \textcolor{keyword}{auto} nQuad = n1*n2*n1*n2;}
\DoxyCodeLine{2395   }
\DoxyCodeLine{2396           \textcolor{keywordflow}{if}(int2e\_ip1ip2\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2397 }
\DoxyCodeLine{2398           \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} iERI(0); iERI < nERI*nQuad; iERI++) }
\DoxyCodeLine{2399               SchwarzGaunt[s1+s2*nShell] = std::max(SchwarzGaunt[s1+s2*nShell], std::abs(buff[iERI]));}
\DoxyCodeLine{2400   }
\DoxyCodeLine{2401           SchwarzGaunt[s1+s2*nShell] = C1*std::sqrt(SchwarzGaunt[s1+s2*nShell]);}
\DoxyCodeLine{2402   }
\DoxyCodeLine{2403         \}}
\DoxyCodeLine{2404         \}}
\DoxyCodeLine{2405   }
\DoxyCodeLine{2406       \};}
\DoxyCodeLine{2407 }
\DoxyCodeLine{2408   }
\DoxyCodeLine{2409 }
\DoxyCodeLine{2410       \textcolor{comment}{// Compute shell block norms (∞-\/norm) of matList.X}}
\DoxyCodeLine{2411       \textcolor{keywordtype}{int} mMat = 16;}
\DoxyCodeLine{2412       \textcolor{keywordtype}{double} *ShBlkNorms\_raw = memManager\_.malloc<\textcolor{keywordtype}{double}>(mMat*nShell*nShell);}
\DoxyCodeLine{2413       std::vector<double*> ShBlkNorms;}
\DoxyCodeLine{2414   }
\DoxyCodeLine{2415       \textcolor{keyword}{auto} iOff = 0;}
\DoxyCodeLine{2416       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2417       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2418   }
\DoxyCodeLine{2419       iOff += nShell*nShell;}
\DoxyCodeLine{2420       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2421       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2422   }
\DoxyCodeLine{2423       iOff += nShell*nShell;}
\DoxyCodeLine{2424       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2425       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2426   }
\DoxyCodeLine{2427       iOff += nShell*nShell;}
\DoxyCodeLine{2428       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2429       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2430 }
\DoxyCodeLine{2431       iOff += nShell*nShell;}
\DoxyCodeLine{2432       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2433       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2434   }
\DoxyCodeLine{2435       iOff += nShell*nShell;}
\DoxyCodeLine{2436       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2437       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2438   }
\DoxyCodeLine{2439       iOff += nShell*nShell;}
\DoxyCodeLine{2440       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2441       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2442   }
\DoxyCodeLine{2443       iOff += nShell*nShell;}
\DoxyCodeLine{2444       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2445       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2446 }
\DoxyCodeLine{2447       iOff += nShell*nShell;}
\DoxyCodeLine{2448       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2449       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2450   }
\DoxyCodeLine{2451       iOff += nShell*nShell;}
\DoxyCodeLine{2452       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2453       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2454   }
\DoxyCodeLine{2455       iOff += nShell*nShell;}
\DoxyCodeLine{2456       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2457       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2458   }
\DoxyCodeLine{2459       iOff += nShell*nShell;}
\DoxyCodeLine{2460       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2461       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2462  }
\DoxyCodeLine{2463       iOff += nShell*nShell;}
\DoxyCodeLine{2464       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2465       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2466   }
\DoxyCodeLine{2467       iOff += nShell*nShell;}
\DoxyCodeLine{2468       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2469       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2470   }
\DoxyCodeLine{2471       iOff += nShell*nShell;}
\DoxyCodeLine{2472       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2473       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2474   }
\DoxyCodeLine{2475       iOff += nShell*nShell;}
\DoxyCodeLine{2476       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2477       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{2478   }
\DoxyCodeLine{2479       \textcolor{comment}{// Get the max over all the matricies for the shell block ∞-\/norms}}
\DoxyCodeLine{2480       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} k = 0; k < nShell*nShell; k++) \{}
\DoxyCodeLine{2481   }
\DoxyCodeLine{2482         \textcolor{keywordtype}{double} mx = std::abs(ShBlkNorms[0][k]);}
\DoxyCodeLine{2483         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < mMat; iMat++)}
\DoxyCodeLine{2484           mx = std::max(mx,std::abs(ShBlkNorms[iMat][k]));}
\DoxyCodeLine{2485         ShBlkNorms[0][k] = mx;}
\DoxyCodeLine{2486    }
\DoxyCodeLine{2487       \}}
\DoxyCodeLine{2488 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2489 }
\DoxyCodeLine{2490       \textcolor{keywordtype}{int} nSave = 19;}
\DoxyCodeLine{2491       ERIBuffer = memManager\_.malloc<\textcolor{keywordtype}{double}>(nSave*NB4*nThreads);}
\DoxyCodeLine{2492       memset(AXRaw,0,nThreads*nMat*nBasis*nBasis*\textcolor{keyword}{sizeof}(MatsT));}
\DoxyCodeLine{2493       std::vector<size\_t> nSkipGaunt(nThreads,0);}
\DoxyCodeLine{2494   }
\DoxyCodeLine{2495 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{2496       \{}
\DoxyCodeLine{2497   }
\DoxyCodeLine{2498         \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}} iS = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{2499   }
\DoxyCodeLine{2500         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{2501   }
\DoxyCodeLine{2502         \textcolor{keyword}{auto} \&AX\_loc = AXthreads[thread\_id];}
\DoxyCodeLine{2503   }
\DoxyCodeLine{2504         \textcolor{keywordtype}{double} *BC   = \&ERIBuffer[thread\_id*nSave*NB4];}
\DoxyCodeLine{2505   }
\DoxyCodeLine{2506         \textcolor{keywordtype}{size\_t} n1,n2,n3,n4,m,n,k,l,mnkl,bf1,bf2,bf3,bf4;}
\DoxyCodeLine{2507         \textcolor{keywordtype}{size\_t} s4\_max;}
\DoxyCodeLine{2508   }
\DoxyCodeLine{2509         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{2510         \textcolor{keywordtype}{double} *buff = \&buffAll[nERI*buffN4*thread\_id];}
\DoxyCodeLine{2511         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{2512   }
\DoxyCodeLine{2513         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s1234(0); s1 < nShell; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{2514   }
\DoxyCodeLine{2515           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{2516   }
\DoxyCodeLine{2517         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 < nShell; bf2\_s+=n2, s2++) \{}
\DoxyCodeLine{2518   }
\DoxyCodeLine{2519           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{2520   }
\DoxyCodeLine{2521 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{2522           \textcolor{keywordtype}{double} shMax12 = ShBlkNorms[0][s2 + s1*nShell];}
\DoxyCodeLine{2523 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2524   }
\DoxyCodeLine{2525         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s3(0), bf3\_s(0); s3 <= s2 ; bf3\_s+=n3, s3++) \{}
\DoxyCodeLine{2526   }
\DoxyCodeLine{2527           n3 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s3].size(); \textcolor{comment}{// Size of Shell 3}}
\DoxyCodeLine{2528           s4\_max = (s2 == s3) ? s1 : nShell-\/1; \textcolor{comment}{// Determine the unique max of Shell 4}}
\DoxyCodeLine{2529   }
\DoxyCodeLine{2530 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{2531           \textcolor{keywordtype}{double} shMax123 = std::max(ShBlkNorms[0][s1 + s3*nShell], ShBlkNorms[0][s2 + s3*nShell]);}
\DoxyCodeLine{2532           shMax123 = std::max(shMax123,shMax12);}
\DoxyCodeLine{2533 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2534    }
\DoxyCodeLine{2535   }
\DoxyCodeLine{2536         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s4(0), bf4\_s(0); s4 <= s4\_max; bf4\_s+=n4, s4++, s1234++) \{}
\DoxyCodeLine{2537   }
\DoxyCodeLine{2538           n4 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s4].size(); \textcolor{comment}{// Size of Shell 4}}
\DoxyCodeLine{2539   }
\DoxyCodeLine{2540           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{2541 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{2542           \textcolor{keywordflow}{if}( s1234 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2543 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{2544   }
\DoxyCodeLine{2545 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{2546   }
\DoxyCodeLine{2547           \textcolor{keywordtype}{double} shMax = std::max(ShBlkNorms[0][s1 + s4*nShell],}
\DoxyCodeLine{2548                                   std::max(ShBlkNorms[0][s2 + s4*nShell],}
\DoxyCodeLine{2549                                            ShBlkNorms[0][s3 + s4*nShell]));}
\DoxyCodeLine{2550   }
\DoxyCodeLine{2551           shMax = std::max(shMax,shMax123);}
\DoxyCodeLine{2552 }
\DoxyCodeLine{2553           \textcolor{keywordflow}{if}((shMax*SchwarzGaunt[s3+s4*nShell]*SchwarzGaunt[s2 + s1*nShell]) <}
\DoxyCodeLine{2554              eri.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_a51ce753ee588706401406d4216c1ba74}{threshSchwarz}}()) \{ nSkipGaunt[thread\_id]++; \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{2555 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2556   }
\DoxyCodeLine{2557   }
\DoxyCodeLine{2558           shls[0] = int(s2);}
\DoxyCodeLine{2559           shls[1] = int(s1);}
\DoxyCodeLine{2560           shls[2] = int(s3);}
\DoxyCodeLine{2561           shls[3] = int(s4);}
\DoxyCodeLine{2562 }
\DoxyCodeLine{2563           \textcolor{keywordflow}{if}(int2e\_ip1ip2\_sph(buff, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache)==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2564  }
\DoxyCodeLine{2565           \textcolor{keyword}{auto} nQuad = n1*n2*n3*n4;}
\DoxyCodeLine{2566 }
\DoxyCodeLine{2567           \textcolor{keywordflow}{for}(l = 3*maxShellSize, mnkl = 0ul; l < 3*maxShellSize + n4; ++l) }
\DoxyCodeLine{2568           \textcolor{keywordflow}{for}(k = 2*maxShellSize            ; k < 2*maxShellSize + n3; ++k) }
\DoxyCodeLine{2569           \textcolor{keywordflow}{for}(m = 0                         ; m <                  n1; ++m)}
\DoxyCodeLine{2570           \textcolor{keywordflow}{for}(n =   maxShellSize            ; n <   maxShellSize + n2; ++n, ++mnkl) \{}
\DoxyCodeLine{2571 }
\DoxyCodeLine{2572   }
\DoxyCodeLine{2573             \textcolor{comment}{/* Gaunt */}}
\DoxyCodeLine{2574             \textcolor{comment}{// ∇A∙∇C(mn|kl)}}
\DoxyCodeLine{2575             \textcolor{keyword}{auto} dAdotdC = buff[AxCx*nQuad+mnkl] + buff[AyCy*nQuad+mnkl] + buff[AzCz*nQuad+mnkl];}
\DoxyCodeLine{2576             \textcolor{comment}{// ∇Ax∇C(mn|kl)}}
\DoxyCodeLine{2577             \textcolor{keyword}{auto} dAcrossdC\_x =  buff[AyCz*nQuad+mnkl] -\/ buff[AzCy*nQuad+mnkl];}
\DoxyCodeLine{2578             \textcolor{keyword}{auto} dAcrossdC\_y = -\/buff[AxCz*nQuad+mnkl] + buff[AzCx*nQuad+mnkl];}
\DoxyCodeLine{2579             \textcolor{keyword}{auto} dAcrossdC\_z =  buff[AxCy*nQuad+mnkl] -\/ buff[AyCx*nQuad+mnkl];}
\DoxyCodeLine{2580 }
\DoxyCodeLine{2581 }
\DoxyCodeLine{2582             \textcolor{comment}{// Change the index so that we do ∇B∙∇C(ij|kl) using the ∇B∇C engine}}
\DoxyCodeLine{2583             \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{2584             \textcolor{keyword}{auto} LKNM = l + k*NB + n*NB2 + m*NB3;}
\DoxyCodeLine{2585   }
\DoxyCodeLine{2586             \textcolor{comment}{// ∇B∙∇C(ij|kl) followed by ∇Bx∇C(ij|kl) X, Y, and Z}}
\DoxyCodeLine{2587             \textcolor{comment}{// (kl|mn)}}
\DoxyCodeLine{2588             BC[      MNKL] = dAdotdC;    }
\DoxyCodeLine{2589             BC[  NB4+MNKL] = dAcrossdC\_x;}
\DoxyCodeLine{2590             BC[NB4\_2+MNKL] = dAcrossdC\_y;}
\DoxyCodeLine{2591             BC[NB4\_3+MNKL] = dAcrossdC\_z;}
\DoxyCodeLine{2592 }
\DoxyCodeLine{2593             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2594             BC[      LKNM] = dAdotdC;}
\DoxyCodeLine{2595             BC[  NB4+LKNM] = -\/dAcrossdC\_x;}
\DoxyCodeLine{2596             BC[NB4\_2+LKNM] = -\/dAcrossdC\_y;}
\DoxyCodeLine{2597             BC[NB4\_3+LKNM] = -\/dAcrossdC\_z;}
\DoxyCodeLine{2598   }
\DoxyCodeLine{2599 }
\DoxyCodeLine{2600             \textcolor{comment}{// ∇B\_x∇C\_y(mn|kl) + ∇B\_y∇C\_x(mn|kl)}}
\DoxyCodeLine{2601             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2602             BC[NB4\_4+MNKL] = buff[BxCy*nQuad+mnkl] + buff[ByCx*nQuad+mnkl];}
\DoxyCodeLine{2603             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2604             BC[NB4\_4+LKNM] = buff[BxCy*nQuad+mnkl] + buff[ByCx*nQuad+mnkl];}
\DoxyCodeLine{2605   }
\DoxyCodeLine{2606   }
\DoxyCodeLine{2607             \textcolor{comment}{// ∇B\_y∇C\_x(mn|kl)}}
\DoxyCodeLine{2608             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2609             BC[NB4\_5+MNKL] = buff[ByCx*nQuad+mnkl];}
\DoxyCodeLine{2610             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2611             BC[NB4\_5+LKNM] = buff[BxCy*nQuad+mnkl];}
\DoxyCodeLine{2612   }
\DoxyCodeLine{2613   }
\DoxyCodeLine{2614             \textcolor{comment}{// ∇B\_x∇C\_z(mn|kl) + ∇B\_z∇C\_x(mn|kl)}}
\DoxyCodeLine{2615             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2616             BC[NB4\_6+MNKL] = buff[BxCz*nQuad+mnkl] + buff[BzCx*nQuad+mnkl];}
\DoxyCodeLine{2617             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2618             BC[NB4\_6+LKNM] = buff[BxCz*nQuad+mnkl] + buff[BzCx*nQuad+mnkl];}
\DoxyCodeLine{2619   }
\DoxyCodeLine{2620   }
\DoxyCodeLine{2621             \textcolor{comment}{// ∇B\_z∇C\_x(mn|kl)}}
\DoxyCodeLine{2622             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2623             BC[NB4\_7+MNKL] = buff[BzCx*nQuad+mnkl];}
\DoxyCodeLine{2624             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2625             BC[NB4\_7+LKNM] = buff[BxCz*nQuad+mnkl];}
\DoxyCodeLine{2626   }
\DoxyCodeLine{2627   }
\DoxyCodeLine{2628             \textcolor{comment}{// ∇B\_y∇C\_z(mn|kl) + ∇B\_z∇C\_y(mn|kl)}}
\DoxyCodeLine{2629             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2630             BC[NB4\_8+MNKL] = buff[ByCz*nQuad+mnkl] + buff[BzCy*nQuad+mnkl];}
\DoxyCodeLine{2631             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2632             BC[NB4\_8+LKNM] = buff[ByCz*nQuad+mnkl] + buff[BzCy*nQuad+mnkl];}
\DoxyCodeLine{2633   }
\DoxyCodeLine{2634   }
\DoxyCodeLine{2635             \textcolor{comment}{// ∇B\_z∇C\_y(mn|kl)}}
\DoxyCodeLine{2636             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2637             BC[NB4\_9+MNKL] = buff[BzCy*nQuad+mnkl];}
\DoxyCodeLine{2638             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2639             BC[NB4\_9+LKNM] = buff[ByCz*nQuad+mnkl];}
\DoxyCodeLine{2640   }
\DoxyCodeLine{2641   }
\DoxyCodeLine{2642             \textcolor{comment}{// -\/ ∇B\_x∇C\_x(mn|kl) -\/ ∇B\_y∇C\_y(mn|kl) + ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2643             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2644             BC[NB4\_10+MNKL] = -\/ buff[BxCx*nQuad+mnkl] -\/ buff[ByCy*nQuad+mnkl] + buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2645             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2646             BC[NB4\_10+LKNM] = -\/ buff[BxCx*nQuad+mnkl] -\/ buff[ByCy*nQuad+mnkl] + buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2647   }
\DoxyCodeLine{2648   }
\DoxyCodeLine{2649             \textcolor{comment}{// ∇B\_x∇C\_x(mn|kl) -\/ ∇B\_y∇C\_y(mn|kl) -\/ ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2650             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2651             BC[NB4\_11+MNKL] = buff[BxCx*nQuad+mnkl] -\/ buff[ByCy*nQuad+mnkl] -\/ buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2652             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2653             BC[NB4\_11+LKNM] = buff[BxCx*nQuad+mnkl] -\/ buff[ByCy*nQuad+mnkl] -\/ buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2654   }
\DoxyCodeLine{2655   }
\DoxyCodeLine{2656             \textcolor{comment}{// -\/ ∇B\_x∇C\_x(mn|kl) + ∇B\_y∇C\_y(mn|kl) -\/ ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2657             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2658             BC[NB4\_12+MNKL] = -\/ buff[BxCx*nQuad+mnkl] + buff[ByCy*nQuad+mnkl] -\/ buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2659             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2660             BC[NB4\_12+LKNM] = -\/ buff[BxCx*nQuad+mnkl] + buff[ByCy*nQuad+mnkl] -\/ buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2661   }
\DoxyCodeLine{2662   }
\DoxyCodeLine{2663             \textcolor{comment}{// ∇B\_x∇C\_x(mn|kl)}}
\DoxyCodeLine{2664             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2665             BC[NB4\_13+MNKL] = buff[BxCx*nQuad+mnkl];}
\DoxyCodeLine{2666             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2667             BC[NB4\_13+LKNM] = buff[BxCx*nQuad+mnkl];}
\DoxyCodeLine{2668   }
\DoxyCodeLine{2669   }
\DoxyCodeLine{2670             \textcolor{comment}{// ∇B\_x∇C\_y(mn|kl)}}
\DoxyCodeLine{2671             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2672             BC[NB4\_14+MNKL] = buff[BxCy*nQuad+mnkl];}
\DoxyCodeLine{2673             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2674             BC[NB4\_14+LKNM] = buff[ByCx*nQuad+mnkl];}
\DoxyCodeLine{2675   }
\DoxyCodeLine{2676   }
\DoxyCodeLine{2677             \textcolor{comment}{// ∇B\_x∇C\_z(mn|kl)}}
\DoxyCodeLine{2678             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2679             BC[NB4\_15+MNKL] = buff[BxCz*nQuad+mnkl];}
\DoxyCodeLine{2680             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2681             BC[NB4\_15+LKNM] = buff[BzCx*nQuad+mnkl];}
\DoxyCodeLine{2682   }
\DoxyCodeLine{2683 }
\DoxyCodeLine{2684             \textcolor{comment}{// ∇B\_y∇C\_y(mn|kl)}}
\DoxyCodeLine{2685             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2686             BC[NB4\_16+MNKL] = buff[ByCy*nQuad+mnkl];}
\DoxyCodeLine{2687             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2688             BC[NB4\_16+LKNM] = buff[ByCy*nQuad+mnkl];}
\DoxyCodeLine{2689   }
\DoxyCodeLine{2690 }
\DoxyCodeLine{2691             \textcolor{comment}{// ∇B\_y∇C\_z(mn|kl)}}
\DoxyCodeLine{2692             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2693             BC[NB4\_17+MNKL] = buff[ByCz*nQuad+mnkl];}
\DoxyCodeLine{2694             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2695             BC[NB4\_17+LKNM] = buff[BzCy*nQuad+mnkl];}
\DoxyCodeLine{2696   }
\DoxyCodeLine{2697   }
\DoxyCodeLine{2698             \textcolor{comment}{// ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2699             \textcolor{comment}{// (mn|kl)}}
\DoxyCodeLine{2700             BC[NB4\_18+MNKL] = buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2701             \textcolor{comment}{// (lk|nm)}}
\DoxyCodeLine{2702             BC[NB4\_18+LKNM] = buff[BzCz*nQuad+mnkl];}
\DoxyCodeLine{2703   }
\DoxyCodeLine{2704           \} \textcolor{comment}{// ∇C∙∇D integral preparation loop}}
\DoxyCodeLine{2705   }
\DoxyCodeLine{2706 \textcolor{preprocessor}{\#if   0}}
\DoxyCodeLine{2707       std::cout << std::scientific << std::setprecision(16);}
\DoxyCodeLine{2708   }
\DoxyCodeLine{2709       \textcolor{keywordflow}{for}(m = 0ul,            bf1 = bf1\_s; m <                  n1; ++m, bf1++) }
\DoxyCodeLine{2710       \textcolor{keywordflow}{for}(n =   maxShellSize, bf2 = bf2\_s; n <   maxShellSize + n2; ++n, bf2++) }
\DoxyCodeLine{2711       \textcolor{keywordflow}{for}(k = 2*maxShellSize, bf3 = bf3\_s; k < 2*maxShellSize + n3; ++k, bf3++) }
\DoxyCodeLine{2712       \textcolor{keywordflow}{for}(l = 3*maxShellSize, bf4 = bf4\_s; l < 3*maxShellSize + n4; ++l, bf4++) \{}
\DoxyCodeLine{2713         \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{2714 }
\DoxyCodeLine{2715     std::cout << \textcolor{stringliteral}{"{}ERI04-\/07: ∇B∙∇C(ab|cd)  ∇Bx∇C(ab|cd)-\/X  ∇Bx∇C(ab|cd)-\/Y  ∇Bx∇C(ab|cd)-\/Z"{}} << std::endl;}
\DoxyCodeLine{2716         std::cout << \textcolor{stringliteral}{"{}("{}} << bf1 << \textcolor{stringliteral}{"{},"{}} << bf2 << \textcolor{stringliteral}{"{}|"{}} << bf3 << \textcolor{stringliteral}{"{},"{}} << bf4 << \textcolor{stringliteral}{"{})  "{}};}
\DoxyCodeLine{2717         std::cout << BC[MNKL];}
\DoxyCodeLine{2718         std::cout << \textcolor{stringliteral}{"{}   "{}};}
\DoxyCodeLine{2719         std::cout << BC[MNKL+NB4];}
\DoxyCodeLine{2720         std::cout << \textcolor{stringliteral}{"{}   "{}};}
\DoxyCodeLine{2721         std::cout << BC[MNKL+NB4\_2];}
\DoxyCodeLine{2722         std::cout << \textcolor{stringliteral}{"{}   "{}};}
\DoxyCodeLine{2723         std::cout << BC[MNKL+NB4\_3] << std::endl;}
\DoxyCodeLine{2724       \};}
\DoxyCodeLine{2725 }
\DoxyCodeLine{2726 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2727   }
\DoxyCodeLine{2728   }
\DoxyCodeLine{2729   }
\DoxyCodeLine{2730 \textcolor{preprocessor}{\#ifdef \_CONTRACTION\_ }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{2731 }
\DoxyCodeLine{2732           \textcolor{keyword}{auto} ADXLLMS  = AX\_loc[XLLMS];}
\DoxyCodeLine{2733           \textcolor{keyword}{auto} ADXLLMX  = AX\_loc[XLLMX];}
\DoxyCodeLine{2734           \textcolor{keyword}{auto} ADXLLMY  = AX\_loc[XLLMY];}
\DoxyCodeLine{2735           \textcolor{keyword}{auto} ADXLLMZ  = AX\_loc[XLLMZ];}
\DoxyCodeLine{2736           \textcolor{keyword}{auto} DXLLMS = matList[XLLMS].X;}
\DoxyCodeLine{2737           \textcolor{keyword}{auto} DXLLMX = matList[XLLMX].X;}
\DoxyCodeLine{2738           \textcolor{keyword}{auto} DXLLMY = matList[XLLMY].X;}
\DoxyCodeLine{2739           \textcolor{keyword}{auto} DXLLMZ = matList[XLLMZ].X;}
\DoxyCodeLine{2740 }
\DoxyCodeLine{2741           \textcolor{keyword}{auto} ADXSSMS  = AX\_loc[XSSMS];}
\DoxyCodeLine{2742           \textcolor{keyword}{auto} ADXSSMX  = AX\_loc[XSSMX];}
\DoxyCodeLine{2743           \textcolor{keyword}{auto} ADXSSMY  = AX\_loc[XSSMY];}
\DoxyCodeLine{2744           \textcolor{keyword}{auto} ADXSSMZ  = AX\_loc[XSSMZ];}
\DoxyCodeLine{2745           \textcolor{keyword}{auto} DXSSMS = matList[XSSMS].X;}
\DoxyCodeLine{2746           \textcolor{keyword}{auto} DXSSMX = matList[XSSMX].X;}
\DoxyCodeLine{2747           \textcolor{keyword}{auto} DXSSMY = matList[XSSMY].X;}
\DoxyCodeLine{2748           \textcolor{keyword}{auto} DXSSMZ = matList[XSSMZ].X;}
\DoxyCodeLine{2749 }
\DoxyCodeLine{2750           \textcolor{keyword}{auto} ADCLSMS  = AX\_loc[CLSMS];}
\DoxyCodeLine{2751           \textcolor{keyword}{auto} ADCLSMX  = AX\_loc[CLSMX];}
\DoxyCodeLine{2752           \textcolor{keyword}{auto} ADCLSMY  = AX\_loc[CLSMY];}
\DoxyCodeLine{2753           \textcolor{keyword}{auto} ADCLSMZ  = AX\_loc[CLSMZ];}
\DoxyCodeLine{2754           \textcolor{keyword}{auto} ADXLSMS  = AX\_loc[XLSMS];}
\DoxyCodeLine{2755           \textcolor{keyword}{auto} ADXLSMX  = AX\_loc[XLSMX];}
\DoxyCodeLine{2756           \textcolor{keyword}{auto} ADXLSMY  = AX\_loc[XLSMY];}
\DoxyCodeLine{2757           \textcolor{keyword}{auto} ADXLSMZ  = AX\_loc[XLSMZ];}
\DoxyCodeLine{2758 }
\DoxyCodeLine{2759           \textcolor{keyword}{auto} DXLSMS = matList[XLSMS].X;}
\DoxyCodeLine{2760           \textcolor{keyword}{auto} DXLSMX = matList[XLSMX].X;}
\DoxyCodeLine{2761           \textcolor{keyword}{auto} DXLSMY = matList[XLSMY].X;}
\DoxyCodeLine{2762           \textcolor{keyword}{auto} DXLSMZ = matList[XLSMZ].X;}
\DoxyCodeLine{2763           \textcolor{keyword}{auto} DXSLMS = matList[XSLMS].X;}
\DoxyCodeLine{2764           \textcolor{keyword}{auto} DXSLMX = matList[XSLMX].X;}
\DoxyCodeLine{2765           \textcolor{keyword}{auto} DXSLMY = matList[XSLMY].X;}
\DoxyCodeLine{2766           \textcolor{keyword}{auto} DXSLMZ = matList[XSLMZ].X;}
\DoxyCodeLine{2767 }
\DoxyCodeLine{2768           \textcolor{keyword}{auto} DCLSMS = matList[CLSMS].X;}
\DoxyCodeLine{2769           \textcolor{keyword}{auto} DCLSMX = matList[CLSMX].X;}
\DoxyCodeLine{2770           \textcolor{keyword}{auto} DCLSMY = matList[CLSMY].X;}
\DoxyCodeLine{2771           \textcolor{keyword}{auto} DCLSMZ = matList[CLSMZ].X;}
\DoxyCodeLine{2772           \textcolor{keyword}{auto} DCSLMS = matList[CSLMS].X;}
\DoxyCodeLine{2773           \textcolor{keyword}{auto} DCSLMX = matList[CSLMX].X;}
\DoxyCodeLine{2774           \textcolor{keyword}{auto} DCSLMY = matList[CSLMY].X;}
\DoxyCodeLine{2775           \textcolor{keyword}{auto} DCSLMZ = matList[CSLMZ].X;}
\DoxyCodeLine{2776  }
\DoxyCodeLine{2777           \textcolor{keywordflow}{for}(m = 0ul,            bf1 = bf1\_s; m <                  n1; ++m, bf1++) \{}
\DoxyCodeLine{2778           \textcolor{keywordflow}{for}(n =   maxShellSize, bf2 = bf2\_s; n <   maxShellSize + n2; ++n, bf2++) \{}
\DoxyCodeLine{2779             \textcolor{keyword}{auto} bf1nB = bf1*nBasis;}
\DoxyCodeLine{2780             \textcolor{keyword}{auto} bf2nB = bf2*nBasis;}
\DoxyCodeLine{2781 }
\DoxyCodeLine{2782           \textcolor{keywordflow}{for}(k = 2*maxShellSize, bf3 = bf3\_s; k < 2*maxShellSize + n3; ++k, bf3++) \{}
\DoxyCodeLine{2783             \textcolor{keyword}{auto} bf3nB = bf3*nBasis;}
\DoxyCodeLine{2784 }
\DoxyCodeLine{2785           \textcolor{keywordflow}{for}(l = 3*maxShellSize, bf4 = bf4\_s; l < 3*maxShellSize + n4; ++l, bf4++) \{}
\DoxyCodeLine{2786             \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{2787             \textcolor{keyword}{auto} LKNM = l + k*NB + n*NB2 + m*NB3;}
\DoxyCodeLine{2788 }
\DoxyCodeLine{2789             \textcolor{keyword}{auto} bf4nB= bf4*nBasis;}
\DoxyCodeLine{2790             \textcolor{keyword}{auto} bf14 = bf1 + bf4nB;}
\DoxyCodeLine{2791             \textcolor{keyword}{auto} bf24 = bf2 + bf4nB;}
\DoxyCodeLine{2792             \textcolor{keyword}{auto} bf23 = bf2 + bf3nB;}
\DoxyCodeLine{2793             \textcolor{keyword}{auto} bf13 = bf1 + bf3nB;}
\DoxyCodeLine{2794             \textcolor{keyword}{auto} bf41 = bf4 + bf1nB;}
\DoxyCodeLine{2795             \textcolor{keyword}{auto} bf31 = bf3 + bf1nB;}
\DoxyCodeLine{2796             \textcolor{keyword}{auto} bf32 = bf3 + bf2nB;}
\DoxyCodeLine{2797             \textcolor{keyword}{auto} bf42 = bf4 + bf2nB;}
\DoxyCodeLine{2798             \textcolor{keyword}{auto} bf34 = bf3 + bf4nB;}
\DoxyCodeLine{2799             \textcolor{keyword}{auto} bf43 = bf4 + bf3nB;}
\DoxyCodeLine{2800             \textcolor{keyword}{auto} bf12 = bf1 + bf2nB;}
\DoxyCodeLine{2801             \textcolor{keyword}{auto} bf21 = bf2 + bf1nB;}
\DoxyCodeLine{2802 }
\DoxyCodeLine{2803             \textcolor{comment}{//ERI0 :   ∇B∙∇C(mn|kl)}}
\DoxyCodeLine{2804             \textcolor{comment}{//ERI1 :   ∇Bx∇C(mn|kl)-\/X}}
\DoxyCodeLine{2805             \textcolor{comment}{//ERI2 :   ∇Bx∇C(mn|kl)-\/Y}}
\DoxyCodeLine{2806             \textcolor{comment}{//ERI3 :   ∇Bx∇C(mn|kl)-\/Z}}
\DoxyCodeLine{2807             \textcolor{comment}{//ERI4 :   ∇B\_x∇C\_y(mn|kl) + ∇B\_y∇C\_x(mn|kl)}}
\DoxyCodeLine{2808             \textcolor{comment}{//ERI5 :   ∇B\_y∇C\_x(mn|kl)}}
\DoxyCodeLine{2809             \textcolor{comment}{//ERI6 :   ∇B\_x∇C\_z(mn|kl) + ∇B\_z∇C\_x(mn|kl)}}
\DoxyCodeLine{2810             \textcolor{comment}{//ERI7 :   ∇B\_z∇C\_x(mn|kl)}}
\DoxyCodeLine{2811             \textcolor{comment}{//ERI8 :   ∇B\_y∇C\_z(mn|kl) + ∇B\_z∇C\_y(mn|kl)}}
\DoxyCodeLine{2812             \textcolor{comment}{//ERI9 :   ∇B\_z∇C\_y(mn|kl)}}
\DoxyCodeLine{2813             \textcolor{comment}{//ERI10: -\/ ∇B\_x∇C\_x(mn|kl) -\/ ∇B\_y∇C\_y(mn|kl) + ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2814             \textcolor{comment}{//ERI11:   ∇B\_x∇C\_x(mn|kl) -\/ ∇B\_y∇C\_y(mn|kl) -\/ ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2815             \textcolor{comment}{//ERI12: -\/ ∇B\_x∇C\_x(mn|kl) + ∇B\_y∇C\_y(mn|kl) -\/ ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2816             \textcolor{comment}{//ERI13:   ∇B\_x∇C\_x(mn|kl)}}
\DoxyCodeLine{2817             \textcolor{comment}{//ERI14:   ∇B\_x∇C\_y(mn|kl)}}
\DoxyCodeLine{2818             \textcolor{comment}{//ERI15:   ∇B\_x∇C\_z(mn|kl)}}
\DoxyCodeLine{2819             \textcolor{comment}{//ERI16:   ∇B\_y∇C\_y(mn|kl)}}
\DoxyCodeLine{2820             \textcolor{comment}{//ERI17:   ∇B\_y∇C\_z(mn|kl)}}
\DoxyCodeLine{2821             \textcolor{comment}{//ERI18:   ∇B\_z∇C\_z(mn|kl)}}
\DoxyCodeLine{2822             }
\DoxyCodeLine{2823             }
\DoxyCodeLine{2824             }
\DoxyCodeLine{2825             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{2826             \textcolor{comment}{/* Start of Gaunt (LL|LL) */}}
\DoxyCodeLine{2827             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{2828             }
\DoxyCodeLine{2829             \textcolor{comment}{// Exchange}}
\DoxyCodeLine{2830             \textcolor{comment}{// MNKL}}
\DoxyCodeLine{2831             ADXLLMS[bf14] += 3.0*( DXSSMS[bf23]*BC[MNKL       ] -\/iS*(DXSSMX[bf23]*BC[MNKL+NB4  ] +DXSSMY[bf23]*BC[MNKL+NB4\_2 ] +DXSSMZ[bf23]*BC[MNKL+NB4\_3 ]));}
\DoxyCodeLine{2832             ADXLLMZ[bf14] +=      -\/DXSSMZ[bf23]*BC[MNKL+NB4\_10] -\/iS*DXSSMS[bf23]*BC[MNKL+NB4\_3 ] -\/DXSSMX[bf23]*BC[MNKL+NB4\_6 ] -\/DXSSMY[bf23]*BC[MNKL+NB4\_8 ];}
\DoxyCodeLine{2833             ADXLLMX[bf14] +=      -\/DXSSMX[bf23]*BC[MNKL+NB4\_11] -\/iS*DXSSMS[bf23]*BC[MNKL+NB4   ] -\/DXSSMY[bf23]*BC[MNKL+NB4\_4 ] -\/DXSSMZ[bf23]*BC[MNKL+NB4\_6 ];}
\DoxyCodeLine{2834             ADXLLMY[bf14] +=      -\/DXSSMY[bf23]*BC[MNKL+NB4\_12] -\/iS*DXSSMS[bf23]*BC[MNKL+NB4\_2 ] -\/DXSSMX[bf23]*BC[MNKL+NB4\_4 ] -\/DXSSMZ[bf23]*BC[MNKL+NB4\_8 ];}
\DoxyCodeLine{2835             }
\DoxyCodeLine{2836             \textcolor{comment}{// LKNM}}
\DoxyCodeLine{2837             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{2838               ADXLLMS[bf41] += 3.0*( DXSSMS[bf32]*BC[LKNM       ] -\/iS*(DXSSMX[bf32]*BC[LKNM+NB4  ] +DXSSMY[bf32]*BC[LKNM+NB4\_2 ] +DXSSMZ[bf32]*BC[LKNM+NB4\_3 ]));}
\DoxyCodeLine{2839               ADXLLMZ[bf41] +=      -\/DXSSMZ[bf32]*BC[LKNM+NB4\_10] -\/iS*DXSSMS[bf32]*BC[LKNM+NB4\_3 ] -\/DXSSMX[bf32]*BC[LKNM+NB4\_6 ] -\/DXSSMY[bf32]*BC[LKNM+NB4\_8 ];}
\DoxyCodeLine{2840               ADXLLMX[bf41] +=      -\/DXSSMX[bf32]*BC[LKNM+NB4\_11] -\/iS*DXSSMS[bf32]*BC[LKNM+NB4   ] -\/DXSSMY[bf32]*BC[LKNM+NB4\_4 ] -\/DXSSMZ[bf32]*BC[LKNM+NB4\_6 ];}
\DoxyCodeLine{2841               ADXLLMY[bf41] +=      -\/DXSSMY[bf32]*BC[LKNM+NB4\_12] -\/iS*DXSSMS[bf32]*BC[LKNM+NB4\_2 ] -\/DXSSMX[bf32]*BC[LKNM+NB4\_4 ] -\/DXSSMZ[bf32]*BC[LKNM+NB4\_8 ];}
\DoxyCodeLine{2842             \}}
\DoxyCodeLine{2843             }
\DoxyCodeLine{2844             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{2845             \textcolor{comment}{/* Start of Gaunt (SS|SS) */}}
\DoxyCodeLine{2846             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{2847             }
\DoxyCodeLine{2848             \textcolor{comment}{// MNKL}}
\DoxyCodeLine{2849             ADXSSMS[bf32]+= 3.0*DXLLMS[bf41]*BC[MNKL       ]    -\/iS*(DXLLMX[bf41]*BC[MNKL+NB4   ] +DXLLMY[bf41]*BC[MNKL+NB4\_2 ] +DXLLMZ[bf41]*BC[MNKL+NB4\_3 ]);}
\DoxyCodeLine{2850             ADXSSMZ[bf32]+=    -\/DXLLMZ[bf41]*BC[MNKL+NB4\_10] -\/3.0*iS*DXLLMS[bf41]*BC[MNKL+NB4\_3 ] -\/DXLLMX[bf41]*BC[MNKL+NB4\_6 ] -\/DXLLMY[bf41]*BC[MNKL+NB4\_8 ];}
\DoxyCodeLine{2851             ADXSSMX[bf32]+=    -\/DXLLMX[bf41]*BC[MNKL+NB4\_11] -\/3.0*iS*DXLLMS[bf41]*BC[MNKL+NB4   ] -\/DXLLMZ[bf41]*BC[MNKL+NB4\_6 ] -\/DXLLMY[bf41]*BC[MNKL+NB4\_4 ];}
\DoxyCodeLine{2852             ADXSSMY[bf32]+=    -\/DXLLMY[bf41]*BC[MNKL+NB4\_12] -\/3.0*iS*DXLLMS[bf41]*BC[MNKL+NB4\_2 ] -\/DXLLMX[bf41]*BC[MNKL+NB4\_4 ] -\/DXLLMZ[bf41]*BC[MNKL+NB4\_8 ];}
\DoxyCodeLine{2853             }
\DoxyCodeLine{2854             \textcolor{comment}{// LKNM}}
\DoxyCodeLine{2855             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{2856               ADXSSMS[bf23]+= 3.0*DXLLMS[bf14]*BC[LKNM       ]    -\/iS*(DXLLMX[bf14]*BC[LKNM+NB4   ] +DXLLMY[bf14]*BC[LKNM+NB4\_2 ] +DXLLMZ[bf14]*BC[LKNM+NB4\_3 ]);}
\DoxyCodeLine{2857               ADXSSMZ[bf23]+=    -\/DXLLMZ[bf14]*BC[LKNM+NB4\_10] -\/3.0*iS*DXLLMS[bf14]*BC[LKNM+NB4\_3 ] -\/DXLLMX[bf14]*BC[LKNM+NB4\_6 ] -\/DXLLMY[bf14]*BC[LKNM+NB4\_8 ];}
\DoxyCodeLine{2858               ADXSSMX[bf23]+=    -\/DXLLMX[bf14]*BC[LKNM+NB4\_11] -\/3.0*iS*DXLLMS[bf14]*BC[LKNM+NB4   ] -\/DXLLMZ[bf14]*BC[LKNM+NB4\_6 ] -\/DXLLMY[bf14]*BC[LKNM+NB4\_4 ];}
\DoxyCodeLine{2859               ADXSSMY[bf23]+=    -\/DXLLMY[bf14]*BC[LKNM+NB4\_12] -\/3.0*iS*DXLLMS[bf14]*BC[LKNM+NB4\_2 ] -\/DXLLMX[bf14]*BC[LKNM+NB4\_4 ] -\/DXLLMZ[bf14]*BC[LKNM+NB4\_8 ];}
\DoxyCodeLine{2860             \}}
\DoxyCodeLine{2861             }
\DoxyCodeLine{2862             }
\DoxyCodeLine{2863             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{2864             \textcolor{comment}{/* Start of Gaunt (LL|SS) */}}
\DoxyCodeLine{2865             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{2866             }
\DoxyCodeLine{2867             \textcolor{comment}{// MNKL}}
\DoxyCodeLine{2868             \textcolor{comment}{// Coulomb //TRANSKL}}
\DoxyCodeLine{2869             ADCLSMS[bf12]+=   -\/DCLSMS[bf43]*BC[MNKL       ] +iS*(DCLSMX[bf43]*BC[MNKL+NB4  ] +DCLSMY[bf43]*BC[MNKL+NB4\_2 ] +DCLSMZ[bf43]*BC[MNKL+NB4\_3 ])}
\DoxyCodeLine{2870                               +DCSLMS[bf34]*BC[MNKL       ] +iS*(DCSLMX[bf34]*BC[MNKL+NB4  ] +DCSLMY[bf34]*BC[MNKL+NB4\_2 ] +DCSLMZ[bf34]*BC[MNKL+NB4\_3 ]);}
\DoxyCodeLine{2871             }
\DoxyCodeLine{2872             ADCLSMZ[bf12]+= iS*DCLSMS[bf43]*BC[MNKL+NB4\_3 ] -\/DCLSMZ[bf43]*BC[MNKL       ] +DCLSMX[bf43]*BC[MNKL+NB4\_15] +DCLSMY[bf43]*BC[MNKL+NB4\_17] +DCLSMZ[bf43]*BC[MNKL+NB4\_18]}
\DoxyCodeLine{2873                            -\/iS*DCSLMS[bf34]*BC[MNKL+NB4\_3 ] -\/DCSLMZ[bf34]*BC[MNKL       ] +DCSLMX[bf34]*BC[MNKL+NB4\_15] +DCSLMY[bf34]*BC[MNKL+NB4\_17] +DCSLMZ[bf34]*BC[MNKL+NB4\_18];}
\DoxyCodeLine{2874             }
\DoxyCodeLine{2875             ADCLSMX[bf12]+= iS*DCLSMS[bf43]*BC[MNKL+NB4   ] -\/DCLSMX[bf43]*BC[MNKL       ] +DCLSMX[bf43]*BC[MNKL+NB4\_13] +DCLSMY[bf43]*BC[MNKL+NB4\_5 ] +DCLSMZ[bf43]*BC[MNKL+NB4\_7 ]}
\DoxyCodeLine{2876                            -\/iS*DCSLMS[bf34]*BC[MNKL+NB4   ] -\/DCSLMX[bf34]*BC[MNKL       ] +DCSLMX[bf34]*BC[MNKL+NB4\_13] +DCSLMY[bf34]*BC[MNKL+NB4\_5 ] +DCSLMZ[bf34]*BC[MNKL+NB4\_7 ];}
\DoxyCodeLine{2877             }
\DoxyCodeLine{2878             ADCLSMY[bf12]+= iS*DCLSMS[bf43]*BC[MNKL+NB4\_2 ] -\/DCLSMY[bf43]*BC[MNKL       ] +DCLSMX[bf43]*BC[MNKL+NB4\_14] +DCLSMY[bf43]*BC[MNKL+NB4\_16] +DCLSMZ[bf43]*BC[MNKL+NB4\_9 ]}
\DoxyCodeLine{2879                            -\/iS*DCSLMS[bf34]*BC[MNKL+NB4\_2 ] -\/DCSLMY[bf34]*BC[MNKL       ] +DCSLMX[bf34]*BC[MNKL+NB4\_14] +DCSLMY[bf34]*BC[MNKL+NB4\_16] +DCSLMZ[bf34]*BC[MNKL+NB4\_9 ];}
\DoxyCodeLine{2880             }
\DoxyCodeLine{2881             }
\DoxyCodeLine{2882             }
\DoxyCodeLine{2883             \textcolor{comment}{// LKNM}}
\DoxyCodeLine{2884             \textcolor{comment}{// Coulomb //TRANSKL}}
\DoxyCodeLine{2885             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{2886               ADCLSMS[bf43]+= -\/DCLSMS[bf12]*BC[LKNM      ] +iS*(DCLSMX[bf12]*BC[LKNM+NB4  ] +DCLSMY[bf12]*BC[LKNM+NB4\_2 ] +DCLSMZ[bf12]*BC[LKNM+NB4\_3 ])}
\DoxyCodeLine{2887                               +DCSLMS[bf21]*BC[LKNM      ] +iS*(DCSLMX[bf21]*BC[LKNM+NB4  ] +DCSLMY[bf21]*BC[LKNM+NB4\_2 ] +DCSLMZ[bf21]*BC[LKNM+NB4\_3 ]);}
\DoxyCodeLine{2888             }
\DoxyCodeLine{2889               ADCLSMZ[bf43]+= iS*DCLSMS[bf12]*BC[LKNM+NB4\_3 ] -\/DCLSMZ[bf12]*BC[LKNM       ] +DCLSMX[bf12]*BC[LKNM+NB4\_15] +DCLSMY[bf12]*BC[LKNM+NB4\_17] +DCLSMZ[bf12]*BC[LKNM+NB4\_18]}
\DoxyCodeLine{2890                              -\/iS*DCSLMS[bf21]*BC[LKNM+NB4\_3 ] -\/DCSLMZ[bf21]*BC[LKNM       ] +DCSLMX[bf21]*BC[LKNM+NB4\_15] +DCSLMY[bf21]*BC[LKNM+NB4\_17] +DCSLMZ[bf21]*BC[LKNM+NB4\_18];}
\DoxyCodeLine{2891             }
\DoxyCodeLine{2892               ADCLSMX[bf43]+= iS*DCLSMS[bf12]*BC[LKNM+NB4   ] -\/DCLSMX[bf12]*BC[LKNM       ] +DCLSMX[bf12]*BC[LKNM+NB4\_13] +DCLSMY[bf12]*BC[LKNM+NB4\_5 ] +DCLSMZ[bf12]*BC[LKNM+NB4\_7 ]}
\DoxyCodeLine{2893                              -\/iS*DCSLMS[bf21]*BC[LKNM+NB4   ] -\/DCSLMX[bf21]*BC[LKNM       ] +DCSLMX[bf21]*BC[LKNM+NB4\_13] +DCSLMY[bf21]*BC[LKNM+NB4\_5 ] +DCSLMZ[bf21]*BC[LKNM+NB4\_7 ];}
\DoxyCodeLine{2894             }
\DoxyCodeLine{2895               ADCLSMY[bf43]+= iS*DCLSMS[bf12]*BC[LKNM+NB4\_2 ] -\/DCLSMY[bf12]*BC[LKNM       ] +DCLSMX[bf12]*BC[LKNM+NB4\_14] +DCLSMY[bf12]*BC[LKNM+NB4\_16] +DCLSMZ[bf12]*BC[LKNM+NB4\_9 ]}
\DoxyCodeLine{2896                              -\/iS*DCSLMS[bf21]*BC[LKNM+NB4\_2 ] -\/DCSLMY[bf21]*BC[LKNM       ] +DCSLMX[bf21]*BC[LKNM+NB4\_14] +DCSLMY[bf21]*BC[LKNM+NB4\_16] +DCSLMZ[bf21]*BC[LKNM+NB4\_9 ];}
\DoxyCodeLine{2897             \}}
\DoxyCodeLine{2898             }
\DoxyCodeLine{2899             }
\DoxyCodeLine{2900             \textcolor{comment}{//Exchange //TRANSKL}}
\DoxyCodeLine{2901             ADXLSMS[bf13]+= DXSLMS[bf24]*BC[MNKL      ] -\/iS*(DXSLMX[bf24]*BC[MNKL+NB4   ] +DXSLMY[bf24]*BC[MNKL+NB4\_2 ] +DXSLMZ[bf24]*BC[MNKL+NB4\_3 ]);}
\DoxyCodeLine{2902              }
\DoxyCodeLine{2903             ADXLSMZ[bf13]+=-\/2.0*( DXSLMZ[bf24]*BC[MNKL       ] +DXSLMY[bf24]*BC[MNKL+NB4   ] -\/DXSLMX[bf24]*BC[MNKL+NB4\_2 ]) +iS*DXSLMS[bf24]*BC[MNKL+NB4\_3 ]}
\DoxyCodeLine{2904                                  -\/DXSLMZ[bf24]*BC[MNKL+NB4\_10] -\/DXSLMX[bf24]*BC[MNKL+NB4\_6 ] -\/DXSLMY[bf24]*BC[MNKL+NB4\_8 ];}
\DoxyCodeLine{2905             }
\DoxyCodeLine{2906             ADXLSMX[bf13]+=-\/2.0*( DXSLMX[bf24]*BC[MNKL       ] -\/DXSLMY[bf24]*BC[MNKL+NB4\_3 ] +DXSLMZ[bf24]*BC[MNKL+NB4\_2 ]) +iS*DXSLMS[bf24]*BC[MNKL+NB4   ]}
\DoxyCodeLine{2907                                  -\/DXSLMX[bf24]*BC[MNKL+NB4\_11] -\/DXSLMY[bf24]*BC[MNKL+NB4\_4 ] -\/DXSLMZ[bf24]*BC[MNKL+NB4\_6 ];}
\DoxyCodeLine{2908             }
\DoxyCodeLine{2909             ADXLSMY[bf13]+=-\/2.0*( DXSLMY[bf24]*BC[MNKL       ] +DXSLMX[bf24]*BC[MNKL+NB4\_3 ] -\/DXSLMZ[bf24]*BC[MNKL+NB4   ]) +iS*DXSLMS[bf24]*BC[MNKL+NB4\_2 ]}
\DoxyCodeLine{2910                                  -\/DXSLMY[bf24]*BC[MNKL+NB4\_12] -\/DXSLMX[bf24]*BC[MNKL+NB4\_4 ] -\/DXSLMZ[bf24]*BC[MNKL+NB4\_8 ];}
\DoxyCodeLine{2911             }
\DoxyCodeLine{2912             }
\DoxyCodeLine{2913             \textcolor{comment}{//Exchange //TRANSKL}}
\DoxyCodeLine{2914             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{2915               ADXLSMS[bf42]+= DXSLMS[bf31]*BC[LKNM       ] -\/iS*(DXSLMX[bf31]*BC[LKNM+NB4   ] +DXSLMY[bf31]*BC[LKNM+NB4\_2 ] +DXSLMZ[bf31]*BC[LKNM+NB4\_3 ]);}
\DoxyCodeLine{2916               }
\DoxyCodeLine{2917               ADXLSMZ[bf42]+=-\/2.0*( DXSLMZ[bf31]*BC[LKNM      ] +DXSLMY[bf31]*BC[LKNM+NB4   ] -\/DXSLMX[bf31]*BC[LKNM+NB4\_2 ]) +iS*DXSLMS[bf31]*BC[LKNM+NB4\_3 ]}
\DoxyCodeLine{2918                                   -\/DXSLMZ[bf31]*BC[LKNM+NB4\_10] -\/DXSLMX[bf31]*BC[LKNM+NB4\_6 ] -\/DXSLMY[bf31]*BC[LKNM+NB4\_8 ];}
\DoxyCodeLine{2919             }
\DoxyCodeLine{2920               ADXLSMX[bf42]+=-\/2.0*( DXSLMX[bf31]*BC[LKNM       ] -\/DXSLMY[bf31]*BC[LKNM+NB4\_3 ] +DXSLMZ[bf31]*BC[LKNM+NB4\_2 ]) +iS*DXSLMS[bf31]*BC[LKNM+NB4  ]}
\DoxyCodeLine{2921                                    -\/DXSLMX[bf31]*BC[LKNM+NB4\_11] -\/DXSLMY[bf31]*BC[LKNM+NB4\_4 ] -\/DXSLMZ[bf31]*BC[LKNM+NB4\_6 ];}
\DoxyCodeLine{2922             }
\DoxyCodeLine{2923               ADXLSMY[bf42]+=-\/2.0*( DXSLMY[bf31]*BC[LKNM       ] +DXSLMX[bf31]*BC[LKNM+NB4\_3 ] -\/DXSLMZ[bf31]*BC[LKNM+NB4   ]) +iS*DXSLMS[bf31]*BC[LKNM+NB4\_2 ]}
\DoxyCodeLine{2924                                    -\/DXSLMY[bf31]*BC[LKNM+NB4\_12] -\/DXSLMX[bf31]*BC[LKNM+NB4\_4 ] -\/DXSLMZ[bf31]*BC[LKNM+NB4\_8 ];}
\DoxyCodeLine{2925             \}}
\DoxyCodeLine{2926 }
\DoxyCodeLine{2927           \}}
\DoxyCodeLine{2928           \}}
\DoxyCodeLine{2929           \}}
\DoxyCodeLine{2930           \} \textcolor{comment}{// contraction loop}}
\DoxyCodeLine{2931   }
\DoxyCodeLine{2932 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{2933   }
\DoxyCodeLine{2934   }
\DoxyCodeLine{2935         \}; \textcolor{comment}{// loop s4}}
\DoxyCodeLine{2936         \}; \textcolor{comment}{// loop s3}}
\DoxyCodeLine{2937         \}; \textcolor{comment}{// loop s2}}
\DoxyCodeLine{2938         \}; \textcolor{comment}{// loop s1}}
\DoxyCodeLine{2939   }
\DoxyCodeLine{2940   }
\DoxyCodeLine{2941       \} \textcolor{comment}{// OpenMP context}}
\DoxyCodeLine{2942   }
\DoxyCodeLine{2943   }
\DoxyCodeLine{2944       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iTh  = 0; iTh < nThreads; iTh++) \{}
\DoxyCodeLine{2945 }
\DoxyCodeLine{2946         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{2947            matList[XLLMS].AX,nBasis,matList[XLLMS].AX,nBasis);}
\DoxyCodeLine{2948 }
\DoxyCodeLine{2949         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{2950            matList[XLLMX].AX,nBasis,matList[XLLMX].AX,nBasis);}
\DoxyCodeLine{2951 }
\DoxyCodeLine{2952         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{2953            matList[XLLMY].AX,nBasis,matList[XLLMY].AX,nBasis);}
\DoxyCodeLine{2954 }
\DoxyCodeLine{2955         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{2956            matList[XLLMZ].AX,nBasis,matList[XLLMZ].AX,nBasis);}
\DoxyCodeLine{2957 }
\DoxyCodeLine{2958 }
\DoxyCodeLine{2959 }
\DoxyCodeLine{2960         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{2961            matList[XSSMS].AX,nBasis,matList[XSSMS].AX,nBasis);}
\DoxyCodeLine{2962 }
\DoxyCodeLine{2963         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{2964            matList[XSSMX].AX,nBasis,matList[XSSMX].AX,nBasis);}
\DoxyCodeLine{2965 }
\DoxyCodeLine{2966         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{2967            matList[XSSMY].AX,nBasis,matList[XSSMY].AX,nBasis);}
\DoxyCodeLine{2968 }
\DoxyCodeLine{2969         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{2970            matList[XSSMZ].AX,nBasis,matList[XSSMZ].AX,nBasis);}
\DoxyCodeLine{2971 }
\DoxyCodeLine{2972 }
\DoxyCodeLine{2973 }
\DoxyCodeLine{2974         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{2975            matList[CLSMS].AX,nBasis,matList[CLSMS].AX,nBasis);}
\DoxyCodeLine{2976 }
\DoxyCodeLine{2977         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{2978            matList[CLSMX].AX,nBasis,matList[CLSMX].AX,nBasis);}
\DoxyCodeLine{2979 }
\DoxyCodeLine{2980         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{2981            matList[CLSMY].AX,nBasis,matList[CLSMY].AX,nBasis);}
\DoxyCodeLine{2982 }
\DoxyCodeLine{2983         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{2984            matList[CLSMZ].AX,nBasis,matList[CLSMZ].AX,nBasis);}
\DoxyCodeLine{2985  }
\DoxyCodeLine{2986 }
\DoxyCodeLine{2987   }
\DoxyCodeLine{2988         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{2989            matList[XLSMS].AX,nBasis,matList[XLSMS].AX,nBasis);}
\DoxyCodeLine{2990 }
\DoxyCodeLine{2991         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{2992            matList[XLSMX].AX,nBasis,matList[XLSMX].AX,nBasis);}
\DoxyCodeLine{2993 }
\DoxyCodeLine{2994         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{2995            matList[XLSMY].AX,nBasis,matList[XLSMY].AX,nBasis);}
\DoxyCodeLine{2996 }
\DoxyCodeLine{2997         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{2998            matList[XLSMZ].AX,nBasis,matList[XLSMZ].AX,nBasis);}
\DoxyCodeLine{2999   }
\DoxyCodeLine{3000       \};}
\DoxyCodeLine{3001    }
\DoxyCodeLine{3002       memManager\_.free(ERIBuffer);}
\DoxyCodeLine{3003       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{3004 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{3005       \textcolor{keywordflow}{if}(ShBlkNorms\_raw!=\textcolor{keyword}{nullptr}) memManager\_.free(ShBlkNorms\_raw);}
\DoxyCodeLine{3006       \textcolor{keywordflow}{if}(SchwarzGaunt!=\textcolor{keyword}{nullptr}) memManager\_.free(SchwarzGaunt);}
\DoxyCodeLine{3007 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3008   }
\DoxyCodeLine{3009 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{3010       \textcolor{keywordtype}{size\_t} nIntSkipGaunt = std::accumulate(nSkipGaunt.begin(),nSkipGaunt.end(),0);}
\DoxyCodeLine{3011       std::cout << \textcolor{stringliteral}{"{}Gaunt Screened "{}} << nIntSkipGaunt << std::endl;}
\DoxyCodeLine{3012   }
\DoxyCodeLine{3013       \textcolor{keyword}{auto} durDirectGaunt = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topDirectGaunt);}
\DoxyCodeLine{3014       std::cout << \textcolor{stringliteral}{"{}Gaunt AO Direct Contraction took "{}} <<  durDirectGaunt << \textcolor{stringliteral}{"{} s\(\backslash\)n"{}}; }
\DoxyCodeLine{3015   }
\DoxyCodeLine{3016       std::cout << std::endl;}
\DoxyCodeLine{3017 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3018 }
\DoxyCodeLine{3019     \} \textcolor{comment}{// if(Gaunt)}}
\DoxyCodeLine{3020 }
\DoxyCodeLine{3021 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{3022     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{3023     \textcolor{comment}{/*   End of Gaunt  */}}
\DoxyCodeLine{3024     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{3025 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{3026 }
\DoxyCodeLine{3027 }
\DoxyCodeLine{3028 }
\DoxyCodeLine{3029 }
\DoxyCodeLine{3030 }
\DoxyCodeLine{3031 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{3032     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{3033     \textcolor{comment}{/* Start of Gauge  */}}
\DoxyCodeLine{3034     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{3035 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{3036 }
\DoxyCodeLine{3037     \textcolor{keywordflow}{if}( matList[0].contType == \mbox{\hyperlink{namespaceChronusQ_a14bbb7fd8ce60d0c69d4985cd7d9c4cba01337b51d63cd7bba6d5daf63ff8d911}{TWOBODY\_CONTRACTION\_TYPE::GAUGE}} ) \{}
\DoxyCodeLine{3038 }
\DoxyCodeLine{3039       \textcolor{keyword}{enum} Gauge\_ERI \{}
\DoxyCodeLine{3040         SxSx, \textcolor{comment}{// σ\_x * σ\_x     0}}
\DoxyCodeLine{3041         SySx, \textcolor{comment}{// σ\_y * σ\_x     1}}
\DoxyCodeLine{3042         SzSx, \textcolor{comment}{// σ\_z * σ\_x     2}}
\DoxyCodeLine{3043         ISx,  \textcolor{comment}{// I   * σ\_x     3}}
\DoxyCodeLine{3044         SxSy, \textcolor{comment}{// σ\_x * σ\_y     4}}
\DoxyCodeLine{3045         SySy, \textcolor{comment}{// σ\_y * σ\_y     5}}
\DoxyCodeLine{3046         SzSy, \textcolor{comment}{// σ\_z * σ\_y     6}}
\DoxyCodeLine{3047         ISy,  \textcolor{comment}{// I   * σ\_y     7}}
\DoxyCodeLine{3048         SxSz, \textcolor{comment}{// σ\_x * σ\_z     8}}
\DoxyCodeLine{3049         SySz, \textcolor{comment}{// σ\_y * σ\_z     9}}
\DoxyCodeLine{3050         SzSz, \textcolor{comment}{// σ\_z * σ\_z     10}}
\DoxyCodeLine{3051         ISz,  \textcolor{comment}{// I   * σ\_z     11}}
\DoxyCodeLine{3052         SxI,  \textcolor{comment}{// σ\_x * I       12}}
\DoxyCodeLine{3053         SyI,  \textcolor{comment}{// σ\_y * I       13}}
\DoxyCodeLine{3054         SzI,  \textcolor{comment}{// σ\_z * I       14}}
\DoxyCodeLine{3055         II    \textcolor{comment}{// I   * I       15}}
\DoxyCodeLine{3056       \};}
\DoxyCodeLine{3057   }
\DoxyCodeLine{3058       \textcolor{keyword}{auto} NB4\_4  = 4*NB4;  }
\DoxyCodeLine{3059       \textcolor{keyword}{auto} NB4\_5  = 5*NB4;  }
\DoxyCodeLine{3060       \textcolor{keyword}{auto} NB4\_6  = 6*NB4;  }
\DoxyCodeLine{3061       \textcolor{keyword}{auto} NB4\_7  = 7*NB4;  }
\DoxyCodeLine{3062       \textcolor{keyword}{auto} NB4\_8  = 8*NB4;  }
\DoxyCodeLine{3063       \textcolor{keyword}{auto} NB4\_9  = 9*NB4;  }
\DoxyCodeLine{3064       \textcolor{keyword}{auto} NB4\_10 =10*NB4;  }
\DoxyCodeLine{3065       \textcolor{keyword}{auto} NB4\_11 =11*NB4;  }
\DoxyCodeLine{3066       \textcolor{keyword}{auto} NB4\_12 =12*NB4;  }
\DoxyCodeLine{3067       \textcolor{keyword}{auto} NB4\_13 =13*NB4;  }
\DoxyCodeLine{3068       \textcolor{keyword}{auto} NB4\_14 =14*NB4;  }
\DoxyCodeLine{3069       \textcolor{keyword}{auto} NB4\_15 =15*NB4;  }
\DoxyCodeLine{3070       \textcolor{keyword}{auto} NB4\_16 =16*NB4;  }
\DoxyCodeLine{3071       \textcolor{keyword}{auto} NB4\_17 =17*NB4;  }
\DoxyCodeLine{3072       \textcolor{keyword}{auto} NB4\_18 =18*NB4;  }
\DoxyCodeLine{3073       \textcolor{keyword}{auto} NB4\_19 =19*NB4;  }
\DoxyCodeLine{3074       \textcolor{keyword}{auto} NB4\_20 =20*NB4;  }
\DoxyCodeLine{3075       \textcolor{keyword}{auto} NB4\_21 =21*NB4;  }
\DoxyCodeLine{3076       \textcolor{keyword}{auto} NB4\_22 =22*NB4;  }
\DoxyCodeLine{3077       \textcolor{keyword}{auto} NB4\_23 =23*NB4;  }
\DoxyCodeLine{3078       \textcolor{keyword}{auto} NB4\_24 =24*NB4;  }
\DoxyCodeLine{3079       \textcolor{keyword}{auto} NB4\_25 =25*NB4;  }
\DoxyCodeLine{3080 }
\DoxyCodeLine{3081       \textcolor{keyword}{auto} ss = 0     ;        \textcolor{comment}{// ERI00 (ss)(ij|kl)}}
\DoxyCodeLine{3082       \textcolor{keyword}{auto} sx = NB4   ;        \textcolor{comment}{// ERI01 (sσ)\_x(ijkl)}}
\DoxyCodeLine{3083       \textcolor{keyword}{auto} sy = NB4\_2 ;        \textcolor{comment}{// ERI02 (sσ)\_y(ijkl)}}
\DoxyCodeLine{3084       \textcolor{keyword}{auto} sz = NB4\_3 ;        \textcolor{comment}{// ERI03 (sσ)\_z(ijkl)}}
\DoxyCodeLine{3085       \textcolor{keyword}{auto} xs = NB4\_4 ;        \textcolor{comment}{// ERI04 (σs)\_x(ijkl)}}
\DoxyCodeLine{3086       \textcolor{keyword}{auto} ys = NB4\_5 ;        \textcolor{comment}{// ERI05 (σs)\_y(ijkl)}}
\DoxyCodeLine{3087       \textcolor{keyword}{auto} zs = NB4\_6 ;        \textcolor{comment}{// ERI06 (σs)\_z(ijkl)}}
\DoxyCodeLine{3088       \textcolor{keyword}{auto} \mbox{\hyperlink{namespaceChronusQ_a208436762fbd254ff0fa550f917b96fe}{dot}} = NB4\_7 ;       \textcolor{comment}{// ERI07 (σ∙σ)(ijkl)}}
\DoxyCodeLine{3089       \textcolor{keyword}{auto} crossx = NB4\_8 ;    \textcolor{comment}{// ERI08 (σxσ)\_x(ijkl)}}
\DoxyCodeLine{3090       \textcolor{keyword}{auto} crossy = NB4\_9 ;    \textcolor{comment}{// ERI09 (σxσ)\_y(ijkl)}}
\DoxyCodeLine{3091       \textcolor{keyword}{auto} crossz = NB4\_10;    \textcolor{comment}{// ERI10 (σxσ)\_z(ijkl)}}
\DoxyCodeLine{3092       \textcolor{keyword}{auto} pxxmyymzz = NB4\_11; \textcolor{comment}{// ERI11 (σσ)(xx -\/ yy -\/ zz)(ijkl)}}
\DoxyCodeLine{3093       \textcolor{keyword}{auto} mxxpyymzz = NB4\_12; \textcolor{comment}{// ERI12 (σσ)(-\/xx + yy -\/ zz)(ijkl)}}
\DoxyCodeLine{3094       \textcolor{keyword}{auto} mxxmyypzz = NB4\_13; \textcolor{comment}{// ERI13 (σσ)(-\/xx -\/ yy + zz)(ijkl)}}
\DoxyCodeLine{3095       \textcolor{keyword}{auto} xypyx = NB4\_14;     \textcolor{comment}{// ERI14 (σ\_x σ\_y + σ\_y σ\_x)(ijkl)}}
\DoxyCodeLine{3096       \textcolor{keyword}{auto} zxpxz = NB4\_15;     \textcolor{comment}{// ERI15 (σ\_z σ\_x + σ\_x σ\_z)(ijkl)}}
\DoxyCodeLine{3097       \textcolor{keyword}{auto} yzpzy = NB4\_16;     \textcolor{comment}{// ERI16 (σ\_y σ\_z + σ\_z σ\_y)(ijkl)}}
\DoxyCodeLine{3098       \textcolor{keyword}{auto} xx = NB4\_17;        \textcolor{comment}{// ERI17 (σ\_x σ\_x)(ijkl)}}
\DoxyCodeLine{3099       \textcolor{keyword}{auto} xy = NB4\_18;        \textcolor{comment}{// ERI18 (σ\_x σ\_y)(ijkl)}}
\DoxyCodeLine{3100       \textcolor{keyword}{auto} xz = NB4\_19;        \textcolor{comment}{// ERI19 (σ\_x σ\_z)(ijkl)}}
\DoxyCodeLine{3101       \textcolor{keyword}{auto} yx = NB4\_20;        \textcolor{comment}{// ERI20 (σ\_y σ\_x)(ijkl)}}
\DoxyCodeLine{3102       \textcolor{keyword}{auto} yy = NB4\_21;        \textcolor{comment}{// ERI21 (σ\_y σ\_y)(ijkl)}}
\DoxyCodeLine{3103       \textcolor{keyword}{auto} yz = NB4\_22;        \textcolor{comment}{// ERI22 (σ\_y σ\_z)(ijkl)}}
\DoxyCodeLine{3104       \textcolor{keyword}{auto} zx = NB4\_23;        \textcolor{comment}{// ERI23 (σ\_z σ\_x)(ijkl)}}
\DoxyCodeLine{3105       \textcolor{keyword}{auto} zy = NB4\_24;        \textcolor{comment}{// ERI24 (σ\_z σ\_y)(ijkl)}}
\DoxyCodeLine{3106       \textcolor{keyword}{auto} zz = NB4\_25;        \textcolor{comment}{// ERI25 (σ\_z σ\_z)(ijkl)}}
\DoxyCodeLine{3107    }
\DoxyCodeLine{3108 }
\DoxyCodeLine{3109 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{3110       \textcolor{keyword}{auto} topDirectGauge = \mbox{\hyperlink{namespaceChronusQ_a715f671201f0f6e77216fcf1f72adbaf}{tick}}();}
\DoxyCodeLine{3111 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3112 }
\DoxyCodeLine{3113       nERI = 16;}
\DoxyCodeLine{3114       buffAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(2*nERI*buffN4*nThreads);}
\DoxyCodeLine{3115       cacheAll = memManager\_.malloc<\textcolor{keywordtype}{double}>(cache\_size*nThreads);}
\DoxyCodeLine{3116 }
\DoxyCodeLine{3117 }
\DoxyCodeLine{3118 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{3119   }
\DoxyCodeLine{3120       \textcolor{keywordtype}{double} *SchwarzGauge = memManager\_.malloc<\textcolor{keywordtype}{double}>(nShell*nShell);}
\DoxyCodeLine{3121       memset(SchwarzGauge,0,nShell*nShell*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{3122   }
\DoxyCodeLine{3123 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{3124       \{}
\DoxyCodeLine{3125   }
\DoxyCodeLine{3126         \textcolor{keywordtype}{double} C1 = 1./(2*\mbox{\hyperlink{namespaceChronusQ_a387c8ccd4e18ad322b87f75f51fd008d}{SpeedOfLight}});}
\DoxyCodeLine{3127         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{3128         \textcolor{keywordtype}{size\_t} n1,n2;}
\DoxyCodeLine{3129         \textcolor{keywordtype}{int} skiperi1,skiperi2;}
\DoxyCodeLine{3130   }
\DoxyCodeLine{3131         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{3132         \textcolor{keywordtype}{double} *buffr1 = buffAll+nERI*buffN4*thread\_id;}
\DoxyCodeLine{3133         \textcolor{keywordtype}{double} *buffr2 = buffAll+nERI*nThreads*buffN4+nERI*buffN4*thread\_id;}
\DoxyCodeLine{3134         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{3135   }
\DoxyCodeLine{3136         \textcolor{comment}{// set up Schwarz screening}}
\DoxyCodeLine{3137         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s12(0); s1 < nShell; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{3138   }
\DoxyCodeLine{3139           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{3140   }
\DoxyCodeLine{3141         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 < nShell; bf2\_s+=n2, s2++, s12++) \{}
\DoxyCodeLine{3142   }
\DoxyCodeLine{3143           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{3144   }
\DoxyCodeLine{3145           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{3146 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{3147           \textcolor{keywordflow}{if}( s12 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{3148 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{3149   }
\DoxyCodeLine{3150           shls[0] = int(s1);}
\DoxyCodeLine{3151           shls[1] = int(s2);}
\DoxyCodeLine{3152           shls[2] = int(s1);}
\DoxyCodeLine{3153           shls[3] = int(s2);}
\DoxyCodeLine{3154   }
\DoxyCodeLine{3155           \textcolor{keyword}{auto} nQuad = n1*n2*n1*n2;}
\DoxyCodeLine{3156 }
\DoxyCodeLine{3157           \textcolor{comment}{//∇A∇C}}
\DoxyCodeLine{3158           \textcolor{comment}{//int2e\_gauge\_r1\_sps1sps2\_sph(buffr1, nullptr, shls, atm, nAtoms, bas, nShells, env, nullptr, cache);}}
\DoxyCodeLine{3159           \textcolor{comment}{//int2e\_gauge\_r2\_sps1sps2\_sph(buffr2, nullptr, shls, atm, nAtoms, bas, nShells, env, nullptr, cache);}}
\DoxyCodeLine{3160           }
\DoxyCodeLine{3161           \textcolor{comment}{//∇B∇D}}
\DoxyCodeLine{3162           skiperi1 = int2e\_gauge\_r1\_ssp1ssp2\_sph(buffr1, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache);}
\DoxyCodeLine{3163           skiperi2 = int2e\_gauge\_r2\_ssp1ssp2\_sph(buffr2, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache);}
\DoxyCodeLine{3164 }
\DoxyCodeLine{3165           \textcolor{keywordflow}{if}(skiperi1==0 and skiperi2==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{3166 }
\DoxyCodeLine{3167           \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} iERI(0); iERI < nERI*nQuad; iERI++) }
\DoxyCodeLine{3168               SchwarzGauge[s1+s2*nShell] = std::max(SchwarzGauge[s1+s2*nShell], std::abs(buffr1[iERI]-\/buffr2[iERI]));}
\DoxyCodeLine{3169   }
\DoxyCodeLine{3170           SchwarzGauge[s1+s2*nShell] = C1*std::sqrt(SchwarzGauge[s1+s2*nShell]);}
\DoxyCodeLine{3171   }
\DoxyCodeLine{3172         \}}
\DoxyCodeLine{3173         \}}
\DoxyCodeLine{3174   }
\DoxyCodeLine{3175       \};}
\DoxyCodeLine{3176 }
\DoxyCodeLine{3177   }
\DoxyCodeLine{3178 }
\DoxyCodeLine{3179       \textcolor{comment}{// Compute shell block norms (∞-\/norm) of matList.X}}
\DoxyCodeLine{3180       \textcolor{keywordtype}{int} mMat = 16;}
\DoxyCodeLine{3181       \textcolor{keywordtype}{double} *ShBlkNorms\_raw = memManager\_.malloc<\textcolor{keywordtype}{double}>(mMat*nShell*nShell);}
\DoxyCodeLine{3182       std::vector<double*> ShBlkNorms;}
\DoxyCodeLine{3183   }
\DoxyCodeLine{3184       \textcolor{keyword}{auto} iOff = 0;}
\DoxyCodeLine{3185       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3186       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3187   }
\DoxyCodeLine{3188       iOff += nShell*nShell;}
\DoxyCodeLine{3189       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3190       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3191   }
\DoxyCodeLine{3192       iOff += nShell*nShell;}
\DoxyCodeLine{3193       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3194       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3195   }
\DoxyCodeLine{3196       iOff += nShell*nShell;}
\DoxyCodeLine{3197       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLSMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3198       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3199 }
\DoxyCodeLine{3200       iOff += nShell*nShell;}
\DoxyCodeLine{3201       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3202       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3203   }
\DoxyCodeLine{3204       iOff += nShell*nShell;}
\DoxyCodeLine{3205       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3206       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3207   }
\DoxyCodeLine{3208       iOff += nShell*nShell;}
\DoxyCodeLine{3209       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3210       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3211   }
\DoxyCodeLine{3212       iOff += nShell*nShell;}
\DoxyCodeLine{3213       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSLMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3214       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3215 }
\DoxyCodeLine{3216       iOff += nShell*nShell;}
\DoxyCodeLine{3217       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3218       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3219   }
\DoxyCodeLine{3220       iOff += nShell*nShell;}
\DoxyCodeLine{3221       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3222       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3223   }
\DoxyCodeLine{3224       iOff += nShell*nShell;}
\DoxyCodeLine{3225       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3226       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3227   }
\DoxyCodeLine{3228       iOff += nShell*nShell;}
\DoxyCodeLine{3229       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XLLMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3230       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3231  }
\DoxyCodeLine{3232       iOff += nShell*nShell;}
\DoxyCodeLine{3233       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMS].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3234       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3235   }
\DoxyCodeLine{3236       iOff += nShell*nShell;}
\DoxyCodeLine{3237       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMX].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3238       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3239   }
\DoxyCodeLine{3240       iOff += nShell*nShell;}
\DoxyCodeLine{3241       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMY].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3242       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3243   }
\DoxyCodeLine{3244       iOff += nShell*nShell;}
\DoxyCodeLine{3245       \mbox{\hyperlink{namespaceChronusQ_ade3d6fad69f4d04c7a642580c77ddb1b}{ShellBlockNorm}}(basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}},matList[XSSMZ].X,nBasis,ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3246       ShBlkNorms.emplace\_back(ShBlkNorms\_raw + iOff);}
\DoxyCodeLine{3247   }
\DoxyCodeLine{3248       \textcolor{comment}{// Get the max over all the matricies for the shell block ∞-\/norms}}
\DoxyCodeLine{3249       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} k = 0; k < nShell*nShell; k++) \{}
\DoxyCodeLine{3250   }
\DoxyCodeLine{3251         \textcolor{keywordtype}{double} mx = std::abs(ShBlkNorms[0][k]);}
\DoxyCodeLine{3252         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} iMat = 0; iMat < mMat; iMat++)}
\DoxyCodeLine{3253           mx = std::max(mx,std::abs(ShBlkNorms[iMat][k]));}
\DoxyCodeLine{3254         ShBlkNorms[0][k] = mx;}
\DoxyCodeLine{3255    }
\DoxyCodeLine{3256       \}}
\DoxyCodeLine{3257 }
\DoxyCodeLine{3258 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3259 }
\DoxyCodeLine{3260       \textcolor{keywordtype}{int} nSave = 26;}
\DoxyCodeLine{3261       ERIBuffer = memManager\_.malloc<\textcolor{keywordtype}{double}>(nSave*NB4*nThreads);}
\DoxyCodeLine{3262       memset(AXRaw,0,nThreads*nMat*nBasis*nBasis*\textcolor{keyword}{sizeof}(MatsT));}
\DoxyCodeLine{3263       std::vector<size\_t> nSkipGauge(nThreads,0);}
\DoxyCodeLine{3264   }
\DoxyCodeLine{3265 \textcolor{preprocessor}{      \#pragma omp parallel}}
\DoxyCodeLine{3266       \{}
\DoxyCodeLine{3267   }
\DoxyCodeLine{3268         \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}} iS = \mbox{\hyperlink{chronusq__sys_8hpp_aa7b4cfa83fe868296abd1ba4d67d9563}{dcomplex}}(0.0, 1.0);}
\DoxyCodeLine{3269   }
\DoxyCodeLine{3270         \textcolor{keywordtype}{size\_t} thread\_id = \mbox{\hyperlink{namespaceChronusQ_aa348a017ee78c3450480773ddc542e5c}{GetThreadID}}();}
\DoxyCodeLine{3271   }
\DoxyCodeLine{3272         \textcolor{keyword}{auto} \&AX\_loc = AXthreads[thread\_id];}
\DoxyCodeLine{3273   }
\DoxyCodeLine{3274         \textcolor{keywordtype}{double} *BC   = \&ERIBuffer[thread\_id*nSave*NB4];}
\DoxyCodeLine{3275   }
\DoxyCodeLine{3276         \textcolor{keywordtype}{size\_t} n1,n2,n3,n4,m,n,k,l,mnkl,bf1,bf2,bf3,bf4;}
\DoxyCodeLine{3277         \textcolor{keywordtype}{size\_t} s4\_max;}
\DoxyCodeLine{3278 }
\DoxyCodeLine{3279         \textcolor{keywordtype}{int} skiperi1,skiperi2;}
\DoxyCodeLine{3280   }
\DoxyCodeLine{3281         \textcolor{keywordtype}{int} shls[4];}
\DoxyCodeLine{3282         \textcolor{keywordtype}{double} *buffr1 = buffAll+nERI*buffN4*thread\_id;}
\DoxyCodeLine{3283         \textcolor{keywordtype}{double} *buffr2 = buffAll+nERI*nThreads*buffN4+nERI*buffN4*thread\_id;}
\DoxyCodeLine{3284         \textcolor{keywordtype}{double} *cache = cacheAll+cache\_size*thread\_id;}
\DoxyCodeLine{3285   }
\DoxyCodeLine{3286         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s1(0), bf1\_s(0), s1234(0); s1 < nShell; bf1\_s+=n1, s1++) \{ }
\DoxyCodeLine{3287   }
\DoxyCodeLine{3288           n1 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s1].size(); \textcolor{comment}{// Size of Shell 1}}
\DoxyCodeLine{3289   }
\DoxyCodeLine{3290         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s2(0), bf2\_s(0); s2 < nShell; bf2\_s+=n2, s2++) \{}
\DoxyCodeLine{3291   }
\DoxyCodeLine{3292           n2 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s2].size(); \textcolor{comment}{// Size of Shell 2}}
\DoxyCodeLine{3293   }
\DoxyCodeLine{3294 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{3295           \textcolor{keywordtype}{double} shMax12 = ShBlkNorms[0][s2 + s1*nShell];}
\DoxyCodeLine{3296 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3297   }
\DoxyCodeLine{3298         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s3(0), bf3\_s(0); s3 <= s2 ; bf3\_s+=n3, s3++) \{}
\DoxyCodeLine{3299         \textcolor{comment}{//for(size\_t s3(0), bf3\_s(0); s3 < nShell ; bf3\_s+=n3, s3++) \{}}
\DoxyCodeLine{3300   }
\DoxyCodeLine{3301           n3 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s3].size(); \textcolor{comment}{// Size of Shell 3}}
\DoxyCodeLine{3302           s4\_max = (s2 == s3) ? s1 : nShell-\/1; \textcolor{comment}{// Determine the unique max of Shell 4}}
\DoxyCodeLine{3303   }
\DoxyCodeLine{3304 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{3305           \textcolor{keywordtype}{double} shMax123 = std::max(ShBlkNorms[0][s1 + s3*nShell], ShBlkNorms[0][s2 + s3*nShell]);}
\DoxyCodeLine{3306           shMax123 = std::max(shMax123,shMax12);}
\DoxyCodeLine{3307 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3308    }
\DoxyCodeLine{3309   }
\DoxyCodeLine{3310         \textcolor{comment}{//for(size\_t s4(0), bf4\_s(0); s4 < nShell; bf4\_s+=n4, s4++, s1234++) \{}}
\DoxyCodeLine{3311         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} s4(0), bf4\_s(0); s4 <= s4\_max; bf4\_s+=n4, s4++, s1234++) \{}
\DoxyCodeLine{3312   }
\DoxyCodeLine{3313           n4 = basisSet\_.\mbox{\hyperlink{structChronusQ_1_1BasisSet_a9be2da981037c46350e698aa0c179330}{shells}}[s4].size(); \textcolor{comment}{// Size of Shell 4}}
\DoxyCodeLine{3314   }
\DoxyCodeLine{3315           \textcolor{comment}{// Round Robbin work distribution}}
\DoxyCodeLine{3316 \textcolor{preprocessor}{          \#ifdef \_OPENMP}}
\DoxyCodeLine{3317           \textcolor{keywordflow}{if}( s1234 \% nThreads != thread\_id ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{3318 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{3319   }
\DoxyCodeLine{3320 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{3321   }
\DoxyCodeLine{3322           \textcolor{keywordtype}{double} shMax = std::max(ShBlkNorms[0][s1 + s4*nShell],}
\DoxyCodeLine{3323                                   std::max(ShBlkNorms[0][s2 + s4*nShell],}
\DoxyCodeLine{3324                                            ShBlkNorms[0][s3 + s4*nShell]));}
\DoxyCodeLine{3325   }
\DoxyCodeLine{3326           shMax = std::max(shMax,shMax123);}
\DoxyCodeLine{3327 }
\DoxyCodeLine{3328           \textcolor{keywordflow}{if}((shMax*SchwarzGauge[s1+s2*nShell]*SchwarzGauge[s4+s3*nShell]) <}
\DoxyCodeLine{3329              eri.\mbox{\hyperlink{classChronusQ_1_1DirectTPI_a51ce753ee588706401406d4216c1ba74}{threshSchwarz}}()) \{ nSkipGauge[thread\_id]++; \textcolor{keywordflow}{continue}; \}}
\DoxyCodeLine{3330 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3331   }
\DoxyCodeLine{3332   }
\DoxyCodeLine{3333           shls[0] = int(s1);}
\DoxyCodeLine{3334           shls[1] = int(s2);}
\DoxyCodeLine{3335           shls[2] = int(s3);}
\DoxyCodeLine{3336           shls[3] = int(s4);}
\DoxyCodeLine{3337 }
\DoxyCodeLine{3338           \textcolor{comment}{//∇B∇C}}
\DoxyCodeLine{3339           skiperi1 = int2e\_gauge\_r1\_ssp1sps2\_sph(buffr1, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache);}
\DoxyCodeLine{3340           skiperi2 = int2e\_gauge\_r2\_ssp1sps2\_sph(buffr2, \textcolor{keyword}{nullptr}, shls, atm, nAtoms, bas, nShells, env, \textcolor{keyword}{nullptr}, cache);}
\DoxyCodeLine{3341 }
\DoxyCodeLine{3342           \textcolor{keywordflow}{if}(skiperi1==0 and skiperi2==0) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{3343 }
\DoxyCodeLine{3344           \textcolor{keyword}{auto} nQuad = n1*n2*n3*n4;}
\DoxyCodeLine{3345 }
\DoxyCodeLine{3346           mnkl = 0ul;}
\DoxyCodeLine{3347           \textcolor{keywordflow}{for}(l = 3*maxShellSize; l < 3*maxShellSize + n4; ++l) }
\DoxyCodeLine{3348           \textcolor{keywordflow}{for}(k = 2*maxShellSize; k < 2*maxShellSize + n3; ++k) }
\DoxyCodeLine{3349           \textcolor{keywordflow}{for}(n =   maxShellSize; n <   maxShellSize + n2; ++n)}
\DoxyCodeLine{3350           \textcolor{keywordflow}{for}(m = 0             ; m <                  n1; ++m) \{}
\DoxyCodeLine{3351 }
\DoxyCodeLine{3352             \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{3353             \textcolor{keyword}{auto} LKNM = l + k*NB + n*NB2 + m*NB3;}
\DoxyCodeLine{3354 }
\DoxyCodeLine{3355             \textcolor{comment}{//enum Gauge\_ERI \{}}
\DoxyCodeLine{3356             \textcolor{comment}{//  SxSx,  // σ\_x * σ\_x     0}}
\DoxyCodeLine{3357             \textcolor{comment}{//  SySx,  // σ\_y * σ\_x     1}}
\DoxyCodeLine{3358             \textcolor{comment}{//  SzSx,  // σ\_z * σ\_x     2}}
\DoxyCodeLine{3359             \textcolor{comment}{//  ISx,   // I   * σ\_x     3}}
\DoxyCodeLine{3360             \textcolor{comment}{//  SxSy,  // σ\_x * σ\_y     4}}
\DoxyCodeLine{3361             \textcolor{comment}{//  SySy,  // σ\_y * σ\_y     5}}
\DoxyCodeLine{3362             \textcolor{comment}{//  SzSy,  // σ\_z * σ\_y     6}}
\DoxyCodeLine{3363             \textcolor{comment}{//  ISy,   // I   * σ\_y     7}}
\DoxyCodeLine{3364             \textcolor{comment}{//  SxSz,  // σ\_x * σ\_z     8}}
\DoxyCodeLine{3365             \textcolor{comment}{//  SySz,  // σ\_y * σ\_z     9}}
\DoxyCodeLine{3366             \textcolor{comment}{//  SzSz,  // σ\_z * σ\_z     10}}
\DoxyCodeLine{3367             \textcolor{comment}{//  ISz,   // I   * σ\_z     11}}
\DoxyCodeLine{3368             \textcolor{comment}{//  SxI,   // σ\_x * I       12}}
\DoxyCodeLine{3369             \textcolor{comment}{//  SyI,   // σ\_y * I       13}}
\DoxyCodeLine{3370             \textcolor{comment}{//  SzI,   // σ\_z * I       14}}
\DoxyCodeLine{3371             \textcolor{comment}{//  II     // I   * I       15}}
\DoxyCodeLine{3372             \textcolor{comment}{//\};}}
\DoxyCodeLine{3373             }
\DoxyCodeLine{3374             \textcolor{comment}{// (ss)}}
\DoxyCodeLine{3375             BC[MNKL] = buffr1[15*nQuad+mnkl] -\/ buffr2[15*nQuad+mnkl];}
\DoxyCodeLine{3376             BC[LKNM] = buffr1[15*nQuad+mnkl] -\/ buffr2[15*nQuad+mnkl];}
\DoxyCodeLine{3377             }
\DoxyCodeLine{3378             \textcolor{comment}{// (sσ)\_x}}
\DoxyCodeLine{3379             BC[NB4+MNKL] = buffr1[3*nQuad+mnkl] -\/ buffr2[3*nQuad+mnkl];}
\DoxyCodeLine{3380             BC[NB4+LKNM] = buffr2[12*nQuad+mnkl] -\/ buffr1[12*nQuad+mnkl];}
\DoxyCodeLine{3381             }
\DoxyCodeLine{3382             \textcolor{comment}{// (sσ)\_y}}
\DoxyCodeLine{3383             BC[NB4\_2+MNKL] = buffr1[7*nQuad+mnkl] -\/ buffr2[7*nQuad+mnkl];}
\DoxyCodeLine{3384             BC[NB4\_2+LKNM] = buffr2[13*nQuad+mnkl] -\/ buffr1[13*nQuad+mnkl];}
\DoxyCodeLine{3385             }
\DoxyCodeLine{3386             \textcolor{comment}{// (sσ)\_z}}
\DoxyCodeLine{3387             BC[NB4\_3+MNKL] = buffr1[11*nQuad+mnkl] -\/ buffr2[11*nQuad+mnkl];}
\DoxyCodeLine{3388             BC[NB4\_3+LKNM] = buffr2[14*nQuad+mnkl] -\/ buffr1[14*nQuad+mnkl];}
\DoxyCodeLine{3389             }
\DoxyCodeLine{3390             \textcolor{comment}{// (σs)\_x}}
\DoxyCodeLine{3391             BC[NB4\_4+MNKL] = buffr1[12*nQuad+mnkl] -\/ buffr2[12*nQuad+mnkl];}
\DoxyCodeLine{3392             BC[NB4\_4+LKNM] = buffr2[3*nQuad+mnkl] -\/ buffr1[3*nQuad+mnkl];}
\DoxyCodeLine{3393             }
\DoxyCodeLine{3394             \textcolor{comment}{// (σs)\_y}}
\DoxyCodeLine{3395             BC[NB4\_5+MNKL] = buffr1[13*nQuad+mnkl] -\/ buffr2[13*nQuad+mnkl];}
\DoxyCodeLine{3396             BC[NB4\_5+LKNM] = buffr2[7*nQuad+mnkl] -\/ buffr1[7*nQuad+mnkl];}
\DoxyCodeLine{3397             }
\DoxyCodeLine{3398             \textcolor{comment}{// (σs)\_z}}
\DoxyCodeLine{3399             BC[NB4\_6+MNKL] = buffr1[14*nQuad+mnkl] -\/ buffr2[14*nQuad+mnkl];}
\DoxyCodeLine{3400             BC[NB4\_6+LKNM] = buffr2[11*nQuad+mnkl] -\/ buffr1[11*nQuad+mnkl];}
\DoxyCodeLine{3401             }
\DoxyCodeLine{3402             \textcolor{comment}{// (σ∙σ)}}
\DoxyCodeLine{3403             BC[NB4\_7+MNKL] =-\/(buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3404                             -\/(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3405                             -\/(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3406             BC[NB4\_7+LKNM] =-\/(buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3407                             -\/(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3408                             -\/(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3409             }
\DoxyCodeLine{3410             \textcolor{comment}{// (σxσ)\_x = σ\_y*σ\_z -\/ σ\_z*σ\_y}}
\DoxyCodeLine{3411             BC[NB4\_8+MNKL] =-\/(buffr1[9*nQuad+mnkl] -\/ buffr2[9*nQuad+mnkl])}
\DoxyCodeLine{3412                             +(buffr1[6*nQuad+mnkl] -\/ buffr2[6*nQuad+mnkl]);}
\DoxyCodeLine{3413             BC[NB4\_8+LKNM] = (buffr1[9*nQuad+mnkl] -\/ buffr2[9*nQuad+mnkl])}
\DoxyCodeLine{3414                             -\/(buffr1[6*nQuad+mnkl] -\/ buffr2[6*nQuad+mnkl]);}
\DoxyCodeLine{3415             }
\DoxyCodeLine{3416             \textcolor{comment}{// (σxσ)\_y = σ\_z*σ\_x -\/ σ\_x*σ\_z}}
\DoxyCodeLine{3417             BC[NB4\_9+MNKL] =-\/(buffr1[2*nQuad+mnkl] -\/ buffr2[2*nQuad+mnkl])}
\DoxyCodeLine{3418                             +(buffr1[8*nQuad+mnkl] -\/ buffr2[8*nQuad+mnkl]);}
\DoxyCodeLine{3419             BC[NB4\_9+LKNM] = (buffr1[2*nQuad+mnkl] -\/ buffr2[2*nQuad+mnkl])}
\DoxyCodeLine{3420                             -\/(buffr1[8*nQuad+mnkl] -\/ buffr2[8*nQuad+mnkl]);}
\DoxyCodeLine{3421             }
\DoxyCodeLine{3422             \textcolor{comment}{// (σxσ)\_z = σ\_x*σ\_y -\/ σ\_y*σ\_x}}
\DoxyCodeLine{3423             BC[NB4\_10+MNKL] =-\/(buffr1[4*nQuad+mnkl] -\/ buffr2[4*nQuad+mnkl])}
\DoxyCodeLine{3424                              +(buffr1[1*nQuad+mnkl] -\/ buffr2[1*nQuad+mnkl]);}
\DoxyCodeLine{3425             BC[NB4\_10+LKNM] = (buffr1[4*nQuad+mnkl] -\/ buffr2[4*nQuad+mnkl])}
\DoxyCodeLine{3426                              -\/(buffr1[1*nQuad+mnkl] -\/ buffr2[1*nQuad+mnkl]);}
\DoxyCodeLine{3427             }
\DoxyCodeLine{3428             \textcolor{comment}{// (σσ) (xx -\/ yy -\/ zz)}}
\DoxyCodeLine{3429             BC[NB4\_11+MNKL] =-\/(buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3430                              +(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3431                              +(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3432             BC[NB4\_11+LKNM] =-\/(buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3433                              +(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3434                              +(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3435             }
\DoxyCodeLine{3436             \textcolor{comment}{// (σσ) (-\/xx + yy -\/ zz)}}
\DoxyCodeLine{3437             BC[NB4\_12+MNKL] = (buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3438                              -\/(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3439                              +(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3440             BC[NB4\_12+LKNM] = (buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3441                              -\/(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3442                              +(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3443             }
\DoxyCodeLine{3444             \textcolor{comment}{// (σσ) (-\/xx -\/ yy + zz)}}
\DoxyCodeLine{3445             BC[NB4\_13+MNKL] = (buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3446                              +(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3447                              -\/(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3448             BC[NB4\_13+LKNM] = (buffr1[mnkl] -\/ buffr2[mnkl])}
\DoxyCodeLine{3449                              +(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl])}
\DoxyCodeLine{3450                              -\/(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3451             }
\DoxyCodeLine{3452             \textcolor{comment}{//  σ\_x*σ\_y + σ\_y*σ\_x}}
\DoxyCodeLine{3453             BC[NB4\_14+MNKL] =-\/(buffr1[4*nQuad+mnkl] -\/ buffr2[4*nQuad+mnkl])}
\DoxyCodeLine{3454                              -\/(buffr1[1*nQuad+mnkl] -\/ buffr2[1*nQuad+mnkl]);}
\DoxyCodeLine{3455             BC[NB4\_14+LKNM] =-\/(buffr1[4*nQuad+mnkl] -\/ buffr2[4*nQuad+mnkl])}
\DoxyCodeLine{3456                              -\/(buffr1[1*nQuad+mnkl] -\/ buffr2[1*nQuad+mnkl]);}
\DoxyCodeLine{3457             }
\DoxyCodeLine{3458             \textcolor{comment}{//  σ\_z*σ\_x + σ\_x*σ\_z}}
\DoxyCodeLine{3459             BC[NB4\_15+MNKL] =-\/(buffr1[2*nQuad+mnkl] -\/ buffr2[2*nQuad+mnkl])}
\DoxyCodeLine{3460                              -\/(buffr1[8*nQuad+mnkl] -\/ buffr2[8*nQuad+mnkl]);}
\DoxyCodeLine{3461             BC[NB4\_15+LKNM] =-\/(buffr1[2*nQuad+mnkl] -\/ buffr2[2*nQuad+mnkl])}
\DoxyCodeLine{3462                              -\/(buffr1[8*nQuad+mnkl] -\/ buffr2[8*nQuad+mnkl]);}
\DoxyCodeLine{3463             }
\DoxyCodeLine{3464             \textcolor{comment}{//  σ\_y*σ\_z + σ\_z*σ\_y}}
\DoxyCodeLine{3465             BC[NB4\_16+MNKL] =-\/(buffr1[9*nQuad+mnkl] -\/ buffr2[9*nQuad+mnkl])}
\DoxyCodeLine{3466                              -\/(buffr1[6*nQuad+mnkl] -\/ buffr2[6*nQuad+mnkl]);}
\DoxyCodeLine{3467             BC[NB4\_16+LKNM] =-\/(buffr1[9*nQuad+mnkl] -\/ buffr2[9*nQuad+mnkl])}
\DoxyCodeLine{3468                              -\/(buffr1[6*nQuad+mnkl] -\/ buffr2[6*nQuad+mnkl]);}
\DoxyCodeLine{3469             }
\DoxyCodeLine{3470             \textcolor{comment}{// σ\_x*σ\_x}}
\DoxyCodeLine{3471             BC[NB4\_17+MNKL] = -\/(buffr1[mnkl] -\/ buffr2[mnkl]);}
\DoxyCodeLine{3472             BC[NB4\_17+LKNM] = -\/(buffr1[mnkl] -\/ buffr2[mnkl]);}
\DoxyCodeLine{3473             }
\DoxyCodeLine{3474             \textcolor{comment}{// σ\_x*σ\_y}}
\DoxyCodeLine{3475             BC[NB4\_18+MNKL] = -\/(buffr1[4*nQuad+mnkl] -\/ buffr2[4*nQuad+mnkl]);}
\DoxyCodeLine{3476             BC[NB4\_18+LKNM] = -\/(buffr1[1*nQuad+mnkl] -\/ buffr2[1*nQuad+mnkl]);}
\DoxyCodeLine{3477             }
\DoxyCodeLine{3478             \textcolor{comment}{// σ\_x*σ\_z}}
\DoxyCodeLine{3479             BC[NB4\_19+MNKL] = -\/(buffr1[8*nQuad+mnkl] -\/ buffr2[8*nQuad+mnkl]);}
\DoxyCodeLine{3480             BC[NB4\_19+LKNM] = -\/(buffr1[2*nQuad+mnkl] -\/ buffr2[2*nQuad+mnkl]);}
\DoxyCodeLine{3481             }
\DoxyCodeLine{3482             \textcolor{comment}{// σ\_y*σ\_x}}
\DoxyCodeLine{3483             BC[NB4\_20+MNKL] = -\/(buffr1[1*nQuad+mnkl] -\/ buffr2[1*nQuad+mnkl]);}
\DoxyCodeLine{3484             BC[NB4\_20+LKNM] = -\/(buffr1[4*nQuad+mnkl] -\/ buffr2[4*nQuad+mnkl]);}
\DoxyCodeLine{3485             }
\DoxyCodeLine{3486             \textcolor{comment}{// σ\_y*σ\_y}}
\DoxyCodeLine{3487             BC[NB4\_21+MNKL] = -\/(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl]);}
\DoxyCodeLine{3488             BC[NB4\_21+LKNM] = -\/(buffr1[5*nQuad+mnkl] -\/ buffr2[5*nQuad+mnkl]);}
\DoxyCodeLine{3489             }
\DoxyCodeLine{3490             \textcolor{comment}{// σ\_y*σ\_z}}
\DoxyCodeLine{3491             BC[NB4\_22+MNKL] = -\/(buffr1[9*nQuad+mnkl] -\/ buffr2[9*nQuad+mnkl]);}
\DoxyCodeLine{3492             BC[NB4\_22+LKNM] = -\/(buffr1[6*nQuad+mnkl] -\/ buffr2[6*nQuad+mnkl]);}
\DoxyCodeLine{3493             }
\DoxyCodeLine{3494             \textcolor{comment}{// σ\_z*σ\_x}}
\DoxyCodeLine{3495             BC[NB4\_23+MNKL] = -\/(buffr1[2*nQuad+mnkl] -\/ buffr2[2*nQuad+mnkl]);}
\DoxyCodeLine{3496             BC[NB4\_23+LKNM] = -\/(buffr1[8*nQuad+mnkl] -\/ buffr2[8*nQuad+mnkl]);}
\DoxyCodeLine{3497             }
\DoxyCodeLine{3498             \textcolor{comment}{// σ\_z*σ\_y}}
\DoxyCodeLine{3499             BC[NB4\_24+MNKL] = -\/(buffr1[6*nQuad+mnkl] -\/ buffr2[6*nQuad+mnkl]);}
\DoxyCodeLine{3500             BC[NB4\_24+LKNM] = -\/(buffr1[9*nQuad+mnkl] -\/ buffr2[9*nQuad+mnkl]);}
\DoxyCodeLine{3501             }
\DoxyCodeLine{3502             \textcolor{comment}{// σ\_z*σ\_z}}
\DoxyCodeLine{3503             BC[NB4\_25+MNKL] = -\/(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3504             BC[NB4\_25+LKNM] = -\/(buffr1[10*nQuad+mnkl] -\/ buffr2[10*nQuad+mnkl]);}
\DoxyCodeLine{3505             }
\DoxyCodeLine{3506             }
\DoxyCodeLine{3507             mnkl++;}
\DoxyCodeLine{3508 }
\DoxyCodeLine{3509           \} \textcolor{comment}{// ∇B∇C integral preparation loop}}
\DoxyCodeLine{3510   }
\DoxyCodeLine{3511 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{3512       \textcolor{comment}{// LSSL}}
\DoxyCodeLine{3513       \textcolor{keyword}{auto} ijkl =0;}
\DoxyCodeLine{3514       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} index=0; index<26; index++)\{}
\DoxyCodeLine{3515         std::cout << \textcolor{stringliteral}{"{}Libcint ("{}}<<index<<\textcolor{stringliteral}{"{})(ij|kl)"{}} << std::endl;}
\DoxyCodeLine{3516         \textcolor{keywordflow}{for}(m = 0ul,            bf1 = bf1\_s; m <                  n1; ++m, bf1++)}
\DoxyCodeLine{3517         \textcolor{keywordflow}{for}(n =   maxShellSize, bf2 = bf2\_s; n <   maxShellSize + n2; ++n, bf2++)}
\DoxyCodeLine{3518         \textcolor{keywordflow}{for}(k = 2*maxShellSize, bf3 = bf3\_s; k < 2*maxShellSize + n3; ++k, bf3++)}
\DoxyCodeLine{3519         \textcolor{keywordflow}{for}(l = 3*maxShellSize, bf4 = bf4\_s; l < 3*maxShellSize + n4; ++l, bf4++)\{}
\DoxyCodeLine{3520           \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{3521           std::cout << \textcolor{stringliteral}{"{}("{}} << bf1 << \textcolor{stringliteral}{"{},"{}} << bf2 << \textcolor{stringliteral}{"{}|"{}} << bf3 << \textcolor{stringliteral}{"{},"{}} << bf4 << \textcolor{stringliteral}{"{})  "{}};}
\DoxyCodeLine{3522           std::cout << BC[index*NB4+MNKL] << std::endl;}
\DoxyCodeLine{3523           ijkl++;}
\DoxyCodeLine{3524         \};}
\DoxyCodeLine{3525       \};}
\DoxyCodeLine{3526 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3527 }
\DoxyCodeLine{3528 }
\DoxyCodeLine{3529   }
\DoxyCodeLine{3530   }
\DoxyCodeLine{3531 \textcolor{preprocessor}{\#ifdef \_CONTRACTION\_ }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{3532 }
\DoxyCodeLine{3533           \textcolor{keyword}{auto} ADXLLMS  = AX\_loc[XLLMS];}
\DoxyCodeLine{3534           \textcolor{keyword}{auto} ADXLLMX  = AX\_loc[XLLMX];}
\DoxyCodeLine{3535           \textcolor{keyword}{auto} ADXLLMY  = AX\_loc[XLLMY];}
\DoxyCodeLine{3536           \textcolor{keyword}{auto} ADXLLMZ  = AX\_loc[XLLMZ];}
\DoxyCodeLine{3537           \textcolor{keyword}{auto} DXLLMS = matList[XLLMS].X;}
\DoxyCodeLine{3538           \textcolor{keyword}{auto} DXLLMX = matList[XLLMX].X;}
\DoxyCodeLine{3539           \textcolor{keyword}{auto} DXLLMY = matList[XLLMY].X;}
\DoxyCodeLine{3540           \textcolor{keyword}{auto} DXLLMZ = matList[XLLMZ].X;}
\DoxyCodeLine{3541 }
\DoxyCodeLine{3542           \textcolor{keyword}{auto} ADXSSMS  = AX\_loc[XSSMS];}
\DoxyCodeLine{3543           \textcolor{keyword}{auto} ADXSSMX  = AX\_loc[XSSMX];}
\DoxyCodeLine{3544           \textcolor{keyword}{auto} ADXSSMY  = AX\_loc[XSSMY];}
\DoxyCodeLine{3545           \textcolor{keyword}{auto} ADXSSMZ  = AX\_loc[XSSMZ];}
\DoxyCodeLine{3546           \textcolor{keyword}{auto} DXSSMS = matList[XSSMS].X;}
\DoxyCodeLine{3547           \textcolor{keyword}{auto} DXSSMX = matList[XSSMX].X;}
\DoxyCodeLine{3548           \textcolor{keyword}{auto} DXSSMY = matList[XSSMY].X;}
\DoxyCodeLine{3549           \textcolor{keyword}{auto} DXSSMZ = matList[XSSMZ].X;}
\DoxyCodeLine{3550 }
\DoxyCodeLine{3551           \textcolor{keyword}{auto} ADCLSMS  = AX\_loc[CLSMS];}
\DoxyCodeLine{3552           \textcolor{keyword}{auto} ADCLSMX  = AX\_loc[CLSMX];}
\DoxyCodeLine{3553           \textcolor{keyword}{auto} ADCLSMY  = AX\_loc[CLSMY];}
\DoxyCodeLine{3554           \textcolor{keyword}{auto} ADCLSMZ  = AX\_loc[CLSMZ];}
\DoxyCodeLine{3555           \textcolor{keyword}{auto} ADXLSMS  = AX\_loc[XLSMS];}
\DoxyCodeLine{3556           \textcolor{keyword}{auto} ADXLSMX  = AX\_loc[XLSMX];}
\DoxyCodeLine{3557           \textcolor{keyword}{auto} ADXLSMY  = AX\_loc[XLSMY];}
\DoxyCodeLine{3558           \textcolor{keyword}{auto} ADXLSMZ  = AX\_loc[XLSMZ];}
\DoxyCodeLine{3559 }
\DoxyCodeLine{3560           \textcolor{keyword}{auto} DXLSMS = matList[XLSMS].X;}
\DoxyCodeLine{3561           \textcolor{keyword}{auto} DXLSMX = matList[XLSMX].X;}
\DoxyCodeLine{3562           \textcolor{keyword}{auto} DXLSMY = matList[XLSMY].X;}
\DoxyCodeLine{3563           \textcolor{keyword}{auto} DXLSMZ = matList[XLSMZ].X;}
\DoxyCodeLine{3564           \textcolor{keyword}{auto} DXSLMS = matList[XSLMS].X;}
\DoxyCodeLine{3565           \textcolor{keyword}{auto} DXSLMX = matList[XSLMX].X;}
\DoxyCodeLine{3566           \textcolor{keyword}{auto} DXSLMY = matList[XSLMY].X;}
\DoxyCodeLine{3567           \textcolor{keyword}{auto} DXSLMZ = matList[XSLMZ].X;}
\DoxyCodeLine{3568 }
\DoxyCodeLine{3569           \textcolor{keyword}{auto} DCLSMS = matList[CLSMS].X;}
\DoxyCodeLine{3570           \textcolor{keyword}{auto} DCLSMX = matList[CLSMX].X;}
\DoxyCodeLine{3571           \textcolor{keyword}{auto} DCLSMY = matList[CLSMY].X;}
\DoxyCodeLine{3572           \textcolor{keyword}{auto} DCLSMZ = matList[CLSMZ].X;}
\DoxyCodeLine{3573           \textcolor{keyword}{auto} DCSLMS = matList[CSLMS].X;}
\DoxyCodeLine{3574           \textcolor{keyword}{auto} DCSLMX = matList[CSLMX].X;}
\DoxyCodeLine{3575           \textcolor{keyword}{auto} DCSLMY = matList[CSLMY].X;}
\DoxyCodeLine{3576           \textcolor{keyword}{auto} DCSLMZ = matList[CSLMZ].X;}
\DoxyCodeLine{3577  }
\DoxyCodeLine{3578           \textcolor{keywordflow}{for}(m = 0ul,            bf1 = bf1\_s; m <                  n1; ++m, bf1++) \{}
\DoxyCodeLine{3579           \textcolor{keywordflow}{for}(n =   maxShellSize, bf2 = bf2\_s; n <   maxShellSize + n2; ++n, bf2++) \{}
\DoxyCodeLine{3580             \textcolor{keyword}{auto} bf1nB = bf1*nBasis;}
\DoxyCodeLine{3581             \textcolor{keyword}{auto} bf2nB = bf2*nBasis;}
\DoxyCodeLine{3582 }
\DoxyCodeLine{3583           \textcolor{keywordflow}{for}(k = 2*maxShellSize, bf3 = bf3\_s; k < 2*maxShellSize + n3; ++k, bf3++) \{}
\DoxyCodeLine{3584             \textcolor{keyword}{auto} bf3nB = bf3*nBasis;}
\DoxyCodeLine{3585 }
\DoxyCodeLine{3586           \textcolor{keywordflow}{for}(l = 3*maxShellSize, bf4 = bf4\_s; l < 3*maxShellSize + n4; ++l, bf4++) \{}
\DoxyCodeLine{3587             \textcolor{keyword}{auto} MNKL = m + n*NB + k*NB2 + l*NB3;}
\DoxyCodeLine{3588             \textcolor{keyword}{auto} LKNM = l + k*NB + n*NB2 + m*NB3;}
\DoxyCodeLine{3589 }
\DoxyCodeLine{3590             \textcolor{keyword}{auto} bf4nB= bf4*nBasis;}
\DoxyCodeLine{3591             \textcolor{keyword}{auto} bf14 = bf1 + bf4nB;}
\DoxyCodeLine{3592             \textcolor{keyword}{auto} bf24 = bf2 + bf4nB;}
\DoxyCodeLine{3593             \textcolor{keyword}{auto} bf23 = bf2 + bf3nB;}
\DoxyCodeLine{3594             \textcolor{keyword}{auto} bf13 = bf1 + bf3nB;}
\DoxyCodeLine{3595             \textcolor{keyword}{auto} bf41 = bf4 + bf1nB;}
\DoxyCodeLine{3596             \textcolor{keyword}{auto} bf31 = bf3 + bf1nB;}
\DoxyCodeLine{3597             \textcolor{keyword}{auto} bf32 = bf3 + bf2nB;}
\DoxyCodeLine{3598             \textcolor{keyword}{auto} bf42 = bf4 + bf2nB;}
\DoxyCodeLine{3599             \textcolor{keyword}{auto} bf34 = bf3 + bf4nB;}
\DoxyCodeLine{3600             \textcolor{keyword}{auto} bf43 = bf4 + bf3nB;}
\DoxyCodeLine{3601             \textcolor{keyword}{auto} bf12 = bf1 + bf2nB;}
\DoxyCodeLine{3602             \textcolor{keyword}{auto} bf21 = bf2 + bf1nB;}
\DoxyCodeLine{3603 }
\DoxyCodeLine{3604             \textcolor{comment}{//      auto ss = 0     ;        // ERI00 (ss)(ij|kl)}}
\DoxyCodeLine{3605             \textcolor{comment}{//      auto sx = NB4   ;        // ERI01 (sσ)\_x(ijkl)}}
\DoxyCodeLine{3606             \textcolor{comment}{//      auto sy = NB4\_2 ;        // ERI02 (sσ)\_y(ijkl)}}
\DoxyCodeLine{3607             \textcolor{comment}{//      auto sz = NB4\_3 ;        // ERI03 (sσ)\_z(ijkl)}}
\DoxyCodeLine{3608             \textcolor{comment}{//      auto xs = NB4\_4 ;        // ERI04 (σs)\_x(ijkl)}}
\DoxyCodeLine{3609             \textcolor{comment}{//      auto ys = NB4\_5 ;        // ERI05 (σs)\_y(ijkl)}}
\DoxyCodeLine{3610             \textcolor{comment}{//      auto zs = NB4\_6 ;        // ERI06 (σs)\_z(ijkl)}}
\DoxyCodeLine{3611             \textcolor{comment}{//      auto dot = NB4\_7 ;       // ERI07 (σ∙σ)(ijkl)}}
\DoxyCodeLine{3612             \textcolor{comment}{//      auto crossx = NB4\_8 ;    // ERI08 (σxσ)\_x(ijkl)}}
\DoxyCodeLine{3613             \textcolor{comment}{//      auto crossy = NB4\_9 ;    // ERI09 (σxσ)\_y(ijkl)}}
\DoxyCodeLine{3614             \textcolor{comment}{//      auto crossz = NB4\_10;    // ERI10 (σxσ)\_z(ijkl)}}
\DoxyCodeLine{3615             \textcolor{comment}{//      auto pxxmyymzz = NB4\_11; // ERI11 (σσ)(xx -\/ yy -\/ zz)(ijkl)}}
\DoxyCodeLine{3616             \textcolor{comment}{//      auto mxxpyymzz = NB4\_12; // ERI12 (σσ)(-\/xx + yy -\/ zz)(ijkl)}}
\DoxyCodeLine{3617             \textcolor{comment}{//      auto mxxmyypzz = NB4\_13; // ERI13 (σσ)(-\/xx -\/ yy + zz)(ijkl)}}
\DoxyCodeLine{3618             \textcolor{comment}{//      auto xypyx = NB4\_14;     // ERI14 (σ\_x σ\_y + σ\_y σ\_x)(ijkl)}}
\DoxyCodeLine{3619             \textcolor{comment}{//      auto zxpxz = NB4\_15;     // ERI15 (σ\_z σ\_x + σ\_x σ\_z)(ijkl)}}
\DoxyCodeLine{3620             \textcolor{comment}{//      auto yzpzy = NB4\_16;     // ERI16 (σ\_y σ\_z + σ\_z σ\_y)(ijkl)}}
\DoxyCodeLine{3621             \textcolor{comment}{//      auto xx = NB4\_17;        // ERI17 (σ\_x σ\_x)(ijkl)}}
\DoxyCodeLine{3622             \textcolor{comment}{//      auto xy = NB4\_18;        // ERI18 (σ\_x σ\_y)(ijkl)}}
\DoxyCodeLine{3623             \textcolor{comment}{//      auto xz = NB4\_19;        // ERI19 (σ\_x σ\_z)(ijkl)}}
\DoxyCodeLine{3624             \textcolor{comment}{//      auto yx = NB4\_20;        // ERI20 (σ\_y σ\_x)(ijkl)}}
\DoxyCodeLine{3625             \textcolor{comment}{//      auto yy = NB4\_21;        // ERI21 (σ\_y σ\_y)(ijkl)}}
\DoxyCodeLine{3626             \textcolor{comment}{//      auto yz = NB4\_22;        // ERI22 (σ\_y σ\_z)(ijkl)}}
\DoxyCodeLine{3627             \textcolor{comment}{//      auto zx = NB4\_23;        // ERI23 (σ\_z σ\_x)(ijkl)}}
\DoxyCodeLine{3628             \textcolor{comment}{//      auto zy = NB4\_24;        // ERI24 (σ\_z σ\_y)(ijkl)}}
\DoxyCodeLine{3629             \textcolor{comment}{//      auto zz = NB4\_25;        // ERI25 (σ\_z σ\_z)(ijkl)}}
\DoxyCodeLine{3630              }
\DoxyCodeLine{3631             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{3632             \textcolor{comment}{/* Start of Gauge (LL|LL) */}}
\DoxyCodeLine{3633             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{3634             }
\DoxyCodeLine{3635             \textcolor{comment}{// Exchange}}
\DoxyCodeLine{3636             \textcolor{comment}{// MNKL}}
\DoxyCodeLine{3637             }
\DoxyCodeLine{3638             \textcolor{comment}{/* Equation (208) */}}
\DoxyCodeLine{3639             ADXLLMS[bf14] +=     DXSSMS[bf23]*BC[MNKL];}
\DoxyCodeLine{3640             ADXLLMS[bf14] +=  iS*DXSSMX[bf23]*BC[MNKL+sx];}
\DoxyCodeLine{3641             ADXLLMS[bf14] +=  iS*DXSSMY[bf23]*BC[MNKL+sy];}
\DoxyCodeLine{3642             ADXLLMS[bf14] +=  iS*DXSSMZ[bf23]*BC[MNKL+sz];}
\DoxyCodeLine{3643             ADXLLMS[bf14] +=  iS*DXSSMZ[bf23]*BC[MNKL+zs];}
\DoxyCodeLine{3644             ADXLLMS[bf14] +=  iS*DXSSMX[bf23]*BC[MNKL+xs];}
\DoxyCodeLine{3645             ADXLLMS[bf14] +=  iS*DXSSMY[bf23]*BC[MNKL+ys];}
\DoxyCodeLine{3646             ADXLLMS[bf14] +=     DXSSMS[bf23]*BC[MNKL+\mbox{\hyperlink{namespaceChronusQ_a208436762fbd254ff0fa550f917b96fe}{dot}}];}
\DoxyCodeLine{3647             ADXLLMS[bf14] -\/=  iS*DXSSMZ[bf23]*BC[MNKL+crossz];}
\DoxyCodeLine{3648             ADXLLMS[bf14] -\/=  iS*DXSSMX[bf23]*BC[MNKL+crossx];}
\DoxyCodeLine{3649             ADXLLMS[bf14] -\/=  iS*DXSSMY[bf23]*BC[MNKL+crossy];}
\DoxyCodeLine{3650             }
\DoxyCodeLine{3651             \textcolor{comment}{/* Equation (209) */}}
\DoxyCodeLine{3652             ADXLLMZ[bf14] +=     DXSSMZ[bf23]*BC[MNKL];}
\DoxyCodeLine{3653             ADXLLMZ[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+sz];}
\DoxyCodeLine{3654             ADXLLMZ[bf14] +=     DXSSMY[bf23]*BC[MNKL+sx];}
\DoxyCodeLine{3655             ADXLLMZ[bf14] -\/=     DXSSMX[bf23]*BC[MNKL+sy];}
\DoxyCodeLine{3656             ADXLLMZ[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+zs];}
\DoxyCodeLine{3657             ADXLLMZ[bf14] +=     DXSSMX[bf23]*BC[MNKL+ys];}
\DoxyCodeLine{3658             ADXLLMZ[bf14] -\/=     DXSSMY[bf23]*BC[MNKL+xs];}
\DoxyCodeLine{3659             ADXLLMZ[bf14] +=     DXSSMZ[bf23]*BC[MNKL+mxxmyypzz];}
\DoxyCodeLine{3660             ADXLLMZ[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+crossz];}
\DoxyCodeLine{3661             ADXLLMZ[bf14] +=     DXSSMX[bf23]*BC[MNKL+zxpxz];}
\DoxyCodeLine{3662             ADXLLMZ[bf14] +=     DXSSMY[bf23]*BC[MNKL+yzpzy];}
\DoxyCodeLine{3663             }
\DoxyCodeLine{3664             \textcolor{comment}{/* Equation (210) */}}
\DoxyCodeLine{3665             ADXLLMX[bf14] +=     DXSSMX[bf23]*BC[MNKL];}
\DoxyCodeLine{3666             ADXLLMX[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+sx];}
\DoxyCodeLine{3667             ADXLLMX[bf14] -\/=     DXSSMY[bf23]*BC[MNKL+sz];}
\DoxyCodeLine{3668             ADXLLMX[bf14] +=     DXSSMZ[bf23]*BC[MNKL+sy];}
\DoxyCodeLine{3669             ADXLLMX[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+xs];}
\DoxyCodeLine{3670             ADXLLMX[bf14] +=     DXSSMY[bf23]*BC[MNKL+zs];}
\DoxyCodeLine{3671             ADXLLMX[bf14] -\/=     DXSSMZ[bf23]*BC[MNKL+ys];}
\DoxyCodeLine{3672             ADXLLMX[bf14] +=     DXSSMX[bf23]*BC[MNKL+pxxmyymzz];}
\DoxyCodeLine{3673             ADXLLMX[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+crossx];}
\DoxyCodeLine{3674             ADXLLMX[bf14] +=     DXSSMY[bf23]*BC[MNKL+xypyx];}
\DoxyCodeLine{3675             ADXLLMX[bf14] +=     DXSSMZ[bf23]*BC[MNKL+zxpxz];}
\DoxyCodeLine{3676             }
\DoxyCodeLine{3677             \textcolor{comment}{/* Equation (211) */}}
\DoxyCodeLine{3678             ADXLLMY[bf14] +=     DXSSMY[bf23]*BC[MNKL];}
\DoxyCodeLine{3679             ADXLLMY[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+sy];}
\DoxyCodeLine{3680             ADXLLMY[bf14] +=     DXSSMX[bf23]*BC[MNKL+sz];}
\DoxyCodeLine{3681             ADXLLMY[bf14] -\/=     DXSSMZ[bf23]*BC[MNKL+sx];}
\DoxyCodeLine{3682             ADXLLMY[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+ys];}
\DoxyCodeLine{3683             ADXLLMY[bf14] -\/=     DXSSMX[bf23]*BC[MNKL+zs];}
\DoxyCodeLine{3684             ADXLLMY[bf14] +=     DXSSMZ[bf23]*BC[MNKL+xs];}
\DoxyCodeLine{3685             ADXLLMY[bf14] +=     DXSSMY[bf23]*BC[MNKL+mxxpyymzz];}
\DoxyCodeLine{3686             ADXLLMY[bf14] +=  iS*DXSSMS[bf23]*BC[MNKL+crossy];}
\DoxyCodeLine{3687             ADXLLMY[bf14] +=     DXSSMX[bf23]*BC[MNKL+xypyx];}
\DoxyCodeLine{3688             ADXLLMY[bf14] +=     DXSSMZ[bf23]*BC[MNKL+yzpzy];}
\DoxyCodeLine{3689             }
\DoxyCodeLine{3690             \textcolor{comment}{// LKNM}}
\DoxyCodeLine{3691             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{3692               \textcolor{comment}{/* Equation (208) */}}
\DoxyCodeLine{3693               ADXLLMS[bf41] +=     DXSSMS[bf32]*BC[LKNM];}
\DoxyCodeLine{3694               ADXLLMS[bf41] +=  iS*DXSSMX[bf32]*BC[LKNM+sx];}
\DoxyCodeLine{3695               ADXLLMS[bf41] +=  iS*DXSSMY[bf32]*BC[LKNM+sy];}
\DoxyCodeLine{3696               ADXLLMS[bf41] +=  iS*DXSSMZ[bf32]*BC[LKNM+sz];}
\DoxyCodeLine{3697               ADXLLMS[bf41] +=  iS*DXSSMZ[bf32]*BC[LKNM+zs];}
\DoxyCodeLine{3698               ADXLLMS[bf41] +=  iS*DXSSMX[bf32]*BC[LKNM+xs];}
\DoxyCodeLine{3699               ADXLLMS[bf41] +=  iS*DXSSMY[bf32]*BC[LKNM+ys];}
\DoxyCodeLine{3700               ADXLLMS[bf41] +=     DXSSMS[bf32]*BC[LKNM+\mbox{\hyperlink{namespaceChronusQ_a208436762fbd254ff0fa550f917b96fe}{dot}}];}
\DoxyCodeLine{3701               ADXLLMS[bf41] -\/=  iS*DXSSMZ[bf32]*BC[LKNM+crossz];}
\DoxyCodeLine{3702               ADXLLMS[bf41] -\/=  iS*DXSSMX[bf32]*BC[LKNM+crossx];}
\DoxyCodeLine{3703               ADXLLMS[bf41] -\/=  iS*DXSSMY[bf32]*BC[LKNM+crossy];}
\DoxyCodeLine{3704               }
\DoxyCodeLine{3705               \textcolor{comment}{/* Equation (209) */}}
\DoxyCodeLine{3706               ADXLLMZ[bf41] +=     DXSSMZ[bf32]*BC[LKNM];}
\DoxyCodeLine{3707               ADXLLMZ[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+sz];}
\DoxyCodeLine{3708               ADXLLMZ[bf41] +=     DXSSMY[bf32]*BC[LKNM+sx];}
\DoxyCodeLine{3709               ADXLLMZ[bf41] -\/=     DXSSMX[bf32]*BC[LKNM+sy];}
\DoxyCodeLine{3710               ADXLLMZ[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+zs];}
\DoxyCodeLine{3711               ADXLLMZ[bf41] +=     DXSSMX[bf32]*BC[LKNM+ys];}
\DoxyCodeLine{3712               ADXLLMZ[bf41] -\/=     DXSSMY[bf32]*BC[LKNM+xs];}
\DoxyCodeLine{3713               ADXLLMZ[bf41] +=     DXSSMZ[bf32]*BC[LKNM+mxxmyypzz];}
\DoxyCodeLine{3714               ADXLLMZ[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+crossz];}
\DoxyCodeLine{3715               ADXLLMZ[bf41] +=     DXSSMX[bf32]*BC[LKNM+zxpxz];}
\DoxyCodeLine{3716               ADXLLMZ[bf41] +=     DXSSMY[bf32]*BC[LKNM+yzpzy];}
\DoxyCodeLine{3717               }
\DoxyCodeLine{3718               \textcolor{comment}{/* Equation (210) */}}
\DoxyCodeLine{3719               ADXLLMX[bf41] +=     DXSSMX[bf32]*BC[LKNM];}
\DoxyCodeLine{3720               ADXLLMX[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+sx];}
\DoxyCodeLine{3721               ADXLLMX[bf41] -\/=     DXSSMY[bf32]*BC[LKNM+sz];}
\DoxyCodeLine{3722               ADXLLMX[bf41] +=     DXSSMZ[bf32]*BC[LKNM+sy];}
\DoxyCodeLine{3723               ADXLLMX[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+xs];}
\DoxyCodeLine{3724               ADXLLMX[bf41] +=     DXSSMY[bf32]*BC[LKNM+zs];}
\DoxyCodeLine{3725               ADXLLMX[bf41] -\/=     DXSSMZ[bf32]*BC[LKNM+ys];}
\DoxyCodeLine{3726               ADXLLMX[bf41] +=     DXSSMX[bf32]*BC[LKNM+pxxmyymzz];}
\DoxyCodeLine{3727               ADXLLMX[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+crossx];}
\DoxyCodeLine{3728               ADXLLMX[bf41] +=     DXSSMY[bf32]*BC[LKNM+xypyx];}
\DoxyCodeLine{3729               ADXLLMX[bf41] +=     DXSSMZ[bf32]*BC[LKNM+zxpxz];}
\DoxyCodeLine{3730               }
\DoxyCodeLine{3731               \textcolor{comment}{/* Equation (211) */}}
\DoxyCodeLine{3732               ADXLLMY[bf41] +=     DXSSMY[bf32]*BC[LKNM];}
\DoxyCodeLine{3733               ADXLLMY[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+sy];}
\DoxyCodeLine{3734               ADXLLMY[bf41] +=     DXSSMX[bf32]*BC[LKNM+sz];}
\DoxyCodeLine{3735               ADXLLMY[bf41] -\/=     DXSSMZ[bf32]*BC[LKNM+sx];}
\DoxyCodeLine{3736               ADXLLMY[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+ys];}
\DoxyCodeLine{3737               ADXLLMY[bf41] -\/=     DXSSMX[bf32]*BC[LKNM+zs];}
\DoxyCodeLine{3738               ADXLLMY[bf41] +=     DXSSMZ[bf32]*BC[LKNM+xs];}
\DoxyCodeLine{3739               ADXLLMY[bf41] +=     DXSSMY[bf32]*BC[LKNM+mxxpyymzz];}
\DoxyCodeLine{3740               ADXLLMY[bf41] +=  iS*DXSSMS[bf32]*BC[LKNM+crossy];}
\DoxyCodeLine{3741               ADXLLMY[bf41] +=     DXSSMX[bf32]*BC[LKNM+xypyx];}
\DoxyCodeLine{3742               ADXLLMY[bf41] +=     DXSSMZ[bf32]*BC[LKNM+yzpzy];}
\DoxyCodeLine{3743             \}}
\DoxyCodeLine{3744             }
\DoxyCodeLine{3745             }
\DoxyCodeLine{3746             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{3747             \textcolor{comment}{/* Start of Gauge (SS|SS) */}}
\DoxyCodeLine{3748             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{3749             }
\DoxyCodeLine{3750             \textcolor{comment}{// Exchange}}
\DoxyCodeLine{3751             \textcolor{comment}{// MNKL: TRANS\_MN\_TRANS\_KL}}
\DoxyCodeLine{3752             \textcolor{comment}{// If a TRANS is on a sigma, it will change the sign of the integral.}}
\DoxyCodeLine{3753             }
\DoxyCodeLine{3754             \textcolor{comment}{/* Equation (227) */}}
\DoxyCodeLine{3755             ADXSSMS[bf23] +=    DXLLMS[bf14]*BC[MNKL];}
\DoxyCodeLine{3756             ADXSSMS[bf23] -\/= iS*DXLLMX[bf14]*BC[MNKL+sx];}
\DoxyCodeLine{3757             ADXSSMS[bf23] -\/= iS*DXLLMY[bf14]*BC[MNKL+sy];}
\DoxyCodeLine{3758             ADXSSMS[bf23] -\/= iS*DXLLMZ[bf14]*BC[MNKL+sz];}
\DoxyCodeLine{3759             ADXSSMS[bf23] -\/= iS*DXLLMX[bf14]*BC[MNKL+xs];}
\DoxyCodeLine{3760             ADXSSMS[bf23] -\/= iS*DXLLMY[bf14]*BC[MNKL+ys];}
\DoxyCodeLine{3761             ADXSSMS[bf23] -\/= iS*DXLLMZ[bf14]*BC[MNKL+zs];}
\DoxyCodeLine{3762             ADXSSMS[bf23] +=    DXLLMS[bf14]*BC[MNKL+\mbox{\hyperlink{namespaceChronusQ_a208436762fbd254ff0fa550f917b96fe}{dot}}];}
\DoxyCodeLine{3763             ADXSSMS[bf23] -\/= iS*DXLLMX[bf14]*BC[MNKL+crossx];}
\DoxyCodeLine{3764             ADXSSMS[bf23] -\/= iS*DXLLMY[bf14]*BC[MNKL+crossy];}
\DoxyCodeLine{3765             ADXSSMS[bf23] -\/= iS*DXLLMZ[bf14]*BC[MNKL+crossz];}
\DoxyCodeLine{3766             }
\DoxyCodeLine{3767             \textcolor{comment}{/* Equation (228) */}}
\DoxyCodeLine{3768             ADXSSMZ[bf23] +=    DXLLMZ[bf14]*BC[MNKL];}
\DoxyCodeLine{3769             ADXSSMZ[bf23] -\/= iS*DXLLMS[bf14]*BC[MNKL+sz];}
\DoxyCodeLine{3770             ADXSSMZ[bf23] +=    DXLLMX[bf14]*BC[MNKL+sy];}
\DoxyCodeLine{3771             ADXSSMZ[bf23] -\/=    DXLLMY[bf14]*BC[MNKL+sx];}
\DoxyCodeLine{3772             ADXSSMZ[bf23] -\/= iS*DXLLMS[bf14]*BC[MNKL+zs];}
\DoxyCodeLine{3773             ADXSSMZ[bf23] -\/=    DXLLMX[bf14]*BC[MNKL+ys];}
\DoxyCodeLine{3774             ADXSSMZ[bf23] +=    DXLLMY[bf14]*BC[MNKL+xs];}
\DoxyCodeLine{3775             ADXSSMZ[bf23] +=    DXLLMZ[bf14]*BC[MNKL+mxxmyypzz];}
\DoxyCodeLine{3776             ADXSSMZ[bf23] += iS*DXLLMS[bf14]*BC[MNKL+crossz];}
\DoxyCodeLine{3777             ADXSSMZ[bf23] +=    DXLLMX[bf14]*BC[MNKL+zxpxz];}
\DoxyCodeLine{3778             ADXSSMZ[bf23] +=    DXLLMY[bf14]*BC[MNKL+yzpzy];}
\DoxyCodeLine{3779             }
\DoxyCodeLine{3780             \textcolor{comment}{/* Equation (229) */}}
\DoxyCodeLine{3781             ADXSSMX[bf23] +=    DXLLMX[bf14]*BC[MNKL];}
\DoxyCodeLine{3782             ADXSSMX[bf23] -\/= iS*DXLLMS[bf14]*BC[MNKL+sx];}
\DoxyCodeLine{3783             ADXSSMX[bf23] +=    DXLLMY[bf14]*BC[MNKL+sz];}
\DoxyCodeLine{3784             ADXSSMX[bf23] -\/=    DXLLMZ[bf14]*BC[MNKL+sy];}
\DoxyCodeLine{3785             ADXSSMX[bf23] -\/= iS*DXLLMS[bf14]*BC[MNKL+xs];}
\DoxyCodeLine{3786             ADXSSMX[bf23] -\/=    DXLLMY[bf14]*BC[MNKL+zs];}
\DoxyCodeLine{3787             ADXSSMX[bf23] +=    DXLLMZ[bf14]*BC[MNKL+ys];}
\DoxyCodeLine{3788             ADXSSMX[bf23] +=    DXLLMX[bf14]*BC[MNKL+pxxmyymzz];}
\DoxyCodeLine{3789             ADXSSMX[bf23] += iS*DXLLMS[bf14]*BC[MNKL+crossx];}
\DoxyCodeLine{3790             ADXSSMX[bf23] +=    DXLLMY[bf14]*BC[MNKL+xypyx];}
\DoxyCodeLine{3791             ADXSSMX[bf23] +=    DXLLMZ[bf14]*BC[MNKL+zxpxz];}
\DoxyCodeLine{3792             }
\DoxyCodeLine{3793             \textcolor{comment}{/* Equation (230) */}}
\DoxyCodeLine{3794             ADXSSMY[bf23] +=    DXLLMY[bf14]*BC[MNKL];}
\DoxyCodeLine{3795             ADXSSMY[bf23] -\/= iS*DXLLMS[bf14]*BC[MNKL+sy];}
\DoxyCodeLine{3796             ADXSSMY[bf23] -\/=    DXLLMX[bf14]*BC[MNKL+sz];}
\DoxyCodeLine{3797             ADXSSMY[bf23] +=    DXLLMZ[bf14]*BC[MNKL+sx];}
\DoxyCodeLine{3798             ADXSSMY[bf23] -\/= iS*DXLLMS[bf14]*BC[MNKL+ys];}
\DoxyCodeLine{3799             ADXSSMY[bf23] +=    DXLLMX[bf14]*BC[MNKL+zs];}
\DoxyCodeLine{3800             ADXSSMY[bf23] -\/=    DXLLMZ[bf14]*BC[MNKL+xs];}
\DoxyCodeLine{3801             ADXSSMY[bf23] +=    DXLLMY[bf14]*BC[MNKL+mxxpyymzz];}
\DoxyCodeLine{3802             ADXSSMY[bf23] += iS*DXLLMS[bf14]*BC[MNKL+crossy];}
\DoxyCodeLine{3803             ADXSSMY[bf23] +=    DXLLMX[bf14]*BC[MNKL+xypyx];}
\DoxyCodeLine{3804             ADXSSMY[bf23] +=    DXLLMZ[bf14]*BC[MNKL+yzpzy];}
\DoxyCodeLine{3805             }
\DoxyCodeLine{3806             \textcolor{comment}{// LKNM, TRANS\_MN\_TRANS\_KL}}
\DoxyCodeLine{3807             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{3808               \textcolor{comment}{/* Equation (227) */}}
\DoxyCodeLine{3809               ADXSSMS[bf32] +=    DXLLMS[bf41]*BC[LKNM];}
\DoxyCodeLine{3810               ADXSSMS[bf32] -\/= iS*DXLLMX[bf41]*BC[LKNM+sx];}
\DoxyCodeLine{3811               ADXSSMS[bf32] -\/= iS*DXLLMY[bf41]*BC[LKNM+sy];}
\DoxyCodeLine{3812               ADXSSMS[bf32] -\/= iS*DXLLMZ[bf41]*BC[LKNM+sz];}
\DoxyCodeLine{3813               ADXSSMS[bf32] -\/= iS*DXLLMX[bf41]*BC[LKNM+xs];}
\DoxyCodeLine{3814               ADXSSMS[bf32] -\/= iS*DXLLMY[bf41]*BC[LKNM+ys];}
\DoxyCodeLine{3815               ADXSSMS[bf32] -\/= iS*DXLLMZ[bf41]*BC[LKNM+zs];}
\DoxyCodeLine{3816               ADXSSMS[bf32] +=    DXLLMS[bf41]*BC[LKNM+\mbox{\hyperlink{namespaceChronusQ_a208436762fbd254ff0fa550f917b96fe}{dot}}];}
\DoxyCodeLine{3817               ADXSSMS[bf32] -\/= iS*DXLLMX[bf41]*BC[LKNM+crossx];}
\DoxyCodeLine{3818               ADXSSMS[bf32] -\/= iS*DXLLMY[bf41]*BC[LKNM+crossy];}
\DoxyCodeLine{3819               ADXSSMS[bf32] -\/= iS*DXLLMZ[bf41]*BC[LKNM+crossz];}
\DoxyCodeLine{3820               }
\DoxyCodeLine{3821               \textcolor{comment}{/* Equation (228) */}}
\DoxyCodeLine{3822               ADXSSMZ[bf32] +=    DXLLMZ[bf41]*BC[LKNM];}
\DoxyCodeLine{3823               ADXSSMZ[bf32] -\/= iS*DXLLMS[bf41]*BC[LKNM+sz];}
\DoxyCodeLine{3824               ADXSSMZ[bf32] +=    DXLLMX[bf41]*BC[LKNM+sy];}
\DoxyCodeLine{3825               ADXSSMZ[bf32] -\/=    DXLLMY[bf41]*BC[LKNM+sx];}
\DoxyCodeLine{3826               ADXSSMZ[bf32] -\/= iS*DXLLMS[bf41]*BC[LKNM+zs];}
\DoxyCodeLine{3827               ADXSSMZ[bf32] -\/=    DXLLMX[bf41]*BC[LKNM+ys];}
\DoxyCodeLine{3828               ADXSSMZ[bf32] +=    DXLLMY[bf41]*BC[LKNM+xs];}
\DoxyCodeLine{3829               ADXSSMZ[bf32] +=    DXLLMZ[bf41]*BC[LKNM+mxxmyypzz];}
\DoxyCodeLine{3830               ADXSSMZ[bf32] += iS*DXLLMS[bf41]*BC[LKNM+crossz];}
\DoxyCodeLine{3831               ADXSSMZ[bf32] +=    DXLLMX[bf41]*BC[LKNM+zxpxz];}
\DoxyCodeLine{3832               ADXSSMZ[bf32] +=    DXLLMY[bf41]*BC[LKNM+yzpzy];}
\DoxyCodeLine{3833               }
\DoxyCodeLine{3834               \textcolor{comment}{/* Equation (229) */}}
\DoxyCodeLine{3835               ADXSSMX[bf32] +=    DXLLMX[bf41]*BC[LKNM];}
\DoxyCodeLine{3836               ADXSSMX[bf32] -\/= iS*DXLLMS[bf41]*BC[LKNM+sx];}
\DoxyCodeLine{3837               ADXSSMX[bf32] +=    DXLLMY[bf41]*BC[LKNM+sz];}
\DoxyCodeLine{3838               ADXSSMX[bf32] -\/=    DXLLMZ[bf41]*BC[LKNM+sy];}
\DoxyCodeLine{3839               ADXSSMX[bf32] -\/= iS*DXLLMS[bf41]*BC[LKNM+xs];}
\DoxyCodeLine{3840               ADXSSMX[bf32] -\/=    DXLLMY[bf41]*BC[LKNM+zs];}
\DoxyCodeLine{3841               ADXSSMX[bf32] +=    DXLLMZ[bf41]*BC[LKNM+ys];}
\DoxyCodeLine{3842               ADXSSMX[bf32] +=    DXLLMX[bf41]*BC[LKNM+pxxmyymzz];}
\DoxyCodeLine{3843               ADXSSMX[bf32] += iS*DXLLMS[bf41]*BC[LKNM+crossx];}
\DoxyCodeLine{3844               ADXSSMX[bf32] +=    DXLLMY[bf41]*BC[LKNM+xypyx];}
\DoxyCodeLine{3845               ADXSSMX[bf32] +=    DXLLMZ[bf41]*BC[LKNM+zxpxz];}
\DoxyCodeLine{3846               }
\DoxyCodeLine{3847               \textcolor{comment}{/* Equation (230) */}}
\DoxyCodeLine{3848               ADXSSMY[bf32] +=    DXLLMY[bf41]*BC[LKNM];}
\DoxyCodeLine{3849               ADXSSMY[bf32] -\/= iS*DXLLMS[bf41]*BC[LKNM+sy];}
\DoxyCodeLine{3850               ADXSSMY[bf32] -\/=    DXLLMX[bf41]*BC[LKNM+sz];}
\DoxyCodeLine{3851               ADXSSMY[bf32] +=    DXLLMZ[bf41]*BC[LKNM+sx];}
\DoxyCodeLine{3852               ADXSSMY[bf32] -\/= iS*DXLLMS[bf41]*BC[LKNM+ys];}
\DoxyCodeLine{3853               ADXSSMY[bf32] +=    DXLLMX[bf41]*BC[LKNM+zs];}
\DoxyCodeLine{3854               ADXSSMY[bf32] -\/=    DXLLMZ[bf41]*BC[LKNM+xs];}
\DoxyCodeLine{3855               ADXSSMY[bf32] +=    DXLLMY[bf41]*BC[LKNM+mxxpyymzz];}
\DoxyCodeLine{3856               ADXSSMY[bf32] += iS*DXLLMS[bf41]*BC[LKNM+crossy];}
\DoxyCodeLine{3857               ADXSSMY[bf32] +=    DXLLMX[bf41]*BC[LKNM+xypyx];}
\DoxyCodeLine{3858               ADXSSMY[bf32] +=    DXLLMZ[bf41]*BC[LKNM+yzpzy];}
\DoxyCodeLine{3859             \}}
\DoxyCodeLine{3860              }
\DoxyCodeLine{3861              }
\DoxyCodeLine{3862             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{3863             \textcolor{comment}{/* Start of Gauge (LL|SS) */}}
\DoxyCodeLine{3864             \textcolor{comment}{/*++++++++++++++++++++++++*/}}
\DoxyCodeLine{3865              }
\DoxyCodeLine{3866             }
\DoxyCodeLine{3867             \textcolor{comment}{// Coulomb}}
\DoxyCodeLine{3868             \textcolor{comment}{// MNKL}}
\DoxyCodeLine{3869             }
\DoxyCodeLine{3870             \textcolor{comment}{/* Equations (232) and (233) */}}
\DoxyCodeLine{3871             ADCLSMS[bf12] -\/=     DXLSMS[bf43]*BC[MNKL];}
\DoxyCodeLine{3872             ADCLSMS[bf12] -\/=  iS*DXLSMX[bf43]*BC[MNKL+sx];}
\DoxyCodeLine{3873             ADCLSMS[bf12] -\/=  iS*DXLSMY[bf43]*BC[MNKL+sy];}
\DoxyCodeLine{3874             ADCLSMS[bf12] -\/=  iS*DXLSMZ[bf43]*BC[MNKL+sz];}
\DoxyCodeLine{3875             \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3876             ADCLSMS[bf12] +=     DXSLMS[bf34]*BC[MNKL];}
\DoxyCodeLine{3877             ADCLSMS[bf12] -\/=  iS*DXSLMX[bf34]*BC[MNKL+sx];}
\DoxyCodeLine{3878             ADCLSMS[bf12] -\/=  iS*DXSLMY[bf34]*BC[MNKL+sy];}
\DoxyCodeLine{3879             ADCLSMS[bf12] -\/=  iS*DXSLMZ[bf34]*BC[MNKL+sz];}
\DoxyCodeLine{3880             }
\DoxyCodeLine{3881             ADCLSMX[bf12] -\/=  iS*DXLSMS[bf43]*BC[MNKL+xs];}
\DoxyCodeLine{3882             ADCLSMX[bf12] -\/=     DXLSMX[bf43]*BC[MNKL+xx];}
\DoxyCodeLine{3883             ADCLSMX[bf12] -\/=     DXLSMY[bf43]*BC[MNKL+xy];}
\DoxyCodeLine{3884             ADCLSMX[bf12] -\/=     DXLSMZ[bf43]*BC[MNKL+xz];}
\DoxyCodeLine{3885             \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3886             ADCLSMX[bf12] +=  iS*DXSLMS[bf34]*BC[MNKL+xs];}
\DoxyCodeLine{3887             ADCLSMX[bf12] -\/=     DXSLMX[bf34]*BC[MNKL+xx];}
\DoxyCodeLine{3888             ADCLSMX[bf12] -\/=     DXSLMY[bf34]*BC[MNKL+xy];}
\DoxyCodeLine{3889             ADCLSMX[bf12] -\/=     DXSLMZ[bf34]*BC[MNKL+xz];}
\DoxyCodeLine{3890             }
\DoxyCodeLine{3891             ADCLSMY[bf12] -\/=  iS*DXLSMS[bf43]*BC[MNKL+ys];}
\DoxyCodeLine{3892             ADCLSMY[bf12] -\/=     DXLSMX[bf43]*BC[MNKL+yx];}
\DoxyCodeLine{3893             ADCLSMY[bf12] -\/=     DXLSMY[bf43]*BC[MNKL+yy];}
\DoxyCodeLine{3894             ADCLSMY[bf12] -\/=     DXLSMZ[bf43]*BC[MNKL+yz];}
\DoxyCodeLine{3895             \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3896             ADCLSMY[bf12] +=  iS*DXSLMS[bf34]*BC[MNKL+ys];}
\DoxyCodeLine{3897             ADCLSMY[bf12] -\/=     DXSLMX[bf34]*BC[MNKL+yx];}
\DoxyCodeLine{3898             ADCLSMY[bf12] -\/=     DXSLMY[bf34]*BC[MNKL+yy];}
\DoxyCodeLine{3899             ADCLSMY[bf12] -\/=     DXSLMZ[bf34]*BC[MNKL+yz];}
\DoxyCodeLine{3900             }
\DoxyCodeLine{3901             ADCLSMZ[bf12] -\/=  iS*DXLSMS[bf43]*BC[MNKL+zs];}
\DoxyCodeLine{3902             ADCLSMZ[bf12] -\/=     DXLSMX[bf43]*BC[MNKL+zx];}
\DoxyCodeLine{3903             ADCLSMZ[bf12] -\/=     DXLSMY[bf43]*BC[MNKL+zy];}
\DoxyCodeLine{3904             ADCLSMZ[bf12] -\/=     DXLSMZ[bf43]*BC[MNKL+zz];}
\DoxyCodeLine{3905             \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3906             ADCLSMZ[bf12] +=  iS*DXSLMS[bf34]*BC[MNKL+zs];}
\DoxyCodeLine{3907             ADCLSMZ[bf12] -\/=     DXSLMX[bf34]*BC[MNKL+zx];}
\DoxyCodeLine{3908             ADCLSMZ[bf12] -\/=     DXSLMY[bf34]*BC[MNKL+zy];}
\DoxyCodeLine{3909             ADCLSMZ[bf12] -\/=     DXSLMZ[bf34]*BC[MNKL+zz];}
\DoxyCodeLine{3910             }
\DoxyCodeLine{3911             \textcolor{comment}{// LKNM}}
\DoxyCodeLine{3912             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{3913               ADCLSMS[bf43] -\/=     DXLSMS[bf12]*BC[LKNM];}
\DoxyCodeLine{3914               ADCLSMS[bf43] -\/=  iS*DXLSMX[bf12]*BC[LKNM+sx];}
\DoxyCodeLine{3915               ADCLSMS[bf43] -\/=  iS*DXLSMY[bf12]*BC[LKNM+sy];}
\DoxyCodeLine{3916               ADCLSMS[bf43] -\/=  iS*DXLSMZ[bf12]*BC[LKNM+sz];}
\DoxyCodeLine{3917               \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3918               ADCLSMS[bf43] +=     DXSLMS[bf21]*BC[LKNM];}
\DoxyCodeLine{3919               ADCLSMS[bf43] -\/=  iS*DXSLMX[bf21]*BC[LKNM+sx];}
\DoxyCodeLine{3920               ADCLSMS[bf43] -\/=  iS*DXSLMY[bf21]*BC[LKNM+sy];}
\DoxyCodeLine{3921               ADCLSMS[bf43] -\/=  iS*DXSLMZ[bf21]*BC[LKNM+sz];}
\DoxyCodeLine{3922               }
\DoxyCodeLine{3923               ADCLSMX[bf43] -\/=  iS*DXLSMS[bf12]*BC[LKNM+xs];}
\DoxyCodeLine{3924               ADCLSMX[bf43] -\/=     DXLSMX[bf12]*BC[LKNM+xx];}
\DoxyCodeLine{3925               ADCLSMX[bf43] -\/=     DXLSMY[bf12]*BC[LKNM+xy];}
\DoxyCodeLine{3926               ADCLSMX[bf43] -\/=     DXLSMZ[bf12]*BC[LKNM+xz];}
\DoxyCodeLine{3927               \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3928               ADCLSMX[bf43] +=  iS*DXSLMS[bf21]*BC[LKNM+xs];}
\DoxyCodeLine{3929               ADCLSMX[bf43] -\/=     DXSLMX[bf21]*BC[LKNM+xx];}
\DoxyCodeLine{3930               ADCLSMX[bf43] -\/=     DXSLMY[bf21]*BC[LKNM+xy];}
\DoxyCodeLine{3931               ADCLSMX[bf43] -\/=     DXSLMZ[bf21]*BC[LKNM+xz];}
\DoxyCodeLine{3932               }
\DoxyCodeLine{3933               ADCLSMY[bf43] -\/=  iS*DXLSMS[bf12]*BC[LKNM+ys];}
\DoxyCodeLine{3934               ADCLSMY[bf43] -\/=     DXLSMX[bf12]*BC[LKNM+yx];}
\DoxyCodeLine{3935               ADCLSMY[bf43] -\/=     DXLSMY[bf12]*BC[LKNM+yy];}
\DoxyCodeLine{3936               ADCLSMY[bf43] -\/=     DXLSMZ[bf12]*BC[LKNM+yz];}
\DoxyCodeLine{3937               \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3938               ADCLSMY[bf43] +=  iS*DXSLMS[bf21]*BC[LKNM+ys];}
\DoxyCodeLine{3939               ADCLSMY[bf43] -\/=     DXSLMX[bf21]*BC[LKNM+yx];}
\DoxyCodeLine{3940               ADCLSMY[bf43] -\/=     DXSLMY[bf21]*BC[LKNM+yy];}
\DoxyCodeLine{3941               ADCLSMY[bf43] -\/=     DXSLMZ[bf21]*BC[LKNM+yz];}
\DoxyCodeLine{3942               }
\DoxyCodeLine{3943               ADCLSMZ[bf43] -\/=  iS*DXLSMS[bf12]*BC[LKNM+zs];}
\DoxyCodeLine{3944               ADCLSMZ[bf43] -\/=     DXLSMX[bf12]*BC[LKNM+zx];}
\DoxyCodeLine{3945               ADCLSMZ[bf43] -\/=     DXLSMY[bf12]*BC[LKNM+zy];}
\DoxyCodeLine{3946               ADCLSMZ[bf43] -\/=     DXLSMZ[bf12]*BC[LKNM+zz];}
\DoxyCodeLine{3947               \textcolor{comment}{// TRANS\_KL}}
\DoxyCodeLine{3948               ADCLSMZ[bf43] +=  iS*DXSLMS[bf21]*BC[LKNM+zs];}
\DoxyCodeLine{3949               ADCLSMZ[bf43] -\/=     DXSLMX[bf21]*BC[LKNM+zx];}
\DoxyCodeLine{3950               ADCLSMZ[bf43] -\/=     DXSLMY[bf21]*BC[LKNM+zy];}
\DoxyCodeLine{3951               ADCLSMZ[bf43] -\/=     DXSLMZ[bf21]*BC[LKNM+zz];}
\DoxyCodeLine{3952             \}}
\DoxyCodeLine{3953              }
\DoxyCodeLine{3954             \textcolor{comment}{// Exchange}}
\DoxyCodeLine{3955             \textcolor{comment}{// MNKL, TRANS\_KL}}
\DoxyCodeLine{3956             \textcolor{comment}{// If a TRANS is on a sigma, it will change the sign of the integral.}}
\DoxyCodeLine{3957             }
\DoxyCodeLine{3958             \textcolor{comment}{/* Equations (248) -\/ (251) */}}
\DoxyCodeLine{3959             ADXLSMS[bf13] -\/=    DXSLMS[bf24]    *BC[MNKL]; }
\DoxyCodeLine{3960             ADXLSMS[bf13] += iS*DXSLMX[bf24]    *BC[MNKL+sx]; }
\DoxyCodeLine{3961             ADXLSMS[bf13] += iS*DXSLMY[bf24]    *BC[MNKL+sy]; }
\DoxyCodeLine{3962             ADXLSMS[bf13] += iS*DXSLMZ[bf24]    *BC[MNKL+sz]; }
\DoxyCodeLine{3963             ADXLSMS[bf13] -\/= iS*DXSLMX[bf24]    *BC[MNKL+xs]; }
\DoxyCodeLine{3964             ADXLSMS[bf13] -\/= iS*DXSLMY[bf24]    *BC[MNKL+ys]; }
\DoxyCodeLine{3965             ADXLSMS[bf13] -\/= iS*DXSLMZ[bf24]    *BC[MNKL+zs]; }
\DoxyCodeLine{3966             ADXLSMS[bf13] +=    DXSLMS[bf24]    *BC[MNKL+\mbox{\hyperlink{namespaceChronusQ_a208436762fbd254ff0fa550f917b96fe}{dot}}];}
\DoxyCodeLine{3967             ADXLSMS[bf13] -\/= iS*DXSLMX[bf24]    *BC[MNKL+crossx];}
\DoxyCodeLine{3968             ADXLSMS[bf13] -\/= iS*DXSLMY[bf24]    *BC[MNKL+crossy];}
\DoxyCodeLine{3969             ADXLSMS[bf13] -\/= iS*DXSLMZ[bf24]    *BC[MNKL+crossz];}
\DoxyCodeLine{3970             }
\DoxyCodeLine{3971             ADXLSMZ[bf13] -\/=    DXSLMZ[bf24]    *BC[MNKL]; }
\DoxyCodeLine{3972             ADXLSMZ[bf13] += iS*DXSLMS[bf24]    *BC[MNKL+sz]; }
\DoxyCodeLine{3973             ADXLSMZ[bf13] -\/=    DXSLMX[bf24]    *BC[MNKL+sy]; }
\DoxyCodeLine{3974             ADXLSMZ[bf13] +=    DXSLMY[bf24]    *BC[MNKL+sx]; }
\DoxyCodeLine{3975             ADXLSMZ[bf13] -\/= iS*DXSLMS[bf24]    *BC[MNKL+zs]; }
\DoxyCodeLine{3976             ADXLSMZ[bf13] -\/=    DXSLMX[bf24]    *BC[MNKL+ys]; }
\DoxyCodeLine{3977             ADXLSMZ[bf13] +=    DXSLMY[bf24]    *BC[MNKL+xs]; }
\DoxyCodeLine{3978             ADXLSMZ[bf13] +=    DXSLMZ[bf24]    *BC[MNKL+mxxmyypzz];}
\DoxyCodeLine{3979             ADXLSMZ[bf13] += iS*DXSLMS[bf24]    *BC[MNKL+crossz];}
\DoxyCodeLine{3980             ADXLSMZ[bf13] +=    DXSLMX[bf24]    *BC[MNKL+zxpxz];}
\DoxyCodeLine{3981             ADXLSMZ[bf13] +=    DXSLMY[bf24]    *BC[MNKL+yzpzy];}
\DoxyCodeLine{3982             }
\DoxyCodeLine{3983             ADXLSMX[bf13] -\/=    DXSLMX[bf24]    *BC[MNKL]; }
\DoxyCodeLine{3984             ADXLSMX[bf13] += iS*DXSLMS[bf24]    *BC[MNKL+sx]; }
\DoxyCodeLine{3985             ADXLSMX[bf13] -\/=    DXSLMY[bf24]    *BC[MNKL+sz]; }
\DoxyCodeLine{3986             ADXLSMX[bf13] +=    DXSLMZ[bf24]    *BC[MNKL+sy]; }
\DoxyCodeLine{3987             ADXLSMX[bf13] -\/= iS*DXSLMS[bf24]    *BC[MNKL+xs]; }
\DoxyCodeLine{3988             ADXLSMX[bf13] -\/=    DXSLMY[bf24]    *BC[MNKL+zs]; }
\DoxyCodeLine{3989             ADXLSMX[bf13] +=    DXSLMZ[bf24]    *BC[MNKL+ys]; }
\DoxyCodeLine{3990             ADXLSMX[bf13] +=    DXSLMX[bf24]    *BC[MNKL+pxxmyymzz];}
\DoxyCodeLine{3991             ADXLSMX[bf13] += iS*DXSLMS[bf24]    *BC[MNKL+crossx];}
\DoxyCodeLine{3992             ADXLSMX[bf13] +=    DXSLMY[bf24]    *BC[MNKL+xypyx];}
\DoxyCodeLine{3993             ADXLSMX[bf13] +=    DXSLMZ[bf24]    *BC[MNKL+zxpxz];}
\DoxyCodeLine{3994             }
\DoxyCodeLine{3995             ADXLSMY[bf13] -\/=    DXSLMY[bf24]    *BC[MNKL]; }
\DoxyCodeLine{3996             ADXLSMY[bf13] += iS*DXSLMS[bf24]    *BC[MNKL+sy]; }
\DoxyCodeLine{3997             ADXLSMY[bf13] +=    DXSLMX[bf24]    *BC[MNKL+sz]; }
\DoxyCodeLine{3998             ADXLSMY[bf13] -\/=    DXSLMZ[bf24]    *BC[MNKL+sx]; }
\DoxyCodeLine{3999             ADXLSMY[bf13] -\/= iS*DXSLMS[bf24]    *BC[MNKL+ys]; }
\DoxyCodeLine{4000             ADXLSMY[bf13] +=    DXSLMX[bf24]    *BC[MNKL+zs]; }
\DoxyCodeLine{4001             ADXLSMY[bf13] -\/=    DXSLMZ[bf24]    *BC[MNKL+xs]; }
\DoxyCodeLine{4002             ADXLSMY[bf13] +=    DXSLMY[bf24]    *BC[MNKL+mxxpyymzz];}
\DoxyCodeLine{4003             ADXLSMY[bf13] += iS*DXSLMS[bf24]    *BC[MNKL+crossy];}
\DoxyCodeLine{4004             ADXLSMY[bf13] +=    DXSLMX[bf24]    *BC[MNKL+xypyx];}
\DoxyCodeLine{4005             ADXLSMY[bf13] +=    DXSLMZ[bf24]    *BC[MNKL+yzpzy];}
\DoxyCodeLine{4006             }
\DoxyCodeLine{4007             \textcolor{comment}{// LKNM, TRANS\_KL}}
\DoxyCodeLine{4008             \textcolor{keywordflow}{if}(bf1\_s!=bf4\_s or bf2\_s!=bf3\_s) \{}
\DoxyCodeLine{4009               ADXLSMS[bf42] -\/=    DXSLMS[bf31]    *BC[LKNM]; }
\DoxyCodeLine{4010               ADXLSMS[bf42] += iS*DXSLMX[bf31]    *BC[LKNM+sx]; }
\DoxyCodeLine{4011               ADXLSMS[bf42] += iS*DXSLMY[bf31]    *BC[LKNM+sy]; }
\DoxyCodeLine{4012               ADXLSMS[bf42] += iS*DXSLMZ[bf31]    *BC[LKNM+sz]; }
\DoxyCodeLine{4013               ADXLSMS[bf42] -\/= iS*DXSLMX[bf31]    *BC[LKNM+xs]; }
\DoxyCodeLine{4014               ADXLSMS[bf42] -\/= iS*DXSLMY[bf31]    *BC[LKNM+ys]; }
\DoxyCodeLine{4015               ADXLSMS[bf42] -\/= iS*DXSLMZ[bf31]    *BC[LKNM+zs]; }
\DoxyCodeLine{4016               ADXLSMS[bf42] +=    DXSLMS[bf31]    *BC[LKNM+\mbox{\hyperlink{namespaceChronusQ_a208436762fbd254ff0fa550f917b96fe}{dot}}];}
\DoxyCodeLine{4017               ADXLSMS[bf42] -\/= iS*DXSLMX[bf31]    *BC[LKNM+crossx];}
\DoxyCodeLine{4018               ADXLSMS[bf42] -\/= iS*DXSLMY[bf31]    *BC[LKNM+crossy];}
\DoxyCodeLine{4019               ADXLSMS[bf42] -\/= iS*DXSLMZ[bf31]    *BC[LKNM+crossz];}
\DoxyCodeLine{4020               }
\DoxyCodeLine{4021               ADXLSMZ[bf42] -\/=    DXSLMZ[bf31]    *BC[LKNM]; }
\DoxyCodeLine{4022               ADXLSMZ[bf42] += iS*DXSLMS[bf31]    *BC[LKNM+sz]; }
\DoxyCodeLine{4023               ADXLSMZ[bf42] -\/=    DXSLMX[bf31]    *BC[LKNM+sy]; }
\DoxyCodeLine{4024               ADXLSMZ[bf42] +=    DXSLMY[bf31]    *BC[LKNM+sx]; }
\DoxyCodeLine{4025               ADXLSMZ[bf42] -\/= iS*DXSLMS[bf31]    *BC[LKNM+zs]; }
\DoxyCodeLine{4026               ADXLSMZ[bf42] -\/=    DXSLMX[bf31]    *BC[LKNM+ys]; }
\DoxyCodeLine{4027               ADXLSMZ[bf42] +=    DXSLMY[bf31]    *BC[LKNM+xs]; }
\DoxyCodeLine{4028               ADXLSMZ[bf42] +=    DXSLMZ[bf31]    *BC[LKNM+mxxmyypzz];}
\DoxyCodeLine{4029               ADXLSMZ[bf42] += iS*DXSLMS[bf31]    *BC[LKNM+crossz];}
\DoxyCodeLine{4030               ADXLSMZ[bf42] +=    DXSLMX[bf31]    *BC[LKNM+zxpxz];}
\DoxyCodeLine{4031               ADXLSMZ[bf42] +=    DXSLMY[bf31]    *BC[LKNM+yzpzy];}
\DoxyCodeLine{4032               }
\DoxyCodeLine{4033               ADXLSMX[bf42] -\/=    DXSLMX[bf31]    *BC[LKNM]; }
\DoxyCodeLine{4034               ADXLSMX[bf42] += iS*DXSLMS[bf31]    *BC[LKNM+sx]; }
\DoxyCodeLine{4035               ADXLSMX[bf42] -\/=    DXSLMY[bf31]    *BC[LKNM+sz]; }
\DoxyCodeLine{4036               ADXLSMX[bf42] +=    DXSLMZ[bf31]    *BC[LKNM+sy]; }
\DoxyCodeLine{4037               ADXLSMX[bf42] -\/= iS*DXSLMS[bf31]    *BC[LKNM+xs]; }
\DoxyCodeLine{4038               ADXLSMX[bf42] -\/=    DXSLMY[bf31]    *BC[LKNM+zs]; }
\DoxyCodeLine{4039               ADXLSMX[bf42] +=    DXSLMZ[bf31]    *BC[LKNM+ys]; }
\DoxyCodeLine{4040               ADXLSMX[bf42] +=    DXSLMX[bf31]    *BC[LKNM+pxxmyymzz];}
\DoxyCodeLine{4041               ADXLSMX[bf42] += iS*DXSLMS[bf31]    *BC[LKNM+crossx];}
\DoxyCodeLine{4042               ADXLSMX[bf42] +=    DXSLMY[bf31]    *BC[LKNM+xypyx];}
\DoxyCodeLine{4043               ADXLSMX[bf42] +=    DXSLMZ[bf31]    *BC[LKNM+zxpxz];}
\DoxyCodeLine{4044               }
\DoxyCodeLine{4045               ADXLSMY[bf42] -\/=    DXSLMY[bf31]    *BC[LKNM]; }
\DoxyCodeLine{4046               ADXLSMY[bf42] += iS*DXSLMS[bf31]    *BC[LKNM+sy]; }
\DoxyCodeLine{4047               ADXLSMY[bf42] +=    DXSLMX[bf31]    *BC[LKNM+sz]; }
\DoxyCodeLine{4048               ADXLSMY[bf42] -\/=    DXSLMZ[bf31]    *BC[LKNM+sx]; }
\DoxyCodeLine{4049               ADXLSMY[bf42] -\/= iS*DXSLMS[bf31]    *BC[LKNM+ys]; }
\DoxyCodeLine{4050               ADXLSMY[bf42] +=    DXSLMX[bf31]    *BC[LKNM+zs]; }
\DoxyCodeLine{4051               ADXLSMY[bf42] -\/=    DXSLMZ[bf31]    *BC[LKNM+xs]; }
\DoxyCodeLine{4052               ADXLSMY[bf42] +=    DXSLMY[bf31]    *BC[LKNM+mxxpyymzz];}
\DoxyCodeLine{4053               ADXLSMY[bf42] += iS*DXSLMS[bf31]    *BC[LKNM+crossy];}
\DoxyCodeLine{4054               ADXLSMY[bf42] +=    DXSLMX[bf31]    *BC[LKNM+xypyx];}
\DoxyCodeLine{4055               ADXLSMY[bf42] +=    DXSLMZ[bf31]    *BC[LKNM+yzpzy];}
\DoxyCodeLine{4056             \}}
\DoxyCodeLine{4057 }
\DoxyCodeLine{4058 }
\DoxyCodeLine{4059           \}}
\DoxyCodeLine{4060           \}}
\DoxyCodeLine{4061           \}}
\DoxyCodeLine{4062           \} \textcolor{comment}{// contraction loop}}
\DoxyCodeLine{4063   }
\DoxyCodeLine{4064 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// Contraction}}
\DoxyCodeLine{4065   }
\DoxyCodeLine{4066   }
\DoxyCodeLine{4067         \}; \textcolor{comment}{// loop s4}}
\DoxyCodeLine{4068         \}; \textcolor{comment}{// loop s3}}
\DoxyCodeLine{4069         \}; \textcolor{comment}{// loop s2}}
\DoxyCodeLine{4070         \}; \textcolor{comment}{// loop s1}}
\DoxyCodeLine{4071   }
\DoxyCodeLine{4072   }
\DoxyCodeLine{4073       \} \textcolor{comment}{// OpenMP context}}
\DoxyCodeLine{4074   }
\DoxyCodeLine{4075   }
\DoxyCodeLine{4076       \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iTh  = 0; iTh < nThreads; iTh++) \{}
\DoxyCodeLine{4077 }
\DoxyCodeLine{4078         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{4079            matList[XLLMS].AX,nBasis,matList[XLLMS].AX,nBasis);}
\DoxyCodeLine{4080 }
\DoxyCodeLine{4081         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{4082            matList[XLLMX].AX,nBasis,matList[XLLMX].AX,nBasis);}
\DoxyCodeLine{4083 }
\DoxyCodeLine{4084         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{4085            matList[XLLMY].AX,nBasis,matList[XLLMY].AX,nBasis);}
\DoxyCodeLine{4086 }
\DoxyCodeLine{4087         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLLMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{4088            matList[XLLMZ].AX,nBasis,matList[XLLMZ].AX,nBasis);}
\DoxyCodeLine{4089 }
\DoxyCodeLine{4090 }
\DoxyCodeLine{4091 }
\DoxyCodeLine{4092         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{4093            matList[XSSMS].AX,nBasis,matList[XSSMS].AX,nBasis);}
\DoxyCodeLine{4094 }
\DoxyCodeLine{4095         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{4096            matList[XSSMX].AX,nBasis,matList[XSSMX].AX,nBasis);}
\DoxyCodeLine{4097 }
\DoxyCodeLine{4098         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{4099            matList[XSSMY].AX,nBasis,matList[XSSMY].AX,nBasis);}
\DoxyCodeLine{4100 }
\DoxyCodeLine{4101         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XSSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{4102            matList[XSSMZ].AX,nBasis,matList[XSSMZ].AX,nBasis);}
\DoxyCodeLine{4103 }
\DoxyCodeLine{4104 }
\DoxyCodeLine{4105 }
\DoxyCodeLine{4106         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{4107            matList[CLSMS].AX,nBasis,matList[CLSMS].AX,nBasis);}
\DoxyCodeLine{4108 }
\DoxyCodeLine{4109         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{4110            matList[CLSMX].AX,nBasis,matList[CLSMX].AX,nBasis);}
\DoxyCodeLine{4111 }
\DoxyCodeLine{4112         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{4113            matList[CLSMY].AX,nBasis,matList[CLSMY].AX,nBasis);}
\DoxyCodeLine{4114 }
\DoxyCodeLine{4115         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][CLSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{4116            matList[CLSMZ].AX,nBasis,matList[CLSMZ].AX,nBasis);}
\DoxyCodeLine{4117  }
\DoxyCodeLine{4118 }
\DoxyCodeLine{4119   }
\DoxyCodeLine{4120         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMS],nBasis,MatsT(1.0),}
\DoxyCodeLine{4121            matList[XLSMS].AX,nBasis,matList[XLSMS].AX,nBasis);}
\DoxyCodeLine{4122 }
\DoxyCodeLine{4123         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMX],nBasis,MatsT(1.0),}
\DoxyCodeLine{4124            matList[XLSMX].AX,nBasis,matList[XLSMX].AX,nBasis);}
\DoxyCodeLine{4125 }
\DoxyCodeLine{4126         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMY],nBasis,MatsT(1.0),}
\DoxyCodeLine{4127            matList[XLSMY].AX,nBasis,matList[XLSMY].AX,nBasis);}
\DoxyCodeLine{4128 }
\DoxyCodeLine{4129         \mbox{\hyperlink{namespaceChronusQ_ac389ba57a99d66c5b26de24a6a58aebb}{MatAdd}}(\textcolor{charliteral}{'N'},\textcolor{charliteral}{'N'},nBasis,nBasis,MatsT(1.0),AXthreads[iTh][XLSMZ],nBasis,MatsT(1.0),}
\DoxyCodeLine{4130            matList[XLSMZ].AX,nBasis,matList[XLSMZ].AX,nBasis);}
\DoxyCodeLine{4131   }
\DoxyCodeLine{4132       \};}
\DoxyCodeLine{4133    }
\DoxyCodeLine{4134       memManager\_.free(ERIBuffer);}
\DoxyCodeLine{4135       memManager\_.free(buffAll, cacheAll);}
\DoxyCodeLine{4136 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{4137       \textcolor{keywordflow}{if}(ShBlkNorms\_raw!=\textcolor{keyword}{nullptr}) memManager\_.free(ShBlkNorms\_raw);}
\DoxyCodeLine{4138       \textcolor{keywordflow}{if}(SchwarzGauge!=\textcolor{keyword}{nullptr}) memManager\_.free(SchwarzGauge);}
\DoxyCodeLine{4139 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4140   }
\DoxyCodeLine{4141 \textcolor{preprocessor}{\#ifdef \_REPORT\_INTEGRAL\_TIMINGS}}
\DoxyCodeLine{4142       \textcolor{keywordtype}{size\_t} nIntSkipGauge = std::accumulate(nSkipGauge.begin(),nSkipGauge.end(),0);}
\DoxyCodeLine{4143       std::cout << \textcolor{stringliteral}{"{}Gauge Screened "{}} << nIntSkipGauge << std::endl;}
\DoxyCodeLine{4144   }
\DoxyCodeLine{4145       \textcolor{keyword}{auto} durDirectGauge = \mbox{\hyperlink{namespaceChronusQ_a3b2153e93af4532ff5b1e75d8af453b0}{tock}}(topDirectGauge);}
\DoxyCodeLine{4146       std::cout << \textcolor{stringliteral}{"{}Gauge AO Direct Contraction took "{}} <<  durDirectGauge << \textcolor{stringliteral}{"{} s\(\backslash\)n"{}}; }
\DoxyCodeLine{4147   }
\DoxyCodeLine{4148       std::cout << std::endl;}
\DoxyCodeLine{4149 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4150 }
\DoxyCodeLine{4151     \} \textcolor{comment}{// if(Gauge)}}
\DoxyCodeLine{4152 }
\DoxyCodeLine{4153 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{4154     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{4155     \textcolor{comment}{/*   End of Gauge  */}}
\DoxyCodeLine{4156     \textcolor{comment}{/*                 */}}
\DoxyCodeLine{4157 \textcolor{comment}{    /*******************/}}
\DoxyCodeLine{4158 }
\DoxyCodeLine{4159 }
\DoxyCodeLine{4160 }
\DoxyCodeLine{4161 }
\DoxyCodeLine{4162 }
\DoxyCodeLine{4163 }
\DoxyCodeLine{4164 \textcolor{preprocessor}{\#ifdef \_SHZ\_SCREEN\_4C}}
\DoxyCodeLine{4165     \textcolor{keywordflow}{if}(SchwarzSSSS!=\textcolor{keyword}{nullptr}) memManager\_.free(SchwarzSSSS);}
\DoxyCodeLine{4166     \textcolor{keywordflow}{if}(SchwarzERI!=\textcolor{keyword}{nullptr}) memManager\_.free(SchwarzERI);}
\DoxyCodeLine{4167 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4168 }
\DoxyCodeLine{4169     \textcolor{keywordflow}{if}(AXRaw!=\textcolor{keyword}{nullptr}) memManager\_.free(AXRaw);}
\DoxyCodeLine{4170 }
\DoxyCodeLine{4171     memManager\_.free(atm);}
\DoxyCodeLine{4172     memManager\_.free(bas);}
\DoxyCodeLine{4173     memManager\_.free(env);}
\DoxyCodeLine{4174 }
\DoxyCodeLine{4175 }
\DoxyCodeLine{4176     \textcolor{comment}{// Turn threads for LA back on}}
\DoxyCodeLine{4177     \mbox{\hyperlink{namespaceChronusQ_a7b13ac1d1109f4a015feaab04cb3eaee}{SetLAThreads}}(LAThreads);}
\DoxyCodeLine{4178 }
\DoxyCodeLine{4179   \}}
\DoxyCodeLine{4180 }
\DoxyCodeLine{4181   \textcolor{keyword}{template} <>}
\DoxyCodeLine{4182   \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1GTODirectRelERIContraction_a958c5d3fc117a71037c81481da7dc719}{GTODirectRelERIContraction<double,double>::directScaffoldLibcint}}(}
\DoxyCodeLine{4183     \mbox{\hyperlink{structChronusQ_1_1MPI__Comm}{MPI\_Comm}} comm, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} screen,}
\DoxyCodeLine{4184     std::vector<\mbox{\hyperlink{structChronusQ_1_1TwoBodyContraction}{TwoBodyContraction<double>}}> \&matList)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{4185     \mbox{\hyperlink{namespaceChronusQ_afbba655765a7a40e19e2bea928a687c7}{CErr}}(\textcolor{stringliteral}{"{}Dirac-\/Coulomb + Real is an invalid option"{}},std::cout);  }
\DoxyCodeLine{4186   \}}
\DoxyCodeLine{4187 }
\DoxyCodeLine{4188   \textcolor{keyword}{template} <>}
\DoxyCodeLine{4189   \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1GTODirectRelERIContraction_a958c5d3fc117a71037c81481da7dc719}{GTODirectRelERIContraction<dcomplex,dcomplex>::directScaffoldLibcint}}(}
\DoxyCodeLine{4190     \mbox{\hyperlink{structChronusQ_1_1MPI__Comm}{MPI\_Comm}} comm, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} screen,}
\DoxyCodeLine{4191     std::vector<\mbox{\hyperlink{structChronusQ_1_1TwoBodyContraction}{TwoBodyContraction<dcomplex>}}> \&matList)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{4192     \mbox{\hyperlink{namespaceChronusQ_afbba655765a7a40e19e2bea928a687c7}{CErr}}(\textcolor{stringliteral}{"{}Complex integral is is an invalid option"{}},std::cout);  }
\DoxyCodeLine{4193   \}}
\DoxyCodeLine{4194 }
\DoxyCodeLine{4195 \}; \textcolor{comment}{// namespace ChronusQ}}
\DoxyCodeLine{4196 }
\DoxyCodeLine{4197 }
\DoxyCodeLine{4198 }
\DoxyCodeLine{4199 }
\DoxyCodeLine{4200 }
\DoxyCodeLine{4201 }
\DoxyCodeLine{4202 }
\DoxyCodeLine{4203 }
\DoxyCodeLine{4204 }
\DoxyCodeLine{4205 }
\DoxyCodeLine{4206 }

\end{DoxyCode}
