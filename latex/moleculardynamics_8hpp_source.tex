\hypertarget{moleculardynamics_8hpp_source}{}\doxysection{moleculardynamics.\+hpp}
\label{moleculardynamics_8hpp_source}\index{include/geometrymodifier/moleculardynamics.hpp@{include/geometrymodifier/moleculardynamics.hpp}}
\mbox{\hyperlink{moleculardynamics_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ *  This file is part of the Chronus Quantum (ChronusQ) software package}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ *  Copyright (C) 2014-\/2022 Li Research Group (University of Washington)}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ *  This program is free software; you can redistribute it and/or modify}}
\DoxyCodeLine{7 \textcolor{comment}{ *  it under the terms of the GNU General Public License as published by}}
\DoxyCodeLine{8 \textcolor{comment}{ *  the Free Software Foundation; either version 2 of the License, or}}
\DoxyCodeLine{9 \textcolor{comment}{ *  (at your option) any later version.}}
\DoxyCodeLine{10 \textcolor{comment}{ *}}
\DoxyCodeLine{11 \textcolor{comment}{ *  This program is distributed in the hope that it will be useful,}}
\DoxyCodeLine{12 \textcolor{comment}{ *  but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{13 \textcolor{comment}{ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{14 \textcolor{comment}{ *  GNU General Public License for more details.}}
\DoxyCodeLine{15 \textcolor{comment}{ *}}
\DoxyCodeLine{16 \textcolor{comment}{ *  You should have received a copy of the GNU General Public License along}}
\DoxyCodeLine{17 \textcolor{comment}{ *  with this program; if not, write to the Free Software Foundation, Inc.,}}
\DoxyCodeLine{18 \textcolor{comment}{ *  51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301 USA.}}
\DoxyCodeLine{19 \textcolor{comment}{ *}}
\DoxyCodeLine{20 \textcolor{comment}{ *  Contact the Developers:}}
\DoxyCodeLine{21 \textcolor{comment}{ *    E-\/Mail: xsli@uw.edu}}
\DoxyCodeLine{22 \textcolor{comment}{ *}}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{molecule_8hpp}{molecule.hpp}}>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{geometrymodifier_8hpp}{geometrymodifier.hpp}}>}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceChronusQ}{ChronusQ}} \{}
\DoxyCodeLine{30 }
\DoxyCodeLine{34   \textcolor{keyword}{class }\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics}{MolecularDynamics}} : \textcolor{keyword}{public} \mbox{\hyperlink{classChronusQ_1_1GeometryModifier}{GeometryModifier}} \{}
\DoxyCodeLine{35 }
\DoxyCodeLine{36     \mbox{\hyperlink{structChronusQ_1_1IntegrationProgress}{IntegrationProgress}} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}};}
\DoxyCodeLine{37     \textcolor{keywordtype}{double} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_acd9d24a0defab9d49195343ba22a7367}{tMax}};}
\DoxyCodeLine{38 }
\DoxyCodeLine{39   \textcolor{keyword}{public}:}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     std::function<std::vector<double>()> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a961df401a498c9cce04bff0000f2db96}{gradientGetter}};}
\DoxyCodeLine{42     std::function<double(\textcolor{keywordtype}{double})> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abeb37f31a87ba3426c2743a838b9ee03}{finalMidpointFock}};}
\DoxyCodeLine{43     std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}};}
\DoxyCodeLine{44     std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}};  }
\DoxyCodeLine{45     std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}};   }
\DoxyCodeLine{46     std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}};      }
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{keywordtype}{double}   \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}};      }
\DoxyCodeLine{49     \textcolor{keywordtype}{double}   \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a0e164f53f5a1c454a3549ce506c7213f}{totalEnergy0}};              }
\DoxyCodeLine{50     \textcolor{keywordtype}{double}   \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a0795c3d4dfada7767fd791333650df42}{previousTotalEnergy}};       }
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{comment}{// Constructors}}
\DoxyCodeLine{53     \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a7c50712bea32887567cfe12b209f5689}{MolecularDynamics}}() = \textcolor{keyword}{delete};}
\DoxyCodeLine{54     \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_ae85ffe2c70409b34f3bdc5e6c1f7a130}{MolecularDynamics}}(\mbox{\hyperlink{structChronusQ_1_1MolecularOptions}{MolecularOptions}} molecularOptions, \mbox{\hyperlink{structChronusQ_1_1Molecule}{Molecule}}\& molecule) :}
\DoxyCodeLine{55       \mbox{\hyperlink{classChronusQ_1_1GeometryModifier}{GeometryModifier}}(molecularOptions),}
\DoxyCodeLine{56       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}(3*molecule.nAtoms, 0.),}
\DoxyCodeLine{57       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}(3*molecule.nAtoms, 0.),}
\DoxyCodeLine{58       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}(3*molecule.nAtoms, 0.),}
\DoxyCodeLine{59       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}(3*molecule.nAtoms, 0.)}
\DoxyCodeLine{60     \{}
\DoxyCodeLine{61       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a1ba583060b820327aa220a3ac9d6a6}{stepSize}} = molecularOptions.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_abd4b1ff56d4c62b1f9900b1056e77a4a}{timeStepAU}};}
\DoxyCodeLine{62       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_acd9d24a0defab9d49195343ba22a7367}{tMax}} = molecularOptions.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_abd4b1ff56d4c62b1f9900b1056e77a4a}{timeStepAU}} * molecularOptions.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_ac45795231a0cf56336cbd6f1a92c5d33}{nNuclearSteps}};}
\DoxyCodeLine{63     \};}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     \textcolor{comment}{// Different type}}
\DoxyCodeLine{66     \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a7d144cb0726e994f75e21e08e810aaec}{MolecularDynamics}}(\textcolor{keyword}{const} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics}{MolecularDynamics}} \&other):}
\DoxyCodeLine{67         \mbox{\hyperlink{classChronusQ_1_1GeometryModifier}{GeometryModifier}}(other)\{\}}
\DoxyCodeLine{68     \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a4327350d623175a4641fe396a7147e28}{MolecularDynamics}}(\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics}{MolecularDynamics}} \&\&other):}
\DoxyCodeLine{69         \mbox{\hyperlink{classChronusQ_1_1GeometryModifier}{GeometryModifier}}(other)\{\}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \textcolor{comment}{// Virtual destructor}}
\DoxyCodeLine{72     \textcolor{keyword}{virtual} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_aea224192420056f26124620b5f0f20c2}{\string~MolecularDynamics}}() \{\}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8f8fb281eeeb0eb36ae89e8c7b3bb0c1}{initializeMD}}(\mbox{\hyperlink{structChronusQ_1_1Molecule}{Molecule}}\& molecule)\{}
\DoxyCodeLine{75 }
\DoxyCodeLine{76       std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}(3*molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_abe50222c8aa9cb69f03dbab8623ff171}{nAtoms}}, 0.);}
\DoxyCodeLine{77       std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}(3*molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_abe50222c8aa9cb69f03dbab8623ff171}{nAtoms}}, 0.);}
\DoxyCodeLine{78       std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}(3*molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_abe50222c8aa9cb69f03dbab8623ff171}{nAtoms}}, 0.);}
\DoxyCodeLine{79       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}} = 0.0;}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     }
\DoxyCodeLine{90     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a6e38110b723f8a5576d877d9fd42975f}{update}}(\textcolor{keywordtype}{bool} print,}
\DoxyCodeLine{91                 \mbox{\hyperlink{structChronusQ_1_1Molecule}{Molecule}} \&molecule,}
\DoxyCodeLine{92                 \textcolor{keywordtype}{bool} firstStep)}
\DoxyCodeLine{93     \{}
\DoxyCodeLine{94 }
\DoxyCodeLine{95       \textcolor{comment}{// Update time data}}
\DoxyCodeLine{96       \textcolor{keywordflow}{if}( firstStep )}
\DoxyCodeLine{97         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a76e4568e69c2c01a3d1ed32dc20c34}{iStep}} = 0;}
\DoxyCodeLine{98       \textcolor{keywordflow}{else}}
\DoxyCodeLine{99         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a76e4568e69c2c01a3d1ed32dc20c34}{iStep}}++;}
\DoxyCodeLine{100 }
\DoxyCodeLine{101       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a3ebf38f24a1b4963af3562a39fed9fde}{xTime}} = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a76e4568e69c2c01a3d1ed32dc20c34}{iStep}} * \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a1ba583060b820327aa220a3ac9d6a6}{stepSize}};}
\DoxyCodeLine{102       \textcolor{keywordflow}{if}( \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}} != 0 )}
\DoxyCodeLine{103         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a3ebf38f24a1b4963af3562a39fed9fde}{xTime}} /= \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}};}
\DoxyCodeLine{104 }
\DoxyCodeLine{105       \textcolor{keyword}{auto} doGrad = \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}} == 0 || }
\DoxyCodeLine{106                     \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a76e4568e69c2c01a3d1ed32dc20c34}{iStep}} \% \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}} == 0;}
\DoxyCodeLine{107 }
\DoxyCodeLine{108       \textcolor{comment}{// Update gradient whenever we restart midpoint fock}}
\DoxyCodeLine{109       \textcolor{keywordflow}{if}( doGrad ) \{}
\DoxyCodeLine{110 }
\DoxyCodeLine{111         \textcolor{comment}{// If we have midpoint fock steps, we need to take the final fock step}}
\DoxyCodeLine{112         \textcolor{keywordflow}{if}( \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}} != 0 \&\& !firstStep ) \{}
\DoxyCodeLine{113           \textcolor{keywordtype}{double} fock\_dt = \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_abd4b1ff56d4c62b1f9900b1056e77a4a}{timeStepAU}}/(\mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}} + 1);}
\DoxyCodeLine{114           \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_afe9ac366e8e661f3a4c4b592fa913d69}{geometryVV}}(molecule, \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}, fock\_dt);}
\DoxyCodeLine{115           molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_ac6be829fb33f455af224974ae5d3d01a}{update}}();}
\DoxyCodeLine{116           \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_ae81404c345ad5a6ee7da169864f71288}{electronicPotentialEnergy}} = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abeb37f31a87ba3426c2743a838b9ee03}{finalMidpointFock}}(\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a76e4568e69c2c01a3d1ed32dc20c34}{iStep}}*fock\_dt);}
\DoxyCodeLine{117         \}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}} = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a961df401a498c9cce04bff0000f2db96}{gradientGetter}}();}
\DoxyCodeLine{120 }
\DoxyCodeLine{121       \}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123       \textcolor{keywordtype}{bool} moveGeometry = \textcolor{keyword}{true};}
\DoxyCodeLine{124       \textcolor{keywordtype}{bool} moveVelocity = doGrad;}
\DoxyCodeLine{125 }
\DoxyCodeLine{126       \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{127 }
\DoxyCodeLine{128       \textcolor{keywordflow}{if}(print and doGrad) \{}
\DoxyCodeLine{129         std::cout << std::endl;}
\DoxyCodeLine{130         std::cout << \textcolor{stringliteral}{"{}MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD-\/MD"{}}<<std::endl;}
\DoxyCodeLine{131         std::cout << \textcolor{stringliteral}{"{}Molecular Dynamics Information for Step "{}}<<std::setw(8)<<\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a76e4568e69c2c01a3d1ed32dc20c34}{iStep}}<<std::endl;}
\DoxyCodeLine{132         std::cout << std::scientific << std::setprecision(12);}
\DoxyCodeLine{133 }
\DoxyCodeLine{134         std::cout << std::endl<<\textcolor{stringliteral}{"{}Molecular Geometry: (Bohr)"{}}<<std::endl;}
\DoxyCodeLine{135         \textcolor{keywordflow}{for}( \mbox{\hyperlink{structChronusQ_1_1Atom}{Atom}}\& atom : molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a21a4326a73a48d5e20de3b4117fe08cf}{atoms}} ) \{}
\DoxyCodeLine{136 }
\DoxyCodeLine{137           std::cout << std::right <<\textcolor{stringliteral}{"{}AtomicNumber = "{}} << std::setw(4) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_ac304c587a6eff864371d8d2d7558b13f}{atomicNumber}} }
\DoxyCodeLine{138                     << std::right <<\textcolor{stringliteral}{"{}  X= "{}}<< std::setw(19) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[0]}
\DoxyCodeLine{139                     << std::right <<\textcolor{stringliteral}{"{}  Y= "{}}<< std::setw(19) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[1]}
\DoxyCodeLine{140                     << std::right <<\textcolor{stringliteral}{"{}  Z= "{}}<< std::setw(19) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[2] <<std::endl;}
\DoxyCodeLine{141           i += 3;}
\DoxyCodeLine{142  }
\DoxyCodeLine{143         \}}
\DoxyCodeLine{144       \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 }
\DoxyCodeLine{147       \textcolor{comment}{// if velocity Verlet}}
\DoxyCodeLine{148       \textcolor{keywordflow}{if}(moveVelocity) \{}
\DoxyCodeLine{149         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_ae40048b1c84055ded73b751249eae93d}{velocityVV}}(molecule, \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}, \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_abd4b1ff56d4c62b1f9900b1056e77a4a}{timeStepAU}}, firstStep);}
\DoxyCodeLine{150         \textcolor{comment}{// compute kinetic energy}}
\DoxyCodeLine{151         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a5dc89ff1c66d37eb13ae5ec8e90ab920}{computeKineticEnergy}}(molecule);}
\DoxyCodeLine{152       \}}
\DoxyCodeLine{153       \textcolor{keywordflow}{if}(moveGeometry) \{}
\DoxyCodeLine{154         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_afe9ac366e8e661f3a4c4b592fa913d69}{geometryVV}}(molecule, \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}, \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_abd4b1ff56d4c62b1f9900b1056e77a4a}{timeStepAU}}/(\mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}} + 1)); }
\DoxyCodeLine{155       \}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157       \textcolor{comment}{// update other quantities}}
\DoxyCodeLine{158       molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_ac6be829fb33f455af224974ae5d3d01a}{update}}();}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 }
\DoxyCodeLine{161       \textcolor{comment}{// Compute total energies}}
\DoxyCodeLine{162       \textcolor{keywordtype}{double} totalEnergy = \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_ae81404c345ad5a6ee7da169864f71288}{electronicPotentialEnergy}} + \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}};}
\DoxyCodeLine{163       \textcolor{keywordflow}{if}(firstStep) \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a0e164f53f5a1c454a3549ce506c7213f}{totalEnergy0}} = totalEnergy;}
\DoxyCodeLine{164       \textcolor{keywordflow}{if}(firstStep) \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a0795c3d4dfada7767fd791333650df42}{previousTotalEnergy}} = totalEnergy;}
\DoxyCodeLine{165 }
\DoxyCodeLine{166       \textcolor{comment}{// output important dynamic information}}
\DoxyCodeLine{167       \textcolor{keywordflow}{if}(print and doGrad) \{}
\DoxyCodeLine{168 }
\DoxyCodeLine{169         std::cout << std::setprecision(12);}
\DoxyCodeLine{170         std::cout << \textcolor{stringliteral}{"{}Velocity:"{}}<<std::endl;}
\DoxyCodeLine{171         i = 0;}
\DoxyCodeLine{172         \textcolor{keywordflow}{for}( \mbox{\hyperlink{structChronusQ_1_1Atom}{Atom}}\& atom : molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a21a4326a73a48d5e20de3b4117fe08cf}{atoms}} ) \{}
\DoxyCodeLine{173 }
\DoxyCodeLine{174           std::cout << std::right <<\textcolor{stringliteral}{"{}AtomicNumber = "{}} << std::setw(4) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_ac304c587a6eff864371d8d2d7558b13f}{atomicNumber}} }
\DoxyCodeLine{175                     << std::right <<\textcolor{stringliteral}{"{}  X= "{}}<< std::setw(19) <<  \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i  ]}
\DoxyCodeLine{176                     << std::right <<\textcolor{stringliteral}{"{}  Y= "{}}<< std::setw(19) <<  \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+1]}
\DoxyCodeLine{177                     << std::right <<\textcolor{stringliteral}{"{}  Z= "{}}<< std::setw(19) <<  \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+2]<<std::endl;}
\DoxyCodeLine{178           i += 3;}
\DoxyCodeLine{179  }
\DoxyCodeLine{180         \}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182         std::cout << \textcolor{stringliteral}{"{}Forces: (Hartrees/Bohr)"{}}<<std::endl;}
\DoxyCodeLine{183         i = 0;}
\DoxyCodeLine{184         \textcolor{keywordflow}{for}( \mbox{\hyperlink{structChronusQ_1_1Atom}{Atom}}\& atom : molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a21a4326a73a48d5e20de3b4117fe08cf}{atoms}} ) \{}
\DoxyCodeLine{185 }
\DoxyCodeLine{186           std::cout <<\textcolor{stringliteral}{"{}AtomicNumber = "{}} << std::setw(4) <<  atom.\mbox{\hyperlink{structChronusQ_1_1Atom_ac304c587a6eff864371d8d2d7558b13f}{atomicNumber}} }
\DoxyCodeLine{187                     << std::right <<\textcolor{stringliteral}{"{}  X= "{}}<< std::setw(19) <<  -\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}[i  ]}
\DoxyCodeLine{188                     << std::right <<\textcolor{stringliteral}{"{}  Y= "{}}<< std::setw(19) <<  -\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}[i+1]}
\DoxyCodeLine{189                     << std::right <<\textcolor{stringliteral}{"{}  Z= "{}}<< std::setw(19) <<  -\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}[i+2]<<std::endl;}
\DoxyCodeLine{190 }
\DoxyCodeLine{191           i += 3;}
\DoxyCodeLine{192  }
\DoxyCodeLine{193         \}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195         std::cout << std::setprecision(8);}
\DoxyCodeLine{196         std::cout << std::endl<<\textcolor{stringliteral}{"{}Time (fs): "{}}<< std::right<<std::setw(16)<<\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a3ebf38f24a1b4963af3562a39fed9fde}{xTime}}*\mbox{\hyperlink{namespaceChronusQ_a5eb23f7f0b92e7527a5509138f761432}{FSPerAUTime}}}
\DoxyCodeLine{197                   << \textcolor{stringliteral}{"{}  Time (au): "{}}<<std::right<< std::setw(16)<<\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a3ebf38f24a1b4963af3562a39fed9fde}{xTime}}<<std::endl;}
\DoxyCodeLine{198 }
\DoxyCodeLine{199         std::cout <<  \textcolor{stringliteral}{"{}EKin= "{}} << std::right << std::setw(16) << \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}}}
\DoxyCodeLine{200                   << \textcolor{stringliteral}{"{} EPot= "{}} << std::right << std::setw(16) << \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_ae81404c345ad5a6ee7da169864f71288}{electronicPotentialEnergy}}}
\DoxyCodeLine{201                   << \textcolor{stringliteral}{"{} ETot= "{}} << std::right << std::setw(16) << totalEnergy << \textcolor{stringliteral}{"{} a.u."{}}<<std::endl;}
\DoxyCodeLine{202 }
\DoxyCodeLine{203         std::cout << \textcolor{stringliteral}{"{}ΔETot (current-\/previous)= "{}} << std::right << std::setw(16)<< totalEnergy-\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a0795c3d4dfada7767fd791333650df42}{previousTotalEnergy}}}
\DoxyCodeLine{204                   << \textcolor{stringliteral}{"{} ΔETot (cumulative)= "{}} << std::right << std::setw(16)<< totalEnergy-\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a0e164f53f5a1c454a3549ce506c7213f}{totalEnergy0}}<< \textcolor{stringliteral}{"{} a.u."{}}<<std::endl;}
\DoxyCodeLine{205 }
\DoxyCodeLine{206 }
\DoxyCodeLine{207         std::cout << std::setprecision(12);}
\DoxyCodeLine{208         std::cout << std::endl<<\textcolor{stringliteral}{"{}Predicted Molecular Geometry: (Bohr)"{}}<<std::endl;}
\DoxyCodeLine{209         i = 0;}
\DoxyCodeLine{210         \textcolor{keywordflow}{for}( \mbox{\hyperlink{structChronusQ_1_1Atom}{Atom}}\& atom : molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a21a4326a73a48d5e20de3b4117fe08cf}{atoms}} ) \{}
\DoxyCodeLine{211 }
\DoxyCodeLine{212           std::cout << std::right <<\textcolor{stringliteral}{"{}AtomicNumber = "{}} << std::setw(4) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_ac304c587a6eff864371d8d2d7558b13f}{atomicNumber}} }
\DoxyCodeLine{213                     << std::right <<\textcolor{stringliteral}{"{}  X= "{}}<< std::setw(19) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[0]}
\DoxyCodeLine{214                     << std::right <<\textcolor{stringliteral}{"{}  Y= "{}}<< std::setw(19) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[1]}
\DoxyCodeLine{215                     << std::right <<\textcolor{stringliteral}{"{}  Z= "{}}<< std::setw(19) << atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[2] <<std::endl;}
\DoxyCodeLine{216           i += 3;}
\DoxyCodeLine{217  }
\DoxyCodeLine{218         \}}
\DoxyCodeLine{219       \}}
\DoxyCodeLine{220 }
\DoxyCodeLine{221       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a0795c3d4dfada7767fd791333650df42}{previousTotalEnergy}} = totalEnergy;}
\DoxyCodeLine{222 }
\DoxyCodeLine{223       \textcolor{keywordflow}{if}( print \&\& moveGeometry )}
\DoxyCodeLine{224         std::cout << \textcolor{stringliteral}{"{}  *** Moving Nuclei ***"{}} << std::endl;}
\DoxyCodeLine{225 }
\DoxyCodeLine{226     \}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228     \textcolor{comment}{// Advance the velocity using the Verlet}}
\DoxyCodeLine{229     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_ae40048b1c84055ded73b751249eae93d}{velocityVV}}(\mbox{\hyperlink{structChronusQ_1_1Molecule}{Molecule}} \&molecule, std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}, \textcolor{keywordtype}{double} timeStep, \textcolor{keywordtype}{bool} firstStep)\{}
\DoxyCodeLine{230 }
\DoxyCodeLine{231       \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{232 }
\DoxyCodeLine{233       \textcolor{comment}{// loop over atoms}}
\DoxyCodeLine{234       \textcolor{keywordflow}{for}( \mbox{\hyperlink{structChronusQ_1_1Atom}{Atom}}\& atom : molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a21a4326a73a48d5e20de3b4117fe08cf}{atoms}} ) \{}
\DoxyCodeLine{235         \textcolor{comment}{//compute acceleration = -\/g/m}}
\DoxyCodeLine{236         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i  ] = -\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}[i  ]/(\mbox{\hyperlink{namespaceChronusQ_a02ab1bfed3cb5cc36b1dedcbfc7594ae}{AUPerAMU}}*atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a0619d9b84e1d125cd146fbb59aebe1d2}{atomicMass}});}
\DoxyCodeLine{237         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i+1] = -\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}[i+1]/(\mbox{\hyperlink{namespaceChronusQ_a02ab1bfed3cb5cc36b1dedcbfc7594ae}{AUPerAMU}}*atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a0619d9b84e1d125cd146fbb59aebe1d2}{atomicMass}});}
\DoxyCodeLine{238         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i+2] = -\/\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}[i+2]/(\mbox{\hyperlink{namespaceChronusQ_a02ab1bfed3cb5cc36b1dedcbfc7594ae}{AUPerAMU}}*atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a0619d9b84e1d125cd146fbb59aebe1d2}{atomicMass}});}
\DoxyCodeLine{239 }
\DoxyCodeLine{240         \textcolor{comment}{//advance the half-\/time velocity to the current step }}
\DoxyCodeLine{241         \textcolor{comment}{//v(t+1) = v(t+1/2) + 1/2dT∙a(t+1)}}
\DoxyCodeLine{242         \textcolor{keywordflow}{if}(not firstStep) \{}
\DoxyCodeLine{243           \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i  ] = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i  ] + 0.5*timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i  ];}
\DoxyCodeLine{244           \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+1] = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i+1] + 0.5*timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i+1];}
\DoxyCodeLine{245           \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+2] = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i+2] + 0.5*timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i+2];}
\DoxyCodeLine{246         \}}
\DoxyCodeLine{247 }
\DoxyCodeLine{248         \textcolor{comment}{//prepare the next velocity at half-\/time}}
\DoxyCodeLine{249         \textcolor{comment}{//v(t+1/2) = v(t) + 1/2dT∙a(t)}}
\DoxyCodeLine{250         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i  ] = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i  ] + 0.5*timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i  ];}
\DoxyCodeLine{251         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i+1] = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+1] + 0.5*timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i+1];}
\DoxyCodeLine{252         \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i+2] = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+2] + 0.5*timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a00cb50b5358e4e2ea6ae5b6214023310}{acceleration}}[i+2];}
\DoxyCodeLine{253 }
\DoxyCodeLine{254         i+=3;}
\DoxyCodeLine{255       \}}
\DoxyCodeLine{256 }
\DoxyCodeLine{257     \}}
\DoxyCodeLine{258 }
\DoxyCodeLine{259     \textcolor{comment}{// Advance the geometry using the velocity}}
\DoxyCodeLine{260     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_afe9ac366e8e661f3a4c4b592fa913d69}{geometryVV}}(\mbox{\hyperlink{structChronusQ_1_1Molecule}{Molecule}} \&molecule, std::vector<double> \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a8e137fbca91ecd34d0316e0f08547ed2}{gradientCurrent}}, \textcolor{keywordtype}{double} timeStep)\{}
\DoxyCodeLine{261 }
\DoxyCodeLine{262       \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{263 }
\DoxyCodeLine{264       \textcolor{comment}{// loop over atoms}}
\DoxyCodeLine{265       \textcolor{keywordflow}{for}( \mbox{\hyperlink{structChronusQ_1_1Atom}{Atom}}\& atom : molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a21a4326a73a48d5e20de3b4117fe08cf}{atoms}} ) \{}
\DoxyCodeLine{266         \textcolor{comment}{//advance the geometry to the next time }}
\DoxyCodeLine{267         \textcolor{comment}{//r(t+1) = r(t) + dT∙v(t+1/2)}}
\DoxyCodeLine{268         atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[0] += timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i  ]; \textcolor{comment}{// x}}
\DoxyCodeLine{269         atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[1] += timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i+1]; \textcolor{comment}{// y}}
\DoxyCodeLine{270         atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a523cfb92fd227059becf5360535813ea}{coord}}[2] += timeStep*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c21aac496d7eca48704c2dccffe51ed}{velocityHalfTime}}[i+2]; \textcolor{comment}{// z}}
\DoxyCodeLine{271 }
\DoxyCodeLine{272         i+=3;}
\DoxyCodeLine{273       \}}
\DoxyCodeLine{274  }
\DoxyCodeLine{275     \}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277 }
\DoxyCodeLine{286     \textcolor{keywordtype}{void} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a5dc89ff1c66d37eb13ae5ec8e90ab920}{computeKineticEnergy}}(\mbox{\hyperlink{structChronusQ_1_1Molecule}{Molecule}}\& molecule) \{}
\DoxyCodeLine{287 }
\DoxyCodeLine{288       \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}} = 0.;}
\DoxyCodeLine{289 }
\DoxyCodeLine{290       \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{291       \textcolor{keywordflow}{for}( \mbox{\hyperlink{structChronusQ_1_1Atom}{Atom}}\& atom : molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a21a4326a73a48d5e20de3b4117fe08cf}{atoms}} ) \{}
\DoxyCodeLine{292         \textcolor{keywordflow}{if} (not atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a240cab247b1cbb9358f193078eddcc52}{quantum}}) \{}
\DoxyCodeLine{293           \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}} += 0.5*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i  ]*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i  ]*atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a0619d9b84e1d125cd146fbb59aebe1d2}{atomicMass}}*\mbox{\hyperlink{namespaceChronusQ_a02ab1bfed3cb5cc36b1dedcbfc7594ae}{AUPerAMU}};}
\DoxyCodeLine{294           \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}} += 0.5*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+1]*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+1]*atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a0619d9b84e1d125cd146fbb59aebe1d2}{atomicMass}}*\mbox{\hyperlink{namespaceChronusQ_a02ab1bfed3cb5cc36b1dedcbfc7594ae}{AUPerAMU}};}
\DoxyCodeLine{295           \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}} += 0.5*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+2]*\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af46534a28cb9968ff35c29321a6a311f}{velocityCurrent}}[i+2]*atom.\mbox{\hyperlink{structChronusQ_1_1Atom_a0619d9b84e1d125cd146fbb59aebe1d2}{atomicMass}}*\mbox{\hyperlink{namespaceChronusQ_a02ab1bfed3cb5cc36b1dedcbfc7594ae}{AUPerAMU}};}
\DoxyCodeLine{296         \}}
\DoxyCodeLine{297         i += 3;}
\DoxyCodeLine{298       \}}
\DoxyCodeLine{299 }
\DoxyCodeLine{300       molecule.\mbox{\hyperlink{structChronusQ_1_1Molecule_a4db0c230f4be3c495856ce4a99e1f461}{nucKinEnergy}} = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_abbc945b474258dea4ebee27e6b102d17}{nuclearKineticEnergy}};}
\DoxyCodeLine{301     \}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_af5203da4eba474651b0f20af709518da}{hasNext}}() \{}
\DoxyCodeLine{304       \textcolor{comment}{// Because this is at the beginning of the previous iteration, do i-\/1}}
\DoxyCodeLine{305       \textcolor{keywordtype}{double} nextStep = \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a0a1ba583060b820327aa220a3ac9d6a6}{stepSize}};}
\DoxyCodeLine{306       \textcolor{keywordflow}{if}( \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}} != 0 )}
\DoxyCodeLine{307         nextStep /= \mbox{\hyperlink{classChronusQ_1_1GeometryModifier_af450bc78d9f71ef4178474e8707d3a40}{molecularOptions\_}}.\mbox{\hyperlink{structChronusQ_1_1MolecularOptions_a8b698270f6d8e64cea89b8208f4e4960}{nMidpointFockSteps}};}
\DoxyCodeLine{308       \textcolor{keywordflow}{return} (\mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_a2c41d1ed4daf55267748ad954f441138}{curState}}.\mbox{\hyperlink{structChronusQ_1_1IntegrationProgress_a3ebf38f24a1b4963af3562a39fed9fde}{xTime}} + nextStep) < \mbox{\hyperlink{classChronusQ_1_1MolecularDynamics_acd9d24a0defab9d49195343ba22a7367}{tMax}};}
\DoxyCodeLine{309     \}}
\DoxyCodeLine{310 }
\DoxyCodeLine{311   \};}
\DoxyCodeLine{312 }
\DoxyCodeLine{313 \}}

\end{DoxyCode}
